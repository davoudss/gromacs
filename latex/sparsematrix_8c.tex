\hypertarget{sparsematrix_8c}{\section{src/gmxlib/sparsematrix.c \-File \-Reference}
\label{sparsematrix_8c}\index{src/gmxlib/sparsematrix.\-c@{src/gmxlib/sparsematrix.\-c}}
}
{\ttfamily \#include $<$stdlib.\-h$>$}\*
{\ttfamily \#include $<$stdio.\-h$>$}\*
{\ttfamily \#include $<$assert.\-h$>$}\*
{\ttfamily \#include \char`\"{}smalloc.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}sparsematrix.\-h\char`\"{}}\*
\-Include dependency graph for sparsematrix.\-c\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sparsematrix_8c__incl}
\end{center}
\end{figure}
\subsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{include_2sparsematrix_8h_acc946265e6f9b5b25ab54aeed0aa7c1b}{gmx\-\_\-sparsematrix\-\_\-t} $\ast$ \hyperlink{sparsematrix_8c_ab4a490b4c350dbbad29fa9c1e9303e3e}{gmx\-\_\-sparsematrix\-\_\-init} (int nrow)
\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{sparsematrix_8c_ae1265238816409b751cd8b7b27068e48}{gmx\-\_\-sparsematrix\-\_\-destroy} (\hyperlink{include_2sparsematrix_8h_acc946265e6f9b5b25ab54aeed0aa7c1b}{gmx\-\_\-sparsematrix\-\_\-t} $\ast$\hyperlink{shift__util_8c_aacaa5b9630e45bd7f464005e7eb9ce14}{\-A})
\begin{DoxyCompactList}\small\item\em \-Release all resources used by a sparse matrix structure. \end{DoxyCompactList}\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{sparsematrix_8c_ab5fd625fd699ce3c53d8fbc259d21316}{gmx\-\_\-sparsematrix\-\_\-print} (\-F\-I\-L\-E $\ast$stream, \hyperlink{include_2sparsematrix_8h_acc946265e6f9b5b25ab54aeed0aa7c1b}{gmx\-\_\-sparsematrix\-\_\-t} $\ast$\hyperlink{shift__util_8c_aacaa5b9630e45bd7f464005e7eb9ce14}{\-A})
\begin{DoxyCompactList}\small\item\em \-Print sparse matrix to a stream. \end{DoxyCompactList}\item 
real \hyperlink{sparsematrix_8c_ae2eadd66cbe6d28c7458dda42744161d}{gmx\-\_\-sparsematrix\-\_\-value} (\hyperlink{include_2sparsematrix_8h_acc946265e6f9b5b25ab54aeed0aa7c1b}{gmx\-\_\-sparsematrix\-\_\-t} $\ast$\hyperlink{shift__util_8c_aacaa5b9630e45bd7f464005e7eb9ce14}{\-A}, int row, int col)
\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{sparsematrix_8c_a443eb04e01bb112388aba20923fe5005}{gmx\-\_\-sparsematrix\-\_\-increment\-\_\-value} (\hyperlink{include_2sparsematrix_8h_acc946265e6f9b5b25ab54aeed0aa7c1b}{gmx\-\_\-sparsematrix\-\_\-t} $\ast$\hyperlink{shift__util_8c_aacaa5b9630e45bd7f464005e7eb9ce14}{\-A}, int row, int col, real difference)
\item 
static int \hyperlink{sparsematrix_8c_ae00bf4b167df615c90fe26cd1a243453}{compare\-\_\-columns} (const \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$\hyperlink{gmx__tcaf_8c_a87f952b4a22b76e69a31035f6a12d883}{v1}, const \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$\hyperlink{gmx__tcaf_8c_ad3a27fd4cf1320dd23125e881ef0dd97}{v2})
\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{sparsematrix_8c_ac3c58041a48f0f821ef71da0d6fbe0fd}{gmx\-\_\-sparsematrix\-\_\-compress} (\hyperlink{include_2sparsematrix_8h_acc946265e6f9b5b25ab54aeed0aa7c1b}{gmx\-\_\-sparsematrix\-\_\-t} $\ast$\hyperlink{shift__util_8c_aacaa5b9630e45bd7f464005e7eb9ce14}{\-A})
\begin{DoxyCompactList}\small\item\em \-Sort elements in each column and remove zeros. \end{DoxyCompactList}\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{sparsematrix_8c_ae3d30c00f680e4e669708d249ce9376f}{gmx\-\_\-sparsematrix\-\_\-vector\-\_\-multiply} (\hyperlink{include_2sparsematrix_8h_acc946265e6f9b5b25ab54aeed0aa7c1b}{gmx\-\_\-sparsematrix\-\_\-t} $\ast$\hyperlink{shift__util_8c_aacaa5b9630e45bd7f464005e7eb9ce14}{\-A}, real $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}, real $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ad992d70ec70c927046cfc2ab1c79b188}{y})
\begin{DoxyCompactList}\small\item\em \-Sparse matrix vector multiplication. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{\-Function \-Documentation}
\hypertarget{sparsematrix_8c_ae00bf4b167df615c90fe26cd1a243453}{\index{sparsematrix.\-c@{sparsematrix.\-c}!compare\-\_\-columns@{compare\-\_\-columns}}
\index{compare\-\_\-columns@{compare\-\_\-columns}!sparsematrix.c@{sparsematrix.\-c}}
\subsubsection[{compare\-\_\-columns}]{\setlength{\rightskip}{0pt plus 5cm}static int {\bf compare\-\_\-columns} (
\begin{DoxyParamCaption}
\item[{const {\bf void} $\ast$}]{v1, }
\item[{const {\bf void} $\ast$}]{v2}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sparsematrix_8c_ae00bf4b167df615c90fe26cd1a243453}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sparsematrix_8c_ae00bf4b167df615c90fe26cd1a243453_icgraph}
\end{center}
\end{figure}


\hypertarget{sparsematrix_8c_ac3c58041a48f0f821ef71da0d6fbe0fd}{\index{sparsematrix.\-c@{sparsematrix.\-c}!gmx\-\_\-sparsematrix\-\_\-compress@{gmx\-\_\-sparsematrix\-\_\-compress}}
\index{gmx\-\_\-sparsematrix\-\_\-compress@{gmx\-\_\-sparsematrix\-\_\-compress}!sparsematrix.c@{sparsematrix.\-c}}
\subsubsection[{gmx\-\_\-sparsematrix\-\_\-compress}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} {\bf gmx\-\_\-sparsematrix\-\_\-compress} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-sparsematrix\-\_\-t} $\ast$}]{\-A}
\end{DoxyParamCaption}
)}}\label{sparsematrix_8c_ac3c58041a48f0f821ef71da0d6fbe0fd}


\-Sort elements in each column and remove zeros. 

\-Sparse matrix access is faster when the elements are stored in increasing column order in each row. \-In some cases previously non-\/zero elements will be zero after adding more data, and this routine also removes those entries to reduce the storage requirements.

\-It never hurts to run this routine if you have been updating the matrix... 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sparsematrix_8c_ac3c58041a48f0f821ef71da0d6fbe0fd_cgraph}
\end{center}
\end{figure}


\hypertarget{sparsematrix_8c_ae1265238816409b751cd8b7b27068e48}{\index{sparsematrix.\-c@{sparsematrix.\-c}!gmx\-\_\-sparsematrix\-\_\-destroy@{gmx\-\_\-sparsematrix\-\_\-destroy}}
\index{gmx\-\_\-sparsematrix\-\_\-destroy@{gmx\-\_\-sparsematrix\-\_\-destroy}!sparsematrix.c@{sparsematrix.\-c}}
\subsubsection[{gmx\-\_\-sparsematrix\-\_\-destroy}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} {\bf gmx\-\_\-sparsematrix\-\_\-destroy} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-sparsematrix\-\_\-t} $\ast$}]{\-A}
\end{DoxyParamCaption}
)}}\label{sparsematrix_8c_ae1265238816409b751cd8b7b27068e48}


\-Release all resources used by a sparse matrix structure. 

\-All arrays in the structure will be freed, and the structure itself. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sparsematrix_8c_ae1265238816409b751cd8b7b27068e48_icgraph}
\end{center}
\end{figure}


\hypertarget{sparsematrix_8c_a443eb04e01bb112388aba20923fe5005}{\index{sparsematrix.\-c@{sparsematrix.\-c}!gmx\-\_\-sparsematrix\-\_\-increment\-\_\-value@{gmx\-\_\-sparsematrix\-\_\-increment\-\_\-value}}
\index{gmx\-\_\-sparsematrix\-\_\-increment\-\_\-value@{gmx\-\_\-sparsematrix\-\_\-increment\-\_\-value}!sparsematrix.c@{sparsematrix.\-c}}
\subsubsection[{gmx\-\_\-sparsematrix\-\_\-increment\-\_\-value}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} {\bf gmx\-\_\-sparsematrix\-\_\-increment\-\_\-value} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-sparsematrix\-\_\-t} $\ast$}]{\-A, }
\item[{int}]{row, }
\item[{int}]{col, }
\item[{real}]{difference}
\end{DoxyParamCaption}
)}}\label{sparsematrix_8c_a443eb04e01bb112388aba20923fe5005}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{sparsematrix_8c_a443eb04e01bb112388aba20923fe5005_icgraph}
\end{center}
\end{figure}


\hypertarget{sparsematrix_8c_ab4a490b4c350dbbad29fa9c1e9303e3e}{\index{sparsematrix.\-c@{sparsematrix.\-c}!gmx\-\_\-sparsematrix\-\_\-init@{gmx\-\_\-sparsematrix\-\_\-init}}
\index{gmx\-\_\-sparsematrix\-\_\-init@{gmx\-\_\-sparsematrix\-\_\-init}!sparsematrix.c@{sparsematrix.\-c}}
\subsubsection[{gmx\-\_\-sparsematrix\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}{\bf gmx\-\_\-sparsematrix\-\_\-t}$\ast$ {\bf gmx\-\_\-sparsematrix\-\_\-init} (
\begin{DoxyParamCaption}
\item[{int}]{nrow}
\end{DoxyParamCaption}
)}}\label{sparsematrix_8c_ab4a490b4c350dbbad29fa9c1e9303e3e}
a new sparse matrix structure

\-The number of rows is used to allocate the index array entry. \-Obviously you can reallocate these later yourself if necessary -\/ this is a convenience routine.

\-By default, the compressed\-\_\-symmetric flag in the structure will be \-F\-A\-L\-S\-E. \-Set it to \-T\-R\-U\-E manually if you are only storing either the upper or lower half of the matrix. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=278pt]{sparsematrix_8c_ab4a490b4c350dbbad29fa9c1e9303e3e_icgraph}
\end{center}
\end{figure}


\hypertarget{sparsematrix_8c_ab5fd625fd699ce3c53d8fbc259d21316}{\index{sparsematrix.\-c@{sparsematrix.\-c}!gmx\-\_\-sparsematrix\-\_\-print@{gmx\-\_\-sparsematrix\-\_\-print}}
\index{gmx\-\_\-sparsematrix\-\_\-print@{gmx\-\_\-sparsematrix\-\_\-print}!sparsematrix.c@{sparsematrix.\-c}}
\subsubsection[{gmx\-\_\-sparsematrix\-\_\-print}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} {\bf gmx\-\_\-sparsematrix\-\_\-print} (
\begin{DoxyParamCaption}
\item[{\-F\-I\-L\-E $\ast$}]{stream, }
\item[{{\bf gmx\-\_\-sparsematrix\-\_\-t} $\ast$}]{\-A}
\end{DoxyParamCaption}
)}}\label{sparsematrix_8c_ab5fd625fd699ce3c53d8fbc259d21316}


\-Print sparse matrix to a stream. 

\-Mainly used for debugging. \-Be warned that the real sparse matrices used in \-Gromacs runs can be \-H\-U\-G\-E (think 100,000 rows). \hypertarget{sparsematrix_8c_ae2eadd66cbe6d28c7458dda42744161d}{\index{sparsematrix.\-c@{sparsematrix.\-c}!gmx\-\_\-sparsematrix\-\_\-value@{gmx\-\_\-sparsematrix\-\_\-value}}
\index{gmx\-\_\-sparsematrix\-\_\-value@{gmx\-\_\-sparsematrix\-\_\-value}!sparsematrix.c@{sparsematrix.\-c}}
\subsubsection[{gmx\-\_\-sparsematrix\-\_\-value}]{\setlength{\rightskip}{0pt plus 5cm}real {\bf gmx\-\_\-sparsematrix\-\_\-value} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-sparsematrix\-\_\-t} $\ast$}]{\-A, }
\item[{int}]{row, }
\item[{int}]{col}
\end{DoxyParamCaption}
)}}\label{sparsematrix_8c_ae2eadd66cbe6d28c7458dda42744161d}
\hypertarget{sparsematrix_8c_ae3d30c00f680e4e669708d249ce9376f}{\index{sparsematrix.\-c@{sparsematrix.\-c}!gmx\-\_\-sparsematrix\-\_\-vector\-\_\-multiply@{gmx\-\_\-sparsematrix\-\_\-vector\-\_\-multiply}}
\index{gmx\-\_\-sparsematrix\-\_\-vector\-\_\-multiply@{gmx\-\_\-sparsematrix\-\_\-vector\-\_\-multiply}!sparsematrix.c@{sparsematrix.\-c}}
\subsubsection[{gmx\-\_\-sparsematrix\-\_\-vector\-\_\-multiply}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} {\bf gmx\-\_\-sparsematrix\-\_\-vector\-\_\-multiply} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-sparsematrix\-\_\-t} $\ast$}]{\-A, }
\item[{real $\ast$}]{x, }
\item[{real $\ast$}]{y}
\end{DoxyParamCaption}
)}}\label{sparsematrix_8c_ae3d30c00f680e4e669708d249ce9376f}


\-Sparse matrix vector multiplication. 

\-Calculate y = \-A $\ast$ x for a sparse matrix \-A. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sparsematrix_8c_ae3d30c00f680e4e669708d249ce9376f_icgraph}
\end{center}
\end{figure}


