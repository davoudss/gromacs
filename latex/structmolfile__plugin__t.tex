\hypertarget{structmolfile__plugin__t}{\section{molfile\-\_\-plugin\-\_\-t \-Struct \-Reference}
\label{structmolfile__plugin__t}\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}}
}


{\ttfamily \#include $<$molfile\-\_\-plugin.\-h$>$}

\subsection*{\-Public \-Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structmolfile__plugin__t_a0aad2280e74ace06633058e3501a340b}{vmdplugin\-\_\-\-H\-E\-A\-D}
\item 
const char $\ast$ \hyperlink{structmolfile__plugin__t_a707dd1b313dd9c8ec4f344038ef78708}{filename\-\_\-extension}
\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$($\ast$ \hyperlink{structmolfile__plugin__t_a992bbcd14769aee84a652307eb864ce2}{open\-\_\-file\-\_\-read} )(const char $\ast$filepath, const char $\ast$filetype, int $\ast$natoms)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_af05a7c088226fc0ecc3fe3feca347754}{read\-\_\-structure} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, int $\ast$optflags, \hyperlink{structmolfile__atom__t}{molfile\-\_\-atom\-\_\-t} $\ast$atoms)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_a6e1aca38d75aacb2cbcf6401261cdb5f}{read\-\_\-bonds} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, int $\ast$nbonds, int $\ast$$\ast$from, int $\ast$$\ast$to, float $\ast$$\ast$bondorder, int $\ast$$\ast$bondtype, int $\ast$nbondtypes, char $\ast$$\ast$$\ast$bondtypename)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_a236f89950634743ee58330622407f255}{read\-\_\-next\-\_\-timestep} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, int natoms, \hyperlink{structmolfile__timestep__t}{molfile\-\_\-timestep\-\_\-t} $\ast$)
\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void}($\ast$ \hyperlink{structmolfile__plugin__t_a2fbc2c1623f4453c8bd95548e6c5de53}{close\-\_\-file\-\_\-read} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$)
\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$($\ast$ \hyperlink{structmolfile__plugin__t_a01f35d1653fe51bce434f60d7a5b04d2}{open\-\_\-file\-\_\-write} )(const char $\ast$filepath, const char $\ast$filetype, int natoms)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_a96caabc2f33c5a710e82cfe20316568f}{write\-\_\-structure} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, int optflags, const \hyperlink{structmolfile__atom__t}{molfile\-\_\-atom\-\_\-t} $\ast$atoms)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_acf10fad00927486a1ce859852658e7b0}{write\-\_\-timestep} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, const \hyperlink{structmolfile__timestep__t}{molfile\-\_\-timestep\-\_\-t} $\ast$)
\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void}($\ast$ \hyperlink{structmolfile__plugin__t_a69455eb95d6093deba833b47b9c60c2c}{close\-\_\-file\-\_\-write} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_ac54290d6b607ba8b1fd9e38a1e7f69a1}{read\-\_\-volumetric\-\_\-metadata} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, int $\ast$nsets, \hyperlink{structmolfile__volumetric__t}{molfile\-\_\-volumetric\-\_\-t} $\ast$$\ast$metadata)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_a535aeec1aea2739b07b2348c239772b9}{read\-\_\-volumetric\-\_\-data} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, int set, float $\ast$datablock, float $\ast$colorblock)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_a0318edf94ed266fe5a995c02cf2357d9}{read\-\_\-rawgraphics} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, int $\ast$nelem, const \hyperlink{structmolfile__graphics__t}{molfile\-\_\-graphics\-\_\-t} $\ast$$\ast$data)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_ae34996861c7be39038802b1c4d52591d}{read\-\_\-molecule\-\_\-metadata} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, \hyperlink{structmolfile__metadata__t}{molfile\-\_\-metadata\-\_\-t} $\ast$$\ast$metadata)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_a0af11d8d87bbc73eb219a02039204c65}{write\-\_\-bonds} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, int nbonds, int $\ast$from, int $\ast$to, float $\ast$bondorder, int $\ast$bondtype, int nbondtypes, char $\ast$$\ast$bondtypename)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_a46cdd765aa39c041ab2e3ab824d8be5d}{write\-\_\-volumetric\-\_\-data} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, \hyperlink{structmolfile__volumetric__t}{molfile\-\_\-volumetric\-\_\-t} $\ast$metadata, float $\ast$datablock, float $\ast$colorblock)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_a4c8cf13d21a1d738a405e208cbe46a78}{read\-\_\-angles} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$handle, int $\ast$numangles, int $\ast$$\ast$\hyperlink{bondfree_8c_af80699f69fb5e367d4a781b515c87c69}{angles}, int $\ast$$\ast$angletypes, int $\ast$numangletypes, char $\ast$$\ast$$\ast$angletypenames, int $\ast$numdihedrals, int $\ast$$\ast$dihedrals, int $\ast$$\ast$dihedraltypes, int $\ast$numdihedraltypes, char $\ast$$\ast$$\ast$dihedraltypenames, int $\ast$numimpropers, int $\ast$$\ast$impropers, int $\ast$$\ast$impropertypes, int $\ast$numimpropertypes, char $\ast$$\ast$$\ast$impropertypenames, int $\ast$numcterms, int $\ast$$\ast$cterms, int $\ast$ctermcols, int $\ast$ctermrows)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_a39e12d9cbf00ffa9e5da4845825d3846}{write\-\_\-angles} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$handle, int numangles, const int $\ast$\hyperlink{bondfree_8c_af80699f69fb5e367d4a781b515c87c69}{angles}, const int $\ast$angletypes, int numangletypes, const char $\ast$$\ast$angletypenames, int numdihedrals, const int $\ast$dihedrals, const int $\ast$dihedraltypes, int numdihedraltypes, const char $\ast$$\ast$dihedraltypenames, int numimpropers, const int $\ast$impropers, const int $\ast$impropertypes, int numimpropertypes, const char $\ast$$\ast$impropertypenames, int numcterms, const int $\ast$cterms, int ctermcols, int ctermrows)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_a918c88a4b1455e114b0c4008d8c77823}{read\-\_\-qm\-\_\-metadata} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, \hyperlink{structmolfile__qm__metadata__t}{molfile\-\_\-qm\-\_\-metadata\-\_\-t} $\ast$metadata)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_a66b4938d266f03b30e38cc8bed9ad473}{read\-\_\-qm\-\_\-rundata} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, \hyperlink{structmolfile__qm__t}{molfile\-\_\-qm\-\_\-t} $\ast$qmdata)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_a72589b78044886d6e2402c73fa2a72e9}{read\-\_\-timestep} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, int natoms, \hyperlink{structmolfile__timestep__t}{molfile\-\_\-timestep\-\_\-t} $\ast$, \hyperlink{structmolfile__qm__metadata__t}{molfile\-\_\-qm\-\_\-metadata\-\_\-t} $\ast$, \hyperlink{structmolfile__qm__timestep__t}{molfile\-\_\-qm\-\_\-timestep\-\_\-t} $\ast$)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_a0b7ba8f821b21ab609aebe0b02947a71}{read\-\_\-timestep\-\_\-metadata} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, \hyperlink{molfile__plugin_8h_a3cfeeba48d6d13973def8761d2fad5f5}{molfile\-\_\-timestep\-\_\-metadata\-\_\-t} $\ast$)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_a4928ec6da0a4e956c5bd4edeea429c57}{read\-\_\-qm\-\_\-timestep\-\_\-metadata} )(\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$, \hyperlink{molfile__plugin_8h_ae091e5e1e59b0dc4cecbfad539a50e27}{molfile\-\_\-qm\-\_\-timestep\-\_\-metadata\-\_\-t} $\ast$)
\item 
int($\ast$ \hyperlink{structmolfile__plugin__t_a190dffaa87f1debfa44a24aef6868365}{cons\-\_\-fputs} )(const int, const char $\ast$)
\end{DoxyCompactItemize}


\subsection{\-Detailed \-Description}
\-Main file reader \-A\-P\-I. \-Any function in this struct may be \-N\-U\-L\-L if not implemented by the plugin; the application checks this to determine what functionality is present in the plugin. 

\subsection{\-Member \-Data \-Documentation}
\hypertarget{structmolfile__plugin__t_a2fbc2c1623f4453c8bd95548e6c5de53}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!close\-\_\-file\-\_\-read@{close\-\_\-file\-\_\-read}}
\index{close\-\_\-file\-\_\-read@{close\-\_\-file\-\_\-read}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{close\-\_\-file\-\_\-read}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::close\-\_\-file\-\_\-read})({\bf void} $\ast$)}}\label{structmolfile__plugin__t_a2fbc2c1623f4453c8bd95548e6c5de53}
\-Close the file and release all data. \-The handle cannot be reused. \hypertarget{structmolfile__plugin__t_a69455eb95d6093deba833b47b9c60c2c}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!close\-\_\-file\-\_\-write@{close\-\_\-file\-\_\-write}}
\index{close\-\_\-file\-\_\-write@{close\-\_\-file\-\_\-write}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{close\-\_\-file\-\_\-write}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::close\-\_\-file\-\_\-write})({\bf void} $\ast$)}}\label{structmolfile__plugin__t_a69455eb95d6093deba833b47b9c60c2c}
\-Close the file and release all data. \-The handle cannot be reused. \hypertarget{structmolfile__plugin__t_a190dffaa87f1debfa44a24aef6868365}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!cons\-\_\-fputs@{cons\-\_\-fputs}}
\index{cons\-\_\-fputs@{cons\-\_\-fputs}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{cons\-\_\-fputs}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::cons\-\_\-fputs})(const int, const char $\ast$)}}\label{structmolfile__plugin__t_a190dffaa87f1debfa44a24aef6868365}
\-Console output, \-R\-E\-A\-D-\/\-O\-N\-L\-Y function pointer. \-Function pointer that plugins can use for printing to the host application's text console. \-This provides a clean way for plugins to send message strings back to the calling application, giving the caller the ability to prioritize, buffer, and redirect console messages to an appropriate output channel, window, etc. \-This enables the use of graphical consoles like \-Tk\-Con without losing console output from plugins. \-If the function pointer is \-N\-U\-L\-L, no console output service is provided by the calling application, and the output should default to stdout stream. \-If the function pointer is non-\/\-N\-U\-L\-L, all output will be subsequently dealt with by the calling application.

\-X\-X\-X this should really be put into a separate block of application-\/provided read-\/only function pointers for any application-\/provided services \hypertarget{structmolfile__plugin__t_a707dd1b313dd9c8ec4f344038ef78708}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!filename\-\_\-extension@{filename\-\_\-extension}}
\index{filename\-\_\-extension@{filename\-\_\-extension}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{filename\-\_\-extension}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ {\bf molfile\-\_\-plugin\-\_\-t\-::filename\-\_\-extension}}}\label{structmolfile__plugin__t_a707dd1b313dd9c8ec4f344038ef78708}
\-Filename extension for this file type. \-May be \-N\-U\-L\-L if no filename extension exists and/or is known. \-For file types that match several common extensions, list them in a comma separated list such as\-: \char`\"{}pdb,ent,foo,bar,baz,ban\char`\"{} \-The comma separated list will be expanded when filename extension matching is performed. \-If multiple plugins solicit the same filename extensions, the one that lists the extension earliest in its list is selected. \-In the case of a \char`\"{}tie\char`\"{}, the first one tried/checked \char`\"{}wins\char`\"{}. \hypertarget{structmolfile__plugin__t_a992bbcd14769aee84a652307eb864ce2}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!open\-\_\-file\-\_\-read@{open\-\_\-file\-\_\-read}}
\index{open\-\_\-file\-\_\-read@{open\-\_\-file\-\_\-read}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{open\-\_\-file\-\_\-read}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}$\ast$($\ast$ {\bf molfile\-\_\-plugin\-\_\-t\-::open\-\_\-file\-\_\-read})(const char $\ast$filepath, const char $\ast$filetype, int $\ast$natoms)}}\label{structmolfile__plugin__t_a992bbcd14769aee84a652307eb864ce2}
\-Try to open the file for reading. \-Return an opaque handle, or \-N\-U\-L\-L on failure. \-Set the number of atoms; if the number of atoms cannot be determined, set natoms to \-M\-O\-L\-F\-I\-L\-E\-\_\-\-N\-U\-M\-A\-T\-O\-M\-S\-\_\-\-U\-N\-K\-N\-O\-W\-N. \-Filetype should be the name under which this plugin was registered; this is provided so that plugins can provide the same function pointer to handle multiple file types. \hypertarget{structmolfile__plugin__t_a01f35d1653fe51bce434f60d7a5b04d2}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!open\-\_\-file\-\_\-write@{open\-\_\-file\-\_\-write}}
\index{open\-\_\-file\-\_\-write@{open\-\_\-file\-\_\-write}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{open\-\_\-file\-\_\-write}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}$\ast$($\ast$ {\bf molfile\-\_\-plugin\-\_\-t\-::open\-\_\-file\-\_\-write})(const char $\ast$filepath, const char $\ast$filetype, int natoms)}}\label{structmolfile__plugin__t_a01f35d1653fe51bce434f60d7a5b04d2}
\-Open a coordinate file for writing using the given header information. \-Return an opaque handle, or \-N\-U\-L\-L on failure. \-The application must specify the number of atoms to be written. filetype should be the name under which this plugin was registered. \hypertarget{structmolfile__plugin__t_a4c8cf13d21a1d738a405e208cbe46a78}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!read\-\_\-angles@{read\-\_\-angles}}
\index{read\-\_\-angles@{read\-\_\-angles}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{read\-\_\-angles}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::read\-\_\-angles})({\bf void} $\ast$handle, int $\ast$numangles, int $\ast$$\ast${\bf angles}, int $\ast$$\ast$angletypes, int $\ast$numangletypes, char $\ast$$\ast$$\ast$angletypenames, int $\ast$numdihedrals, int $\ast$$\ast$dihedrals, int $\ast$$\ast$dihedraltypes, int $\ast$numdihedraltypes, char $\ast$$\ast$$\ast$dihedraltypenames, int $\ast$numimpropers, int $\ast$$\ast$impropers, int $\ast$$\ast$impropertypes, int $\ast$numimpropertypes, char $\ast$$\ast$$\ast$impropertypenames, int $\ast$numcterms, int $\ast$$\ast$cterms, int $\ast$ctermcols, int $\ast$ctermrows)}}\label{structmolfile__plugin__t_a4c8cf13d21a1d738a405e208cbe46a78}
\-Read in \-Angles, \-Dihedrals, \-Impropers, and \-Cross \-Terms and optionally types. (\-Cross terms pertain to the \-C\-H\-A\-R\-M\-M/\-N\-A\-M\-D \-C\-M\-A\-P feature) \hypertarget{structmolfile__plugin__t_a6e1aca38d75aacb2cbcf6401261cdb5f}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!read\-\_\-bonds@{read\-\_\-bonds}}
\index{read\-\_\-bonds@{read\-\_\-bonds}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{read\-\_\-bonds}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$ {\bf molfile\-\_\-plugin\-\_\-t\-::read\-\_\-bonds})({\bf void} $\ast$, int $\ast$nbonds, int $\ast$$\ast$from, int $\ast$$\ast$to, float $\ast$$\ast$bondorder, int $\ast$$\ast$bondtype, int $\ast$nbondtypes, char $\ast$$\ast$$\ast$bondtypename)}}\label{structmolfile__plugin__t_a6e1aca38d75aacb2cbcf6401261cdb5f}
\-Read bond information for the molecule. \-On success the arrays from and to should point to the (one-\/based) indices of bonded atoms. \-Each unique bond should be specified only once, so file formats that list bonds twice will need post-\/processing before the results are returned to the caller. \-If the plugin provides bond information, but the file loaded doesn't actually contain any bond info, the nbonds parameter should be set to 0 and from/to should be set to \-N\-U\-L\-L to indicate that no bond information was actually present, and automatic bond search should be performed.

\-If the plugin provides bond order information, the bondorder array will contain the bond order for each from/to pair. \-If not, the bondorder pointer should be set to \-N\-U\-L\-L, in which case the caller will provide a default bond order value of 1.\-0.

\-If the plugin provides bond type information, the bondtype array will contain the bond type index for each from/to pair. \-These numbers are consecutive integers starting from 0. the bondtypenames list, contains the corresponding names, if available, as a \-N\-U\-L\-L string terminated list. nbondtypes is provided for convenience and consistency checking.

\-These arrays must be freed by the plugin in the close\-\_\-file\-\_\-read function. \-This function can be called only after \hyperlink{structmolfile__plugin__t_af05a7c088226fc0ecc3fe3feca347754}{read\-\_\-structure()}. \-Return \-M\-O\-L\-F\-I\-L\-E\-\_\-\-S\-U\-C\-C\-E\-S\-S if no errors occur. \hypertarget{structmolfile__plugin__t_ae34996861c7be39038802b1c4d52591d}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!read\-\_\-molecule\-\_\-metadata@{read\-\_\-molecule\-\_\-metadata}}
\index{read\-\_\-molecule\-\_\-metadata@{read\-\_\-molecule\-\_\-metadata}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{read\-\_\-molecule\-\_\-metadata}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::read\-\_\-molecule\-\_\-metadata})({\bf void} $\ast$, {\bf molfile\-\_\-metadata\-\_\-t} $\ast$$\ast$metadata)}}\label{structmolfile__plugin__t_ae34996861c7be39038802b1c4d52591d}
\-Read molecule metadata such as what database (if any) this file/data came from, what the accession code for the database is, textual remarks and other notes pertaining to the contained structure/trajectory/volume and anything else that's informative at the whole file level. \hypertarget{structmolfile__plugin__t_a236f89950634743ee58330622407f255}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!read\-\_\-next\-\_\-timestep@{read\-\_\-next\-\_\-timestep}}
\index{read\-\_\-next\-\_\-timestep@{read\-\_\-next\-\_\-timestep}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{read\-\_\-next\-\_\-timestep}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::read\-\_\-next\-\_\-timestep})({\bf void} $\ast$, int natoms, {\bf molfile\-\_\-timestep\-\_\-t} $\ast$)}}\label{structmolfile__plugin__t_a236f89950634743ee58330622407f255}
\-X\-X\-X this function will be augmented and possibly superceded by a new \-Q\-M-\/capable version named \hyperlink{structmolfile__plugin__t_a72589b78044886d6e2402c73fa2a72e9}{read\-\_\-timestep()}, when finished.

\-Read the next timestep from the file. \-Return \-M\-O\-L\-F\-I\-L\-E\-\_\-\-S\-U\-C\-C\-E\-S\-S, or \-M\-O\-L\-F\-I\-L\-E\-\_\-\-E\-O\-F on \-E\-O\-F. \-If the \hyperlink{structmolfile__timestep__t}{molfile\-\_\-timestep\-\_\-t} argument is \-N\-U\-L\-L, then the frame should be skipped. \-Otherwise, the application must prepare \hyperlink{structmolfile__timestep__t}{molfile\-\_\-timestep\-\_\-t} by allocating space in coords for the corresponding number of coordinates. \-The natoms parameter exists because some coordinate file formats (like \-C\-R\-D) cannot determine for themselves how many atoms are in a timestep; the app must therefore obtain this information elsewhere and provide it to the plugin. \hypertarget{structmolfile__plugin__t_a918c88a4b1455e114b0c4008d8c77823}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!read\-\_\-qm\-\_\-metadata@{read\-\_\-qm\-\_\-metadata}}
\index{read\-\_\-qm\-\_\-metadata@{read\-\_\-qm\-\_\-metadata}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{read\-\_\-qm\-\_\-metadata}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::read\-\_\-qm\-\_\-metadata})({\bf void} $\ast$, {\bf molfile\-\_\-qm\-\_\-metadata\-\_\-t} $\ast$metadata)}}\label{structmolfile__plugin__t_a918c88a4b1455e114b0c4008d8c77823}
\-Retrieve metadata pertaining to \-Q\-M datasets in this file. \hypertarget{structmolfile__plugin__t_a66b4938d266f03b30e38cc8bed9ad473}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!read\-\_\-qm\-\_\-rundata@{read\-\_\-qm\-\_\-rundata}}
\index{read\-\_\-qm\-\_\-rundata@{read\-\_\-qm\-\_\-rundata}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{read\-\_\-qm\-\_\-rundata}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::read\-\_\-qm\-\_\-rundata})({\bf void} $\ast$, {\bf molfile\-\_\-qm\-\_\-t} $\ast$qmdata)}}\label{structmolfile__plugin__t_a66b4938d266f03b30e38cc8bed9ad473}
\-Read \-Q\-M data \hypertarget{structmolfile__plugin__t_a4928ec6da0a4e956c5bd4edeea429c57}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!read\-\_\-qm\-\_\-timestep\-\_\-metadata@{read\-\_\-qm\-\_\-timestep\-\_\-metadata}}
\index{read\-\_\-qm\-\_\-timestep\-\_\-metadata@{read\-\_\-qm\-\_\-timestep\-\_\-metadata}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{read\-\_\-qm\-\_\-timestep\-\_\-metadata}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::read\-\_\-qm\-\_\-timestep\-\_\-metadata})({\bf void} $\ast$, {\bf molfile\-\_\-qm\-\_\-timestep\-\_\-metadata\-\_\-t} $\ast$)}}\label{structmolfile__plugin__t_a4928ec6da0a4e956c5bd4edeea429c57}
\hypertarget{structmolfile__plugin__t_a0318edf94ed266fe5a995c02cf2357d9}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!read\-\_\-rawgraphics@{read\-\_\-rawgraphics}}
\index{read\-\_\-rawgraphics@{read\-\_\-rawgraphics}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{read\-\_\-rawgraphics}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::read\-\_\-rawgraphics})({\bf void} $\ast$, int $\ast$nelem, const {\bf molfile\-\_\-graphics\-\_\-t} $\ast$$\ast$data)}}\label{structmolfile__plugin__t_a0318edf94ed266fe5a995c02cf2357d9}
\-Read raw graphics data stored in this file. \-Return the number of data elements and the data itself as an array of \hyperlink{structmolfile__graphics__t}{molfile\-\_\-graphics\-\_\-t} in the pointer provided by the application. \-The plugin is responsible for freeing the data when the file is closed. \hypertarget{structmolfile__plugin__t_af05a7c088226fc0ecc3fe3feca347754}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!read\-\_\-structure@{read\-\_\-structure}}
\index{read\-\_\-structure@{read\-\_\-structure}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{read\-\_\-structure}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$ {\bf molfile\-\_\-plugin\-\_\-t\-::read\-\_\-structure})({\bf void} $\ast$, int $\ast$optflags, {\bf molfile\-\_\-atom\-\_\-t} $\ast$atoms)}}\label{structmolfile__plugin__t_af05a7c088226fc0ecc3fe3feca347754}
\-Read molecular structure from the given file handle. atoms is allocated by the caller and points to space for natoms. \-On success, place atom information in the passed-\/in pointer. optflags specifies which optional fields in the atoms will be set by the plugin. \hypertarget{structmolfile__plugin__t_a72589b78044886d6e2402c73fa2a72e9}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!read\-\_\-timestep@{read\-\_\-timestep}}
\index{read\-\_\-timestep@{read\-\_\-timestep}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{read\-\_\-timestep}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::read\-\_\-timestep})({\bf void} $\ast$, int natoms, {\bf molfile\-\_\-timestep\-\_\-t} $\ast$, {\bf molfile\-\_\-qm\-\_\-metadata\-\_\-t} $\ast$, {\bf molfile\-\_\-qm\-\_\-timestep\-\_\-t} $\ast$)}}\label{structmolfile__plugin__t_a72589b78044886d6e2402c73fa2a72e9}
\-Read the next timestep from the file. \-Return \-M\-O\-L\-F\-I\-L\-E\-\_\-\-S\-U\-C\-C\-E\-S\-S, or \-M\-O\-L\-F\-I\-L\-E\-\_\-\-E\-O\-F on \-E\-O\-F. \-If the \hyperlink{structmolfile__timestep__t}{molfile\-\_\-timestep\-\_\-t} or \hyperlink{structmolfile__qm__metadata__t}{molfile\-\_\-qm\-\_\-metadata\-\_\-t} arguments are \-N\-U\-L\-L, then the coordinate or qm data should be skipped. \-Otherwise, the application must prepare \hyperlink{structmolfile__timestep__t}{molfile\-\_\-timestep\-\_\-t} and \hyperlink{structmolfile__qm__timestep__t}{molfile\-\_\-qm\-\_\-timestep\-\_\-t} by allocating space for the corresponding number of coordinates, orbital wavefunction coefficients, etc. \-Since it is common for users to want to load only the final timestep data from a \-Q\-M run, the application may provide any combination of valid, or \-N\-U\-L\-L pointers for the \hyperlink{structmolfile__timestep__t}{molfile\-\_\-timestep\-\_\-t} and \hyperlink{structmolfile__qm__timestep__t}{molfile\-\_\-qm\-\_\-timestep\-\_\-t} parameters, depending on what information the user is interested in. \-The natoms and qm metadata parameters exist because some file formats cannot determine for themselves how many atoms etc are in a timestep; the app must therefore obtain this information elsewhere and provide it to the plugin. \hypertarget{structmolfile__plugin__t_a0b7ba8f821b21ab609aebe0b02947a71}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!read\-\_\-timestep\-\_\-metadata@{read\-\_\-timestep\-\_\-metadata}}
\index{read\-\_\-timestep\-\_\-metadata@{read\-\_\-timestep\-\_\-metadata}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{read\-\_\-timestep\-\_\-metadata}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::read\-\_\-timestep\-\_\-metadata})({\bf void} $\ast$, {\bf molfile\-\_\-timestep\-\_\-metadata\-\_\-t} $\ast$)}}\label{structmolfile__plugin__t_a0b7ba8f821b21ab609aebe0b02947a71}
\hypertarget{structmolfile__plugin__t_a535aeec1aea2739b07b2348c239772b9}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!read\-\_\-volumetric\-\_\-data@{read\-\_\-volumetric\-\_\-data}}
\index{read\-\_\-volumetric\-\_\-data@{read\-\_\-volumetric\-\_\-data}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{read\-\_\-volumetric\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::read\-\_\-volumetric\-\_\-data})({\bf void} $\ast$, int set, float $\ast$datablock, float $\ast$colorblock)}}\label{structmolfile__plugin__t_a535aeec1aea2739b07b2348c239772b9}
\-Read the specified volumetric data set into the space pointed to by datablock. \-The set is specified with a zero-\/based index. \-The space allocated for the datablock must be equal to xsize $\ast$ ysize $\ast$ zsize. \-No space will be allocated for colorblock unless has\-\_\-color is nonzero; in that case, colorblock should be filled in with three \-R\-G\-B floats per datapoint. \hypertarget{structmolfile__plugin__t_ac54290d6b607ba8b1fd9e38a1e7f69a1}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!read\-\_\-volumetric\-\_\-metadata@{read\-\_\-volumetric\-\_\-metadata}}
\index{read\-\_\-volumetric\-\_\-metadata@{read\-\_\-volumetric\-\_\-metadata}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{read\-\_\-volumetric\-\_\-metadata}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::read\-\_\-volumetric\-\_\-metadata})({\bf void} $\ast$, int $\ast$nsets, {\bf molfile\-\_\-volumetric\-\_\-t} $\ast$$\ast$metadata)}}\label{structmolfile__plugin__t_ac54290d6b607ba8b1fd9e38a1e7f69a1}
\-Retrieve metadata pertaining to volumetric datasets in this file. \-Set nsets to the number of volumetric data sets, and set $\ast$metadata to point to an array of \hyperlink{structmolfile__volumetric__t}{molfile\-\_\-volumetric\-\_\-t}. \-The array is owned by the plugin and should be freed by \hyperlink{structmolfile__plugin__t_a2fbc2c1623f4453c8bd95548e6c5de53}{close\-\_\-file\-\_\-read()}. \-The application may call this function any number of times. \hypertarget{structmolfile__plugin__t_a0aad2280e74ace06633058e3501a340b}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!vmdplugin\-\_\-\-H\-E\-A\-D@{vmdplugin\-\_\-\-H\-E\-A\-D}}
\index{vmdplugin\-\_\-\-H\-E\-A\-D@{vmdplugin\-\_\-\-H\-E\-A\-D}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{vmdplugin\-\_\-\-H\-E\-A\-D}]{\setlength{\rightskip}{0pt plus 5cm}{\bf molfile\-\_\-plugin\-\_\-t\-::vmdplugin\-\_\-\-H\-E\-A\-D}}}\label{structmolfile__plugin__t_a0aad2280e74ace06633058e3501a340b}
\-Required header \hypertarget{structmolfile__plugin__t_a39e12d9cbf00ffa9e5da4845825d3846}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!write\-\_\-angles@{write\-\_\-angles}}
\index{write\-\_\-angles@{write\-\_\-angles}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{write\-\_\-angles}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::write\-\_\-angles})({\bf void} $\ast$handle, int numangles, const int $\ast${\bf angles}, const int $\ast$angletypes, int numangletypes, const char $\ast$$\ast$angletypenames, int numdihedrals, const int $\ast$dihedrals, const int $\ast$dihedraltypes, int numdihedraltypes, const char $\ast$$\ast$dihedraltypenames, int numimpropers, const int $\ast$impropers, const int $\ast$impropertypes, int numimpropertypes, const char $\ast$$\ast$impropertypenames, int numcterms, const int $\ast$cterms, int ctermcols, int ctermrows)}}\label{structmolfile__plugin__t_a39e12d9cbf00ffa9e5da4845825d3846}
\-Write out \-Angles, \-Dihedrals, \-Impropers, and \-Cross \-Terms (\-Cross terms pertain to the \-C\-H\-A\-R\-M\-M/\-N\-A\-M\-D \-C\-M\-A\-P feature) \hypertarget{structmolfile__plugin__t_a0af11d8d87bbc73eb219a02039204c65}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!write\-\_\-bonds@{write\-\_\-bonds}}
\index{write\-\_\-bonds@{write\-\_\-bonds}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{write\-\_\-bonds}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::write\-\_\-bonds})({\bf void} $\ast$, int nbonds, int $\ast$from, int $\ast$to, float $\ast$bondorder, int $\ast$bondtype, int nbondtypes, char $\ast$$\ast$bondtypename)}}\label{structmolfile__plugin__t_a0af11d8d87bbc73eb219a02039204c65}
\-Write bond information for the molecule. \-The arrays from and to point to the (one-\/based) indices of bonded atoms. \-Each unique bond will be specified only once by the caller. \-File formats that list bonds twice will need to emit both the from/to and to/from versions of each. \-This function must be called before \hyperlink{structmolfile__plugin__t_a96caabc2f33c5a710e82cfe20316568f}{write\-\_\-structure()}.

\-Like the \hyperlink{structmolfile__plugin__t_a6e1aca38d75aacb2cbcf6401261cdb5f}{read\-\_\-bonds()} routine, the bondorder pointer is set to \-N\-U\-L\-L if the caller doesn't have such information, in which case the plugin should assume a bond order of 1.\-0 if the file format requires bond order information.

\-Support for bond types follows the bondorder rules. bondtype is an integer array of the size nbonds that contains the bond type index (consecutive integers starting from 0) and bondtypenames contain the corresponding strings, in case the naming/numbering scheme is different from the index numbers. if the pointers are set to \-N\-U\-L\-L, then this information is not available. bondtypenames can only be used of bondtypes is also given. \-Return \-M\-O\-L\-F\-I\-L\-E\-\_\-\-S\-U\-C\-C\-E\-S\-S if no errors occur. \hypertarget{structmolfile__plugin__t_a96caabc2f33c5a710e82cfe20316568f}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!write\-\_\-structure@{write\-\_\-structure}}
\index{write\-\_\-structure@{write\-\_\-structure}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{write\-\_\-structure}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::write\-\_\-structure})({\bf void} $\ast$, int optflags, const {\bf molfile\-\_\-atom\-\_\-t} $\ast$atoms)}}\label{structmolfile__plugin__t_a96caabc2f33c5a710e82cfe20316568f}
\-Write structure information. \-Return success. \hypertarget{structmolfile__plugin__t_acf10fad00927486a1ce859852658e7b0}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!write\-\_\-timestep@{write\-\_\-timestep}}
\index{write\-\_\-timestep@{write\-\_\-timestep}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{write\-\_\-timestep}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::write\-\_\-timestep})({\bf void} $\ast$, const {\bf molfile\-\_\-timestep\-\_\-t} $\ast$)}}\label{structmolfile__plugin__t_acf10fad00927486a1ce859852658e7b0}
\-Write a timestep to the coordinate file. \-Return \-M\-O\-L\-F\-I\-L\-E\-\_\-\-S\-U\-C\-C\-E\-S\-S if no errors occur. \-If the file contains structure information in each timestep (like a multi-\/entry \-P\-D\-B), it will have to cache the information from the initial calls from write\-\_\-structure. \hypertarget{structmolfile__plugin__t_a46cdd765aa39c041ab2e3ab824d8be5d}{\index{molfile\-\_\-plugin\-\_\-t@{molfile\-\_\-plugin\-\_\-t}!write\-\_\-volumetric\-\_\-data@{write\-\_\-volumetric\-\_\-data}}
\index{write\-\_\-volumetric\-\_\-data@{write\-\_\-volumetric\-\_\-data}!molfile_plugin_t@{molfile\-\_\-plugin\-\_\-t}}
\subsubsection[{write\-\_\-volumetric\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}int($\ast$  {\bf molfile\-\_\-plugin\-\_\-t\-::write\-\_\-volumetric\-\_\-data})({\bf void} $\ast$, {\bf molfile\-\_\-volumetric\-\_\-t} $\ast$metadata, float $\ast$datablock, float $\ast$colorblock)}}\label{structmolfile__plugin__t_a46cdd765aa39c041ab2e3ab824d8be5d}
\-Write the specified volumetric data set into the space pointed to by datablock. \-The $\ast$ allocated for the datablock must be equal to xsize $\ast$ ysize $\ast$ zsize. \-No space will be allocated for colorblock unless has\-\_\-color is nonzero; in that case, colorblock should be filled in with three \-R\-G\-B floats per datapoint. 

\-The documentation for this struct was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
src/gmxlib/\hyperlink{molfile__plugin_8h}{molfile\-\_\-plugin.\-h}\end{DoxyCompactItemize}
