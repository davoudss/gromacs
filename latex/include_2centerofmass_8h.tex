\hypertarget{include_2centerofmass_8h}{\section{include/centerofmass.h \-File \-Reference}
\label{include_2centerofmass_8h}\index{include/centerofmass.\-h@{include/centerofmass.\-h}}
}


\-A\-P\-I for calculation of centers of mass/geometry.  


{\ttfamily \#include \char`\"{}typedefs.\-h\char`\"{}}\*
\-Include dependency graph for centerofmass.\-h\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2centerofmass_8h__incl}
\end{center}
\end{figure}
\subsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{include_2centerofmass_8h_a742f1f05e6b37d5d795b338de4843929}{gmx\-\_\-calc\-\_\-cog} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]}, int nrefat, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a49fd977001162d7256c8fcd293f9d12a}{index}\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout)
\item 
int \hyperlink{include_2centerofmass_8h_a9854c5035749493ab405abd66ba7bcef}{gmx\-\_\-calc\-\_\-com} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]}, int nrefat, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a49fd977001162d7256c8fcd293f9d12a}{index}\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout)
\item 
int \hyperlink{include_2centerofmass_8h_ab9946cbd5c24f144235b272d500b811e}{gmx\-\_\-calc\-\_\-cog\-\_\-f} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{copyrite_8c_a0757cfb6fe645a02867727255faa4f8b}{f}\mbox{[}$\,$\mbox{]}, int nrefat, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a49fd977001162d7256c8fcd293f9d12a}{index}\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} fout)
\item 
int \hyperlink{include_2centerofmass_8h_a297ae966b68adddd1606554a7edceb13}{gmx\-\_\-calc\-\_\-comg} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]}, int nrefat, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a49fd977001162d7256c8fcd293f9d12a}{index}\mbox{[}$\,$\mbox{]}, \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} b\-Mass, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout)
\item 
int \hyperlink{include_2centerofmass_8h_aeadcc3855c61b7fdcb5af3965af4fcdb}{gmx\-\_\-calc\-\_\-comg\-\_\-f} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{copyrite_8c_a0757cfb6fe645a02867727255faa4f8b}{f}\mbox{[}$\,$\mbox{]}, int nrefat, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a49fd977001162d7256c8fcd293f9d12a}{index}\mbox{[}$\,$\mbox{]}, \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} b\-Mass, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} fout)
\item 
int \hyperlink{include_2centerofmass_8h_af5d88cb41629e93fdfe98ccdb7375637}{gmx\-\_\-calc\-\_\-cog\-\_\-pbc} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]}, \hyperlink{structt__pbc}{t\-\_\-pbc} $\ast$pbc, int nrefat, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a49fd977001162d7256c8fcd293f9d12a}{index}\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout)
\item 
int \hyperlink{include_2centerofmass_8h_aabb2f8905bf67f03350f1aad822b1596}{gmx\-\_\-calc\-\_\-com\-\_\-pbc} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]}, \hyperlink{structt__pbc}{t\-\_\-pbc} $\ast$pbc, int nrefat, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a49fd977001162d7256c8fcd293f9d12a}{index}\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout)
\item 
int \hyperlink{include_2centerofmass_8h_ae966fdbe78bcf9fb9d89b70b64b3c21d}{gmx\-\_\-calc\-\_\-comg\-\_\-pbc} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]}, \hyperlink{structt__pbc}{t\-\_\-pbc} $\ast$pbc, int nrefat, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a49fd977001162d7256c8fcd293f9d12a}{index}\mbox{[}$\,$\mbox{]}, \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} b\-Mass, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout)
\item 
int \hyperlink{include_2centerofmass_8h_a4b7f02d5a9fa27343ae9d1c9672aae7c}{gmx\-\_\-calc\-\_\-cog\-\_\-block} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]}, \hyperlink{structt__block}{t\-\_\-block} $\ast$block, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a49fd977001162d7256c8fcd293f9d12a}{index}\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{include_2centerofmass_8h_accf307bb2ab7762c8b8a8d02976df463}{gmx\-\_\-calc\-\_\-com\-\_\-block} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]}, \hyperlink{structt__block}{t\-\_\-block} $\ast$block, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a49fd977001162d7256c8fcd293f9d12a}{index}\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{include_2centerofmass_8h_acca887acb94fd829d63c9ef0a51cfbf0}{gmx\-\_\-calc\-\_\-cog\-\_\-f\-\_\-block} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{copyrite_8c_a0757cfb6fe645a02867727255faa4f8b}{f}\mbox{[}$\,$\mbox{]}, \hyperlink{structt__block}{t\-\_\-block} $\ast$block, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a49fd977001162d7256c8fcd293f9d12a}{index}\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} fout\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{include_2centerofmass_8h_a6365bcf7784e9c01d7a498252e6f2871}{gmx\-\_\-calc\-\_\-comg\-\_\-block} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]}, \hyperlink{structt__block}{t\-\_\-block} $\ast$block, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a49fd977001162d7256c8fcd293f9d12a}{index}\mbox{[}$\,$\mbox{]}, \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} b\-Mass, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{include_2centerofmass_8h_a0e7aa7ceaa7e7c010da97efa0868c320}{gmx\-\_\-calc\-\_\-comg\-\_\-f\-\_\-block} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{copyrite_8c_a0757cfb6fe645a02867727255faa4f8b}{f}\mbox{[}$\,$\mbox{]}, \hyperlink{structt__block}{t\-\_\-block} $\ast$block, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a49fd977001162d7256c8fcd293f9d12a}{index}\mbox{[}$\,$\mbox{]}, \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} b\-Mass, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} fout\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{include_2centerofmass_8h_a2290a28e334d43eef66794120970f3cf}{gmx\-\_\-calc\-\_\-comg\-\_\-blocka} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]}, \hyperlink{structt__blocka}{t\-\_\-blocka} $\ast$block, \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} b\-Mass, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{include_2centerofmass_8h_aeef133db1de6ad3d02cd96337f5c9faf}{gmx\-\_\-calc\-\_\-comg\-\_\-f\-\_\-blocka} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]}, \hyperlink{structt__blocka}{t\-\_\-blocka} $\ast$block, \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} b\-Mass, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}


\subsection{\-Detailed \-Description}
\-A\-P\-I for calculation of centers of mass/geometry. \-This header defines a few functions that can be used to calculate centers of mass/geometry for a group of atoms. \-These routines can be used independently of the other parts of the library, but they are also used internally by the selection engine. \-In most cases, it should not be necessary to call these functions directly. \-Instead, one should write an analysis tool such that it gets all positions through selections.

\-The functions in the header can be divided into a few groups based on the parameters they take. \-The simplest group of functions calculates the center of a single group of atoms\-:
\begin{DoxyItemize}
\item \hyperlink{include_2centerofmass_8h_a742f1f05e6b37d5d795b338de4843929}{gmx\-\_\-calc\-\_\-cog()}\-: \-Calculates the center of geometry (\-C\-O\-G) of a given group of atoms.
\item \hyperlink{include_2centerofmass_8h_a9854c5035749493ab405abd66ba7bcef}{gmx\-\_\-calc\-\_\-com()}\-: \-Calculates the center of mass (\-C\-O\-M) of a given group of atoms.
\item \hyperlink{include_2centerofmass_8h_a297ae966b68adddd1606554a7edceb13}{gmx\-\_\-calc\-\_\-comg()}\-: \-Calculates either the \-C\-O\-M or \-C\-O\-G, based on a gmx\-\_\-boolean flag.
\end{DoxyItemize}

\-A second set of routines is provided for calculating the centers for groups that wrap over periodic boundaries (\hyperlink{include_2centerofmass_8h_af5d88cb41629e93fdfe98ccdb7375637}{gmx\-\_\-calc\-\_\-cog\-\_\-pbc()}, \hyperlink{include_2centerofmass_8h_aabb2f8905bf67f03350f1aad822b1596}{gmx\-\_\-calc\-\_\-com\-\_\-pbc()}, \hyperlink{include_2centerofmass_8h_ae966fdbe78bcf9fb9d89b70b64b3c21d}{gmx\-\_\-calc\-\_\-comg\-\_\-pbc()}). \-These functions are slower, because they need to adjust the center iteratively.

\-It is also possible to calculate centers for several groups of atoms in one call. \-The functions \hyperlink{include_2centerofmass_8h_a4b7f02d5a9fa27343ae9d1c9672aae7c}{gmx\-\_\-calc\-\_\-cog\-\_\-block()}, \hyperlink{include_2centerofmass_8h_accf307bb2ab7762c8b8a8d02976df463}{gmx\-\_\-calc\-\_\-com\-\_\-block()} and \hyperlink{include_2centerofmass_8h_a6365bcf7784e9c01d7a498252e6f2871}{gmx\-\_\-calc\-\_\-comg\-\_\-block()} take an index group and a partitioning of that index group (as a {\ttfamily \hyperlink{structt__block}{t\-\_\-block}} structure), and calculate the centers for each group defined by the {\ttfamily \hyperlink{structt__block}{t\-\_\-block}} structure separately.

\-Finally, there is a function \hyperlink{include_2centerofmass_8h_a2290a28e334d43eef66794120970f3cf}{gmx\-\_\-calc\-\_\-comg\-\_\-blocka()} that takes both the index group and the partitioning as a single {\ttfamily \hyperlink{structt__blocka}{t\-\_\-blocka}} structure. 

\subsection{\-Function \-Documentation}
\hypertarget{include_2centerofmass_8h_a742f1f05e6b37d5d795b338de4843929}{\index{include/centerofmass.\-h@{include/centerofmass.\-h}!gmx\-\_\-calc\-\_\-cog@{gmx\-\_\-calc\-\_\-cog}}
\index{gmx\-\_\-calc\-\_\-cog@{gmx\-\_\-calc\-\_\-cog}!include/centerofmass.h@{include/centerofmass.\-h}}
\subsubsection[{gmx\-\_\-calc\-\_\-cog}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-calc\-\_\-cog} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}, }
\item[{int}]{nrefat, }
\item[{{\bf atom\-\_\-id}}]{index\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{xout}
\end{DoxyParamCaption}
)}}\label{include_2centerofmass_8h_a742f1f05e6b37d5d795b338de4843929}
\-Calculate a single center of geometry.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Topology structure (unused, can be \-N\-U\-L\-L). \\
\hline
\mbox{\tt in}  & {\em x} & \-Position vectors of all atoms. \\
\hline
\mbox{\tt in}  & {\em nrefat} & \-Number of atoms in the index. \\
\hline
\mbox{\tt in}  & {\em index} & \-Indices of atoms. \\
\hline
\mbox{\tt out}  & {\em xout} & \-C\-O\-G position for the indexed atoms. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success. 
\end{DoxyReturn}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2centerofmass_8h_a742f1f05e6b37d5d795b338de4843929_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2centerofmass_8h_a4b7f02d5a9fa27343ae9d1c9672aae7c}{\index{include/centerofmass.\-h@{include/centerofmass.\-h}!gmx\-\_\-calc\-\_\-cog\-\_\-block@{gmx\-\_\-calc\-\_\-cog\-\_\-block}}
\index{gmx\-\_\-calc\-\_\-cog\-\_\-block@{gmx\-\_\-calc\-\_\-cog\-\_\-block}!include/centerofmass.h@{include/centerofmass.\-h}}
\subsubsection[{gmx\-\_\-calc\-\_\-cog\-\_\-block}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-calc\-\_\-cog\-\_\-block} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}, }
\item[{{\bf t\-\_\-block} $\ast$}]{block, }
\item[{{\bf atom\-\_\-id}}]{index\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{xout\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{include_2centerofmass_8h_a4b7f02d5a9fa27343ae9d1c9672aae7c}
\-Calculate centers of geometry for a blocked index.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Topology structure (unused, can be \-N\-U\-L\-L). \\
\hline
\mbox{\tt in}  & {\em x} & \-Position vectors of all atoms. \\
\hline
\mbox{\tt in}  & {\em block} & \hyperlink{structt__block}{t\-\_\-block} structure that divides {\ttfamily index} into blocks. \\
\hline
\mbox{\tt in}  & {\em index} & \-Indices of atoms. \\
\hline
\mbox{\tt out}  & {\em xout} & {\ttfamily block-\/$>$nr} \-C\-O\-G positions. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success. 
\end{DoxyReturn}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2centerofmass_8h_a4b7f02d5a9fa27343ae9d1c9672aae7c_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2centerofmass_8h_ab9946cbd5c24f144235b272d500b811e}{\index{include/centerofmass.\-h@{include/centerofmass.\-h}!gmx\-\_\-calc\-\_\-cog\-\_\-f@{gmx\-\_\-calc\-\_\-cog\-\_\-f}}
\index{gmx\-\_\-calc\-\_\-cog\-\_\-f@{gmx\-\_\-calc\-\_\-cog\-\_\-f}!include/centerofmass.h@{include/centerofmass.\-h}}
\subsubsection[{gmx\-\_\-calc\-\_\-cog\-\_\-f}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-calc\-\_\-cog\-\_\-f} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf rvec}}]{f\mbox{[}$\,$\mbox{]}, }
\item[{int}]{nrefat, }
\item[{{\bf atom\-\_\-id}}]{index\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{fout}
\end{DoxyParamCaption}
)}}\label{include_2centerofmass_8h_ab9946cbd5c24f144235b272d500b811e}
\-Calculate force on a single center of geometry.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Topology structure with masses. \\
\hline
\mbox{\tt in}  & {\em f} & \-Forces on all atoms. \\
\hline
\mbox{\tt in}  & {\em nrefat} & \-Number of atoms in the index. \\
\hline
\mbox{\tt in}  & {\em index} & \-Indices of atoms. \\
\hline
\mbox{\tt out}  & {\em fout} & \-Force on the \-C\-O\-G position for the indexed atoms. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, \-E\-I\-N\-V\-A\-L if {\ttfamily top} is \-N\-U\-L\-L.
\end{DoxyReturn}
\-No special function is provided for calculating the force on the center of mass, because this can be achieved with \hyperlink{include_2centerofmass_8h_a742f1f05e6b37d5d795b338de4843929}{gmx\-\_\-calc\-\_\-cog()}. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2centerofmass_8h_ab9946cbd5c24f144235b272d500b811e_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2centerofmass_8h_acca887acb94fd829d63c9ef0a51cfbf0}{\index{include/centerofmass.\-h@{include/centerofmass.\-h}!gmx\-\_\-calc\-\_\-cog\-\_\-f\-\_\-block@{gmx\-\_\-calc\-\_\-cog\-\_\-f\-\_\-block}}
\index{gmx\-\_\-calc\-\_\-cog\-\_\-f\-\_\-block@{gmx\-\_\-calc\-\_\-cog\-\_\-f\-\_\-block}!include/centerofmass.h@{include/centerofmass.\-h}}
\subsubsection[{gmx\-\_\-calc\-\_\-cog\-\_\-f\-\_\-block}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-calc\-\_\-cog\-\_\-f\-\_\-block} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf rvec}}]{f\mbox{[}$\,$\mbox{]}, }
\item[{{\bf t\-\_\-block} $\ast$}]{block, }
\item[{{\bf atom\-\_\-id}}]{index\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{fout\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{include_2centerofmass_8h_acca887acb94fd829d63c9ef0a51cfbf0}
\-Calculate forces on centers of geometry for a blocked index.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Topology structure with masses. \\
\hline
\mbox{\tt in}  & {\em f} & \-Forces on all atoms. \\
\hline
\mbox{\tt in}  & {\em block} & \hyperlink{structt__block}{t\-\_\-block} structure that divides {\ttfamily index} into blocks. \\
\hline
\mbox{\tt in}  & {\em index} & \-Indices of atoms. \\
\hline
\mbox{\tt out}  & {\em xout} & {\ttfamily block-\/$>$nr} \-Forces on \-C\-O\-G positions. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, \-E\-I\-N\-V\-A\-L if {\ttfamily top} is \-N\-U\-L\-L. 
\end{DoxyReturn}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2centerofmass_8h_acca887acb94fd829d63c9ef0a51cfbf0_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2centerofmass_8h_af5d88cb41629e93fdfe98ccdb7375637}{\index{include/centerofmass.\-h@{include/centerofmass.\-h}!gmx\-\_\-calc\-\_\-cog\-\_\-pbc@{gmx\-\_\-calc\-\_\-cog\-\_\-pbc}}
\index{gmx\-\_\-calc\-\_\-cog\-\_\-pbc@{gmx\-\_\-calc\-\_\-cog\-\_\-pbc}!include/centerofmass.h@{include/centerofmass.\-h}}
\subsubsection[{gmx\-\_\-calc\-\_\-cog\-\_\-pbc}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-calc\-\_\-cog\-\_\-pbc} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}, }
\item[{{\bf t\-\_\-pbc} $\ast$}]{pbc, }
\item[{int}]{nrefat, }
\item[{{\bf atom\-\_\-id}}]{index\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{xout}
\end{DoxyParamCaption}
)}}\label{include_2centerofmass_8h_af5d88cb41629e93fdfe98ccdb7375637}
\-Calculate a single center of geometry iteratively, taking \-P\-B\-C into account.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Topology structure (unused, can be \-N\-U\-L\-L). \\
\hline
\mbox{\tt in}  & {\em x} & \-Position vectors of all atoms. \\
\hline
\mbox{\tt in}  & {\em pbc} & \-Periodic boundary conditions structure. \\
\hline
\mbox{\tt in}  & {\em nrefat} & \-Number of atoms in the index. \\
\hline
\mbox{\tt in}  & {\em index} & \-Indices of atoms. \\
\hline
\mbox{\tt out}  & {\em xout} & \-C\-O\-G position for the indexed atoms. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success.
\end{DoxyReturn}
\-Works exactly as \hyperlink{include_2centerofmass_8h_aabb2f8905bf67f03350f1aad822b1596}{gmx\-\_\-calc\-\_\-com\-\_\-pbc()}, but calculates the center of geometry. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2centerofmass_8h_af5d88cb41629e93fdfe98ccdb7375637_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2centerofmass_8h_a9854c5035749493ab405abd66ba7bcef}{\index{include/centerofmass.\-h@{include/centerofmass.\-h}!gmx\-\_\-calc\-\_\-com@{gmx\-\_\-calc\-\_\-com}}
\index{gmx\-\_\-calc\-\_\-com@{gmx\-\_\-calc\-\_\-com}!include/centerofmass.h@{include/centerofmass.\-h}}
\subsubsection[{gmx\-\_\-calc\-\_\-com}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-calc\-\_\-com} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}, }
\item[{int}]{nrefat, }
\item[{{\bf atom\-\_\-id}}]{index\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{xout}
\end{DoxyParamCaption}
)}}\label{include_2centerofmass_8h_a9854c5035749493ab405abd66ba7bcef}
\-Calculate a single center of mass.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Topology structure with masses. \\
\hline
\mbox{\tt in}  & {\em x} & \-Position vectors of all atoms. \\
\hline
\mbox{\tt in}  & {\em nrefat} & \-Number of atoms in the index. \\
\hline
\mbox{\tt in}  & {\em index} & \-Indices of atoms. \\
\hline
\mbox{\tt out}  & {\em xout} & \-C\-O\-M position for the indexed atoms. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, \-E\-I\-N\-V\-A\-L if {\ttfamily top} is \-N\-U\-L\-L.
\end{DoxyReturn}
\-Works exactly as \hyperlink{include_2centerofmass_8h_a742f1f05e6b37d5d795b338de4843929}{gmx\-\_\-calc\-\_\-cog()} with the exception that a center of mass are calculated, and hence a topology with masses is required. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2centerofmass_8h_a9854c5035749493ab405abd66ba7bcef_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2centerofmass_8h_accf307bb2ab7762c8b8a8d02976df463}{\index{include/centerofmass.\-h@{include/centerofmass.\-h}!gmx\-\_\-calc\-\_\-com\-\_\-block@{gmx\-\_\-calc\-\_\-com\-\_\-block}}
\index{gmx\-\_\-calc\-\_\-com\-\_\-block@{gmx\-\_\-calc\-\_\-com\-\_\-block}!include/centerofmass.h@{include/centerofmass.\-h}}
\subsubsection[{gmx\-\_\-calc\-\_\-com\-\_\-block}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-calc\-\_\-com\-\_\-block} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}, }
\item[{{\bf t\-\_\-block} $\ast$}]{block, }
\item[{{\bf atom\-\_\-id}}]{index\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{xout\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{include_2centerofmass_8h_accf307bb2ab7762c8b8a8d02976df463}
\-Calculate centers of mass for a blocked index.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Topology structure with masses. \\
\hline
\mbox{\tt in}  & {\em x} & \-Position vectors of all atoms. \\
\hline
\mbox{\tt in}  & {\em block} & \hyperlink{structt__block}{t\-\_\-block} structure that divides {\ttfamily index} into blocks. \\
\hline
\mbox{\tt in}  & {\em index} & \-Indices of atoms. \\
\hline
\mbox{\tt out}  & {\em xout} & {\ttfamily block-\/$>$nr} \-C\-O\-M positions. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, \-E\-I\-N\-V\-A\-L if {\ttfamily top} is \-N\-U\-L\-L.
\end{DoxyReturn}
\-Works exactly as \hyperlink{include_2centerofmass_8h_a4b7f02d5a9fa27343ae9d1c9672aae7c}{gmx\-\_\-calc\-\_\-cog\-\_\-block()} with the exception that centers of mass are calculated, and hence a topology with masses is required. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2centerofmass_8h_accf307bb2ab7762c8b8a8d02976df463_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2centerofmass_8h_aabb2f8905bf67f03350f1aad822b1596}{\index{include/centerofmass.\-h@{include/centerofmass.\-h}!gmx\-\_\-calc\-\_\-com\-\_\-pbc@{gmx\-\_\-calc\-\_\-com\-\_\-pbc}}
\index{gmx\-\_\-calc\-\_\-com\-\_\-pbc@{gmx\-\_\-calc\-\_\-com\-\_\-pbc}!include/centerofmass.h@{include/centerofmass.\-h}}
\subsubsection[{gmx\-\_\-calc\-\_\-com\-\_\-pbc}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-calc\-\_\-com\-\_\-pbc} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}, }
\item[{{\bf t\-\_\-pbc} $\ast$}]{pbc, }
\item[{int}]{nrefat, }
\item[{{\bf atom\-\_\-id}}]{index\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{xout}
\end{DoxyParamCaption}
)}}\label{include_2centerofmass_8h_aabb2f8905bf67f03350f1aad822b1596}
\-Calculate a single center of mass iteratively, taking \-P\-B\-C into account.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Topology structure with masses. \\
\hline
\mbox{\tt in}  & {\em x} & \-Position vectors of all atoms. \\
\hline
\mbox{\tt in}  & {\em pbc} & \-Periodic boundary conditions structure. \\
\hline
\mbox{\tt in}  & {\em nrefat} & \-Number of atoms in the index. \\
\hline
\mbox{\tt in}  & {\em index} & \-Indices of atoms. \\
\hline
\mbox{\tt out}  & {\em xout} & \-C\-O\-M position for the indexed atoms. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, \-E\-I\-N\-V\-A\-L if {\ttfamily top} is \-N\-U\-L\-L.
\end{DoxyReturn}
\-Works as \hyperlink{include_2centerofmass_8h_a9854c5035749493ab405abd66ba7bcef}{gmx\-\_\-calc\-\_\-com()}, but takes into account periodic boundary conditions\-: \-If any atom is more than half the box from the \-C\-O\-M, it is wrapped around and a new \-C\-O\-M is calculated. \-This is repeated until no atoms violate the condition.

\-Modified from src/tools/gmx\-\_\-sorient.\-c in \-Gromacs distribution. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2centerofmass_8h_aabb2f8905bf67f03350f1aad822b1596_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2centerofmass_8h_a297ae966b68adddd1606554a7edceb13}{\index{include/centerofmass.\-h@{include/centerofmass.\-h}!gmx\-\_\-calc\-\_\-comg@{gmx\-\_\-calc\-\_\-comg}}
\index{gmx\-\_\-calc\-\_\-comg@{gmx\-\_\-calc\-\_\-comg}!include/centerofmass.h@{include/centerofmass.\-h}}
\subsubsection[{gmx\-\_\-calc\-\_\-comg}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-calc\-\_\-comg} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}, }
\item[{int}]{nrefat, }
\item[{{\bf atom\-\_\-id}}]{index\mbox{[}$\,$\mbox{]}, }
\item[{{\bf gmx\-\_\-bool}}]{b\-Mass, }
\item[{{\bf rvec}}]{xout}
\end{DoxyParamCaption}
)}}\label{include_2centerofmass_8h_a297ae966b68adddd1606554a7edceb13}
\-Calculate a single center of mass/geometry.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Topology structure with masses (can be \-N\-U\-L\-L if {\ttfamily b\-M\-A\-S\-S==\-F\-A\-L\-S\-E}). \\
\hline
\mbox{\tt in}  & {\em x} & \-Position vectors of all atoms. \\
\hline
\mbox{\tt in}  & {\em nrefat} & \-Number of atoms in the index. \\
\hline
\mbox{\tt in}  & {\em index} & \-Indices of atoms. \\
\hline
\mbox{\tt in}  & {\em b\-Mass} & \-If \-T\-R\-U\-E, mass weighting is used. \\
\hline
\mbox{\tt out}  & {\em xout} & \-C\-O\-M/\-C\-O\-G position for the indexed atoms. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, \-E\-I\-N\-V\-A\-L if {\ttfamily top} is \-N\-U\-L\-L and {\ttfamily b\-Mass} is \-T\-R\-U\-E.
\end{DoxyReturn}
\-Calls either \hyperlink{include_2centerofmass_8h_a9854c5035749493ab405abd66ba7bcef}{gmx\-\_\-calc\-\_\-com()} or \hyperlink{include_2centerofmass_8h_a742f1f05e6b37d5d795b338de4843929}{gmx\-\_\-calc\-\_\-cog()} depending on the value of {\ttfamily b\-Mass}. \-Other parameters are passed unmodified to these functions. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2centerofmass_8h_a297ae966b68adddd1606554a7edceb13_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2centerofmass_8h_a6365bcf7784e9c01d7a498252e6f2871}{\index{include/centerofmass.\-h@{include/centerofmass.\-h}!gmx\-\_\-calc\-\_\-comg\-\_\-block@{gmx\-\_\-calc\-\_\-comg\-\_\-block}}
\index{gmx\-\_\-calc\-\_\-comg\-\_\-block@{gmx\-\_\-calc\-\_\-comg\-\_\-block}!include/centerofmass.h@{include/centerofmass.\-h}}
\subsubsection[{gmx\-\_\-calc\-\_\-comg\-\_\-block}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-calc\-\_\-comg\-\_\-block} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}, }
\item[{{\bf t\-\_\-block} $\ast$}]{block, }
\item[{{\bf atom\-\_\-id}}]{index\mbox{[}$\,$\mbox{]}, }
\item[{{\bf gmx\-\_\-bool}}]{b\-Mass, }
\item[{{\bf rvec}}]{xout\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{include_2centerofmass_8h_a6365bcf7784e9c01d7a498252e6f2871}
\-Calculate centers of mass/geometry for a blocked index.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Topology structure with masses (can be \-N\-U\-L\-L if {\ttfamily b\-M\-A\-S\-S==\-F\-A\-L\-S\-E}). \\
\hline
\mbox{\tt in}  & {\em x} & \-Position vectors of all atoms. \\
\hline
\mbox{\tt in}  & {\em block} & \hyperlink{structt__block}{t\-\_\-block} structure that divides {\ttfamily index} into blocks. \\
\hline
\mbox{\tt in}  & {\em index} & \-Indices of atoms. \\
\hline
\mbox{\tt in}  & {\em b\-Mass} & \-If \-T\-R\-U\-E, mass weighting is used. \\
\hline
\mbox{\tt out}  & {\em xout} & {\ttfamily block-\/$>$nr} \-C\-O\-M/\-C\-O\-G positions. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, \-E\-I\-N\-V\-A\-L if {\ttfamily top} is \-N\-U\-L\-L and {\ttfamily b\-Mass} is \-T\-R\-U\-E.
\end{DoxyReturn}
\-Calls either \hyperlink{include_2centerofmass_8h_accf307bb2ab7762c8b8a8d02976df463}{gmx\-\_\-calc\-\_\-com\-\_\-block()} or \hyperlink{include_2centerofmass_8h_a4b7f02d5a9fa27343ae9d1c9672aae7c}{gmx\-\_\-calc\-\_\-cog\-\_\-block()} depending on the value of {\ttfamily b\-Mass}. \-Other parameters are passed unmodified to these functions. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2centerofmass_8h_a6365bcf7784e9c01d7a498252e6f2871_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2centerofmass_8h_a2290a28e334d43eef66794120970f3cf}{\index{include/centerofmass.\-h@{include/centerofmass.\-h}!gmx\-\_\-calc\-\_\-comg\-\_\-blocka@{gmx\-\_\-calc\-\_\-comg\-\_\-blocka}}
\index{gmx\-\_\-calc\-\_\-comg\-\_\-blocka@{gmx\-\_\-calc\-\_\-comg\-\_\-blocka}!include/centerofmass.h@{include/centerofmass.\-h}}
\subsubsection[{gmx\-\_\-calc\-\_\-comg\-\_\-blocka}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-calc\-\_\-comg\-\_\-blocka} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}, }
\item[{{\bf t\-\_\-blocka} $\ast$}]{block, }
\item[{{\bf gmx\-\_\-bool}}]{b\-Mass, }
\item[{{\bf rvec}}]{xout\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{include_2centerofmass_8h_a2290a28e334d43eef66794120970f3cf}
\-Calculate centers of mass/geometry for a set of blocks;


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Topology structure with masses (can be \-N\-U\-L\-L if {\ttfamily b\-M\-A\-S\-S==\-F\-A\-L\-S\-E}). \\
\hline
\mbox{\tt in}  & {\em x} & \-Position vectors of all atoms. \\
\hline
\mbox{\tt in}  & {\em block} & \-Blocks for calculation. \\
\hline
\mbox{\tt in}  & {\em b\-Mass} & \-If \-T\-R\-U\-E, mass weighting is used. \\
\hline
\mbox{\tt out}  & {\em xout} & {\ttfamily block-\/$>$nr} \-C\-O\-M/\-C\-O\-G positions. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, \-E\-I\-N\-V\-A\-L if {\ttfamily top} is \-N\-U\-L\-L and {\ttfamily b\-Mass} is \-T\-R\-U\-E.
\end{DoxyReturn}
\-Calls \hyperlink{include_2centerofmass_8h_a6365bcf7784e9c01d7a498252e6f2871}{gmx\-\_\-calc\-\_\-comg\-\_\-block()}, converting the {\ttfamily \hyperlink{structt__blocka}{t\-\_\-blocka}} structure into a {\ttfamily \hyperlink{structt__block}{t\-\_\-block}} and an index. \-Other parameters are passed unmodified.

\begin{DoxyAttention}{\-Attention}
\-This function assumes that a pointer to {\ttfamily \hyperlink{structt__blocka}{t\-\_\-blocka}} can be safely typecast into {\ttfamily \hyperlink{structt__block}{t\-\_\-block}} such that the index fields can still be referenced. \-With the present \-Gromacs defitions of these types, this is the case, but if the layout of these structures is changed, this may lead to strange crashes. 
\end{DoxyAttention}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2centerofmass_8h_a2290a28e334d43eef66794120970f3cf_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2centerofmass_8h_aeadcc3855c61b7fdcb5af3965af4fcdb}{\index{include/centerofmass.\-h@{include/centerofmass.\-h}!gmx\-\_\-calc\-\_\-comg\-\_\-f@{gmx\-\_\-calc\-\_\-comg\-\_\-f}}
\index{gmx\-\_\-calc\-\_\-comg\-\_\-f@{gmx\-\_\-calc\-\_\-comg\-\_\-f}!include/centerofmass.h@{include/centerofmass.\-h}}
\subsubsection[{gmx\-\_\-calc\-\_\-comg\-\_\-f}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-calc\-\_\-comg\-\_\-f} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf rvec}}]{f\mbox{[}$\,$\mbox{]}, }
\item[{int}]{nrefat, }
\item[{{\bf atom\-\_\-id}}]{index\mbox{[}$\,$\mbox{]}, }
\item[{{\bf gmx\-\_\-bool}}]{b\-Mass, }
\item[{{\bf rvec}}]{fout}
\end{DoxyParamCaption}
)}}\label{include_2centerofmass_8h_aeadcc3855c61b7fdcb5af3965af4fcdb}
\-Calculate force on a single center of mass/geometry.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Topology structure with masses (can be \-N\-U\-L\-L if {\ttfamily b\-M\-A\-S\-S==\-T\-R\-U\-E}). \\
\hline
\mbox{\tt in}  & {\em x} & \-Forces on all atoms. \\
\hline
\mbox{\tt in}  & {\em nrefat} & \-Number of atoms in the index. \\
\hline
\mbox{\tt in}  & {\em index} & \-Indices of atoms. \\
\hline
\mbox{\tt in}  & {\em b\-Mass} & \-If \-T\-R\-U\-E, force on \-C\-O\-M is calculated. \\
\hline
\mbox{\tt out}  & {\em xout} & \-Force on the \-C\-O\-M/\-C\-O\-G position for the indexed atoms. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, \-E\-I\-N\-V\-A\-L if {\ttfamily top} is \-N\-U\-L\-L and {\ttfamily b\-Mass} is \-F\-A\-L\-S\-E.
\end{DoxyReturn}
\-Calls either \hyperlink{include_2centerofmass_8h_a742f1f05e6b37d5d795b338de4843929}{gmx\-\_\-calc\-\_\-cog()} or \hyperlink{include_2centerofmass_8h_ab9946cbd5c24f144235b272d500b811e}{gmx\-\_\-calc\-\_\-cog\-\_\-f()} depending on the value of {\ttfamily b\-Mass}. \-Other parameters are passed unmodified to these functions. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2centerofmass_8h_aeadcc3855c61b7fdcb5af3965af4fcdb_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2centerofmass_8h_a0e7aa7ceaa7e7c010da97efa0868c320}{\index{include/centerofmass.\-h@{include/centerofmass.\-h}!gmx\-\_\-calc\-\_\-comg\-\_\-f\-\_\-block@{gmx\-\_\-calc\-\_\-comg\-\_\-f\-\_\-block}}
\index{gmx\-\_\-calc\-\_\-comg\-\_\-f\-\_\-block@{gmx\-\_\-calc\-\_\-comg\-\_\-f\-\_\-block}!include/centerofmass.h@{include/centerofmass.\-h}}
\subsubsection[{gmx\-\_\-calc\-\_\-comg\-\_\-f\-\_\-block}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-calc\-\_\-comg\-\_\-f\-\_\-block} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf rvec}}]{f\mbox{[}$\,$\mbox{]}, }
\item[{{\bf t\-\_\-block} $\ast$}]{block, }
\item[{{\bf atom\-\_\-id}}]{index\mbox{[}$\,$\mbox{]}, }
\item[{{\bf gmx\-\_\-bool}}]{b\-Mass, }
\item[{{\bf rvec}}]{fout\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{include_2centerofmass_8h_a0e7aa7ceaa7e7c010da97efa0868c320}
\-Calculate forces on centers of mass/geometry for a blocked index.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Topology structure with masses (can be \-N\-U\-L\-L if {\ttfamily b\-M\-A\-S\-S==\-F\-A\-L\-S\-E}). \\
\hline
\mbox{\tt in}  & {\em f} & \-Forces on all atoms. \\
\hline
\mbox{\tt in}  & {\em block} & \hyperlink{structt__block}{t\-\_\-block} structure that divides {\ttfamily index} into blocks. \\
\hline
\mbox{\tt in}  & {\em index} & \-Indices of atoms. \\
\hline
\mbox{\tt in}  & {\em b\-Mass} & \-If \-T\-R\-U\-E, force on \-C\-O\-M is calculated. \\
\hline
\mbox{\tt out}  & {\em xout} & {\ttfamily block-\/$>$nr} forces on the \-C\-O\-M/\-C\-O\-G positions. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, \-E\-I\-N\-V\-A\-L if {\ttfamily top} is \-N\-U\-L\-L and {\ttfamily b\-Mass} is \-T\-R\-U\-E.
\end{DoxyReturn}
\-Calls either \hyperlink{include_2centerofmass_8h_accf307bb2ab7762c8b8a8d02976df463}{gmx\-\_\-calc\-\_\-com\-\_\-block()} or \hyperlink{include_2centerofmass_8h_a4b7f02d5a9fa27343ae9d1c9672aae7c}{gmx\-\_\-calc\-\_\-cog\-\_\-block()} depending on the value of {\ttfamily b\-Mass}. \-Other parameters are passed unmodified to these functions. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2centerofmass_8h_a0e7aa7ceaa7e7c010da97efa0868c320_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2centerofmass_8h_aeef133db1de6ad3d02cd96337f5c9faf}{\index{include/centerofmass.\-h@{include/centerofmass.\-h}!gmx\-\_\-calc\-\_\-comg\-\_\-f\-\_\-blocka@{gmx\-\_\-calc\-\_\-comg\-\_\-f\-\_\-blocka}}
\index{gmx\-\_\-calc\-\_\-comg\-\_\-f\-\_\-blocka@{gmx\-\_\-calc\-\_\-comg\-\_\-f\-\_\-blocka}!include/centerofmass.h@{include/centerofmass.\-h}}
\subsubsection[{gmx\-\_\-calc\-\_\-comg\-\_\-f\-\_\-blocka}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-calc\-\_\-comg\-\_\-f\-\_\-blocka} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf rvec}}]{f\mbox{[}$\,$\mbox{]}, }
\item[{{\bf t\-\_\-blocka} $\ast$}]{block, }
\item[{{\bf gmx\-\_\-bool}}]{b\-Mass, }
\item[{{\bf rvec}}]{fout\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{include_2centerofmass_8h_aeef133db1de6ad3d02cd96337f5c9faf}
\-Calculate forces on centers of mass/geometry for a set of blocks;


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Topology structure with masses (can be \-N\-U\-L\-L if {\ttfamily b\-M\-A\-S\-S==\-T\-R\-U\-E}). \\
\hline
\mbox{\tt in}  & {\em f} & \-Forces on all atoms. \\
\hline
\mbox{\tt in}  & {\em block} & \-Blocks for calculation. \\
\hline
\mbox{\tt in}  & {\em b\-Mass} & \-If \-T\-R\-U\-E, force on \-C\-O\-M is calculated. \\
\hline
\mbox{\tt out}  & {\em fout} & {\ttfamily block-\/$>$nr} forces on the \-C\-O\-M/\-C\-O\-G positions. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, \-E\-I\-N\-V\-A\-L if {\ttfamily top} is \-N\-U\-L\-L and {\ttfamily b\-Mass} is \-F\-A\-L\-S\-E.
\end{DoxyReturn}
\-Calls \hyperlink{include_2centerofmass_8h_a0e7aa7ceaa7e7c010da97efa0868c320}{gmx\-\_\-calc\-\_\-comg\-\_\-f\-\_\-block()}, converting the {\ttfamily \hyperlink{structt__blocka}{t\-\_\-blocka}} structure into a {\ttfamily \hyperlink{structt__block}{t\-\_\-block}} and an index. \-Other parameters are passed unmodified.

\begin{DoxyAttention}{\-Attention}
\-This function assumes that a pointer to {\ttfamily \hyperlink{structt__blocka}{t\-\_\-blocka}} can be safely typecast into {\ttfamily \hyperlink{structt__block}{t\-\_\-block}} such that the index fields can still be referenced. \-With the present \-Gromacs defitions of these types, this is the case, but if the layout of these structures is changed, this may lead to strange crashes. 
\end{DoxyAttention}
\hypertarget{include_2centerofmass_8h_ae966fdbe78bcf9fb9d89b70b64b3c21d}{\index{include/centerofmass.\-h@{include/centerofmass.\-h}!gmx\-\_\-calc\-\_\-comg\-\_\-pbc@{gmx\-\_\-calc\-\_\-comg\-\_\-pbc}}
\index{gmx\-\_\-calc\-\_\-comg\-\_\-pbc@{gmx\-\_\-calc\-\_\-comg\-\_\-pbc}!include/centerofmass.h@{include/centerofmass.\-h}}
\subsubsection[{gmx\-\_\-calc\-\_\-comg\-\_\-pbc}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-calc\-\_\-comg\-\_\-pbc} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}, }
\item[{{\bf t\-\_\-pbc} $\ast$}]{pbc, }
\item[{int}]{nrefat, }
\item[{{\bf atom\-\_\-id}}]{index\mbox{[}$\,$\mbox{]}, }
\item[{{\bf gmx\-\_\-bool}}]{b\-Mass, }
\item[{{\bf rvec}}]{xout}
\end{DoxyParamCaption}
)}}\label{include_2centerofmass_8h_ae966fdbe78bcf9fb9d89b70b64b3c21d}
\-Calculate a single center of mass/geometry iteratively with \-P\-B\-C.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Topology structure with masses (can be \-N\-U\-L\-L if {\ttfamily b\-M\-A\-S\-S==\-F\-A\-L\-S\-E}). \\
\hline
\mbox{\tt in}  & {\em x} & \-Position vectors of all atoms. \\
\hline
\mbox{\tt in}  & {\em pbc} & \-Periodic boundary conditions structure. \\
\hline
\mbox{\tt in}  & {\em nrefat} & \-Number of atoms in the index. \\
\hline
\mbox{\tt in}  & {\em index} & \-Indices of atoms. \\
\hline
\mbox{\tt in}  & {\em b\-Mass} & \-If \-T\-R\-U\-E, mass weighting is used. \\
\hline
\mbox{\tt out}  & {\em xout} & \-C\-O\-M/\-C\-O\-G position for the indexed atoms. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, \-E\-I\-N\-V\-A\-L if {\ttfamily top} is \-N\-U\-L\-L and {\ttfamily b\-Mass} is \-T\-R\-U\-E.
\end{DoxyReturn}
\-Calls either \hyperlink{include_2centerofmass_8h_a9854c5035749493ab405abd66ba7bcef}{gmx\-\_\-calc\-\_\-com()} or \hyperlink{include_2centerofmass_8h_a742f1f05e6b37d5d795b338de4843929}{gmx\-\_\-calc\-\_\-cog()} depending on the value of {\ttfamily b\-Mass}. \-Other parameters are passed unmodified to these functions. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2centerofmass_8h_ae966fdbe78bcf9fb9d89b70b64b3c21d_icgraph}
\end{center}
\end{figure}


