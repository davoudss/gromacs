\hypertarget{gmx__random_8c}{\section{src/gmxlib/gmx\-\_\-random.c \-File \-Reference}
\label{gmx__random_8c}\index{src/gmxlib/gmx\-\_\-random.\-c@{src/gmxlib/gmx\-\_\-random.\-c}}
}
{\ttfamily \#include $<$gmx\-\_\-random.\-h$>$}\*
{\ttfamily \#include $<$stdio.\-h$>$}\*
{\ttfamily \#include $<$stdlib.\-h$>$}\*
{\ttfamily \#include $<$time.\-h$>$}\*
{\ttfamily \#include $<$math.\-h$>$}\*
{\ttfamily \#include \char`\"{}maths.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}gmx\-\_\-random\-\_\-gausstable.\-h\char`\"{}}\*
\-Include dependency graph for gmx\-\_\-random.\-c\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__random_8c__incl}
\end{center}
\end{figure}
\subsection*{\-Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structgmx__rng}{gmx\-\_\-rng}
\end{DoxyCompactItemize}
\subsection*{\-Defines}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{gmx__random_8c_a4b2478588a242ecc9c9f8663ba4bf633}{\-R\-N\-G\-\_\-\-N}~624
\item 
\#define \hyperlink{gmx__random_8c_ab69160a3e5a9de0fbb920756474aea78}{\-R\-N\-G\-\_\-\-M}~397
\item 
\#define \hyperlink{gmx__random_8c_a516a0c168401f9bb801d4fd021d50c52}{\-R\-N\-G\-\_\-\-M\-A\-T\-R\-I\-X\-\_\-\-A}~0x9908b0df\-U\-L   /$\ast$ constant vector a $\ast$/
\item 
\#define \hyperlink{gmx__random_8c_a9437b54893b0d15d26fbeb4f59a2892d}{\-R\-N\-G\-\_\-\-U\-P\-P\-E\-R\-\_\-\-M\-A\-S\-K}~0x80000000\-U\-L /$\ast$ most significant w-\/r bits $\ast$/
\item 
\#define \hyperlink{gmx__random_8c_a9fb3f05fa942fc50374d9ba0027f802f}{\-R\-N\-G\-\_\-\-L\-O\-W\-E\-R\-\_\-\-M\-A\-S\-K}~0x7fffffff\-U\-L /$\ast$ least significant r bits $\ast$/
\item 
\#define \hyperlink{gmx__random_8c_a0eaa0bd34ccf6e7438657d8f24ba789c}{\-G\-A\-U\-S\-S\-\_\-\-T\-A\-B\-L\-E}~14 /$\ast$ the size of the gauss table is 2$^\wedge$\hyperlink{gmx__random_8c_a0eaa0bd34ccf6e7438657d8f24ba789c}{\-G\-A\-U\-S\-S\-\_\-\-T\-A\-B\-L\-E} $\ast$/
\item 
\#define \hyperlink{gmx__random_8c_a4c4f3ca3a17a24c4bbde51d05bd6eb61}{\-G\-A\-U\-S\-S\-\_\-\-S\-H\-I\-F\-T}~(32 -\/ \hyperlink{gmx__random_8c_a0eaa0bd34ccf6e7438657d8f24ba789c}{\-G\-A\-U\-S\-S\-\_\-\-T\-A\-B\-L\-E})
\end{DoxyCompactItemize}
\subsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{gmx__random_8c_a0a088042e90fef2a709cef3bba73a101}{gmx\-\_\-rng\-\_\-n} (\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void})
\begin{DoxyCompactList}\small\item\em \-Returns the size of the \-R\-N\-G integer data structure. \end{DoxyCompactList}\item 
\hyperlink{include_2gmx__random_8h_ab04e36fe2b56587efc5f5738e432ddee}{gmx\-\_\-rng\-\_\-t} \hyperlink{gmx__random_8c_a57e5327a30670c4538c4cf677fc448ca}{gmx\-\_\-rng\-\_\-init} (unsigned int seed)
\begin{DoxyCompactList}\small\item\em \-Create a new \-R\-N\-G, seeded from a single integer. \end{DoxyCompactList}\item 
\hyperlink{include_2gmx__random_8h_ab04e36fe2b56587efc5f5738e432ddee}{gmx\-\_\-rng\-\_\-t} \hyperlink{gmx__random_8c_a54075c4af25bc378bfcdd814a57f7bc8}{gmx\-\_\-rng\-\_\-init\-\_\-array} (unsigned int seed\mbox{[}$\,$\mbox{]}, int seed\-\_\-length)
\begin{DoxyCompactList}\small\item\em \-Initialize a \-R\-N\-G with 624 integers ($>$32 bits of entropy). \end{DoxyCompactList}\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{gmx__random_8c_a7e356538c9398f0f6a87fb01f592eca7}{gmx\-\_\-rng\-\_\-destroy} (\hyperlink{include_2gmx__random_8h_ab04e36fe2b56587efc5f5738e432ddee}{gmx\-\_\-rng\-\_\-t} rng)
\begin{DoxyCompactList}\small\item\em \-Release resources of a \-R\-N\-G. \end{DoxyCompactList}\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{gmx__random_8c_aeda960f0c1e9ba71886e1be873c13fc0}{gmx\-\_\-rng\-\_\-get\-\_\-state} (\hyperlink{include_2gmx__random_8h_ab04e36fe2b56587efc5f5738e432ddee}{gmx\-\_\-rng\-\_\-t} rng, unsigned int $\ast$mt, int $\ast$mti)
\begin{DoxyCompactList}\small\item\em \-Get the state of a \-R\-N\-G. \end{DoxyCompactList}\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{gmx__random_8c_ad72d17255f27bd41196f27ffd42facc7}{gmx\-\_\-rng\-\_\-set\-\_\-state} (\hyperlink{include_2gmx__random_8h_ab04e36fe2b56587efc5f5738e432ddee}{gmx\-\_\-rng\-\_\-t} rng, unsigned int $\ast$mt, int mti)
\begin{DoxyCompactList}\small\item\em \-Set the state of a \-R\-N\-G. \end{DoxyCompactList}\item 
unsigned int \hyperlink{gmx__random_8c_a675c3c886a99c9383693f01a6c553836}{gmx\-\_\-rng\-\_\-make\-\_\-seed} (\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void})
\begin{DoxyCompactList}\small\item\em \-Generate a 'random' \-R\-N\-G seed. \end{DoxyCompactList}\item 
static \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{gmx__random_8c_a20374d2ecf228dc91fa69b70afe0e99a}{gmx\-\_\-rng\-\_\-update} (\hyperlink{include_2gmx__random_8h_ab04e36fe2b56587efc5f5738e432ddee}{gmx\-\_\-rng\-\_\-t} rng)
\item 
real \hyperlink{gmx__random_8c_a06f687175bdfd19647cd247482baeebf}{gmx\-\_\-rng\-\_\-gaussian\-\_\-real} (\hyperlink{include_2gmx__random_8h_ab04e36fe2b56587efc5f5738e432ddee}{gmx\-\_\-rng\-\_\-t} rng)
\begin{DoxyCompactList}\small\item\em \-Random gmx\-\_\-real\-\_\-t from a gaussian distribution. \end{DoxyCompactList}\item 
unsigned int \hyperlink{gmx__random_8c_a382d2a35bece09f0d12189fc7b34ba5e}{gmx\-\_\-rng\-\_\-uniform\-\_\-uint32} (\hyperlink{include_2gmx__random_8h_ab04e36fe2b56587efc5f5738e432ddee}{gmx\-\_\-rng\-\_\-t} rng)
\begin{DoxyCompactList}\small\item\em \-Random 32-\/bit integer from a uniform distribution. \end{DoxyCompactList}\item 
real \hyperlink{gmx__random_8c_a1372da6ff3d378d8a1ba110e10292e84}{gmx\-\_\-rng\-\_\-uniform\-\_\-real} (\hyperlink{include_2gmx__random_8h_ab04e36fe2b56587efc5f5738e432ddee}{gmx\-\_\-rng\-\_\-t} rng)
\begin{DoxyCompactList}\small\item\em \-Random gmx\-\_\-real\-\_\-t 0$<$=x$<$1 from a uniform distribution. \end{DoxyCompactList}\item 
real \hyperlink{gmx__random_8c_a1a260aac87f56a2fb18dc8792a7fb3d1}{gmx\-\_\-rng\-\_\-gaussian\-\_\-table} (\hyperlink{include_2gmx__random_8h_ab04e36fe2b56587efc5f5738e432ddee}{gmx\-\_\-rng\-\_\-t} rng)
\end{DoxyCompactItemize}


\subsection{\-Define \-Documentation}
\hypertarget{gmx__random_8c_a4c4f3ca3a17a24c4bbde51d05bd6eb61}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!\-G\-A\-U\-S\-S\-\_\-\-S\-H\-I\-F\-T@{\-G\-A\-U\-S\-S\-\_\-\-S\-H\-I\-F\-T}}
\index{\-G\-A\-U\-S\-S\-\_\-\-S\-H\-I\-F\-T@{\-G\-A\-U\-S\-S\-\_\-\-S\-H\-I\-F\-T}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{\-G\-A\-U\-S\-S\-\_\-\-S\-H\-I\-F\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define {\bf \-G\-A\-U\-S\-S\-\_\-\-S\-H\-I\-F\-T}~(32 -\/ {\bf \-G\-A\-U\-S\-S\-\_\-\-T\-A\-B\-L\-E})}}\label{gmx__random_8c_a4c4f3ca3a17a24c4bbde51d05bd6eb61}
\hypertarget{gmx__random_8c_a0eaa0bd34ccf6e7438657d8f24ba789c}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!\-G\-A\-U\-S\-S\-\_\-\-T\-A\-B\-L\-E@{\-G\-A\-U\-S\-S\-\_\-\-T\-A\-B\-L\-E}}
\index{\-G\-A\-U\-S\-S\-\_\-\-T\-A\-B\-L\-E@{\-G\-A\-U\-S\-S\-\_\-\-T\-A\-B\-L\-E}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{\-G\-A\-U\-S\-S\-\_\-\-T\-A\-B\-L\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define {\bf \-G\-A\-U\-S\-S\-\_\-\-T\-A\-B\-L\-E}~14 /$\ast$ the size of the gauss table is 2$^\wedge${\bf \-G\-A\-U\-S\-S\-\_\-\-T\-A\-B\-L\-E} $\ast$/}}\label{gmx__random_8c_a0eaa0bd34ccf6e7438657d8f24ba789c}
\hypertarget{gmx__random_8c_a9fb3f05fa942fc50374d9ba0027f802f}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!\-R\-N\-G\-\_\-\-L\-O\-W\-E\-R\-\_\-\-M\-A\-S\-K@{\-R\-N\-G\-\_\-\-L\-O\-W\-E\-R\-\_\-\-M\-A\-S\-K}}
\index{\-R\-N\-G\-\_\-\-L\-O\-W\-E\-R\-\_\-\-M\-A\-S\-K@{\-R\-N\-G\-\_\-\-L\-O\-W\-E\-R\-\_\-\-M\-A\-S\-K}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{\-R\-N\-G\-\_\-\-L\-O\-W\-E\-R\-\_\-\-M\-A\-S\-K}]{\setlength{\rightskip}{0pt plus 5cm}\#define {\bf \-R\-N\-G\-\_\-\-L\-O\-W\-E\-R\-\_\-\-M\-A\-S\-K}~0x7fffffff\-U\-L /$\ast$ least significant r bits $\ast$/}}\label{gmx__random_8c_a9fb3f05fa942fc50374d9ba0027f802f}
\hypertarget{gmx__random_8c_ab69160a3e5a9de0fbb920756474aea78}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!\-R\-N\-G\-\_\-\-M@{\-R\-N\-G\-\_\-\-M}}
\index{\-R\-N\-G\-\_\-\-M@{\-R\-N\-G\-\_\-\-M}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{\-R\-N\-G\-\_\-\-M}]{\setlength{\rightskip}{0pt plus 5cm}\#define {\bf \-R\-N\-G\-\_\-\-M}~397}}\label{gmx__random_8c_ab69160a3e5a9de0fbb920756474aea78}
\hypertarget{gmx__random_8c_a516a0c168401f9bb801d4fd021d50c52}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!\-R\-N\-G\-\_\-\-M\-A\-T\-R\-I\-X\-\_\-\-A@{\-R\-N\-G\-\_\-\-M\-A\-T\-R\-I\-X\-\_\-\-A}}
\index{\-R\-N\-G\-\_\-\-M\-A\-T\-R\-I\-X\-\_\-\-A@{\-R\-N\-G\-\_\-\-M\-A\-T\-R\-I\-X\-\_\-\-A}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{\-R\-N\-G\-\_\-\-M\-A\-T\-R\-I\-X\-\_\-\-A}]{\setlength{\rightskip}{0pt plus 5cm}\#define {\bf \-R\-N\-G\-\_\-\-M\-A\-T\-R\-I\-X\-\_\-\-A}~0x9908b0df\-U\-L   /$\ast$ constant vector a $\ast$/}}\label{gmx__random_8c_a516a0c168401f9bb801d4fd021d50c52}
\hypertarget{gmx__random_8c_a4b2478588a242ecc9c9f8663ba4bf633}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!\-R\-N\-G\-\_\-\-N@{\-R\-N\-G\-\_\-\-N}}
\index{\-R\-N\-G\-\_\-\-N@{\-R\-N\-G\-\_\-\-N}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{\-R\-N\-G\-\_\-\-N}]{\setlength{\rightskip}{0pt plus 5cm}\#define {\bf \-R\-N\-G\-\_\-\-N}~624}}\label{gmx__random_8c_a4b2478588a242ecc9c9f8663ba4bf633}
\hypertarget{gmx__random_8c_a9437b54893b0d15d26fbeb4f59a2892d}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!\-R\-N\-G\-\_\-\-U\-P\-P\-E\-R\-\_\-\-M\-A\-S\-K@{\-R\-N\-G\-\_\-\-U\-P\-P\-E\-R\-\_\-\-M\-A\-S\-K}}
\index{\-R\-N\-G\-\_\-\-U\-P\-P\-E\-R\-\_\-\-M\-A\-S\-K@{\-R\-N\-G\-\_\-\-U\-P\-P\-E\-R\-\_\-\-M\-A\-S\-K}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{\-R\-N\-G\-\_\-\-U\-P\-P\-E\-R\-\_\-\-M\-A\-S\-K}]{\setlength{\rightskip}{0pt plus 5cm}\#define {\bf \-R\-N\-G\-\_\-\-U\-P\-P\-E\-R\-\_\-\-M\-A\-S\-K}~0x80000000\-U\-L /$\ast$ most significant w-\/r bits $\ast$/}}\label{gmx__random_8c_a9437b54893b0d15d26fbeb4f59a2892d}


\subsection{\-Function \-Documentation}
\hypertarget{gmx__random_8c_a7e356538c9398f0f6a87fb01f592eca7}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!gmx\-\_\-rng\-\_\-destroy@{gmx\-\_\-rng\-\_\-destroy}}
\index{gmx\-\_\-rng\-\_\-destroy@{gmx\-\_\-rng\-\_\-destroy}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{gmx\-\_\-rng\-\_\-destroy}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} {\bf gmx\-\_\-rng\-\_\-destroy} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-rng\-\_\-t}}]{rng}
\end{DoxyParamCaption}
)}}\label{gmx__random_8c_a7e356538c9398f0f6a87fb01f592eca7}


\-Release resources of a \-R\-N\-G. 

\-This routine destroys a random number generator and releases all resources allocated by it.


\begin{DoxyParams}{\-Parameters}
{\em rng} & \-Handle to random number generator previously returned by \hyperlink{include_2gmx__random_8h_a6f13fc57a365e94a3c2ff7361780681b}{gmx\-\_\-rng\-\_\-init()} or \hyperlink{include_2gmx__random_8h_a54075c4af25bc378bfcdd814a57f7bc8}{gmx\-\_\-rng\-\_\-init\-\_\-array()}.\\
\hline
\end{DoxyParams}
\-Function itself is threadsafe, but you should only destroy a certain \-R\-N\-G once (i.\-e. from one thread). 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{gmx__random_8c_a7e356538c9398f0f6a87fb01f592eca7_icgraph}
\end{center}
\end{figure}


\hypertarget{gmx__random_8c_a06f687175bdfd19647cd247482baeebf}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!gmx\-\_\-rng\-\_\-gaussian\-\_\-real@{gmx\-\_\-rng\-\_\-gaussian\-\_\-real}}
\index{gmx\-\_\-rng\-\_\-gaussian\-\_\-real@{gmx\-\_\-rng\-\_\-gaussian\-\_\-real}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{gmx\-\_\-rng\-\_\-gaussian\-\_\-real}]{\setlength{\rightskip}{0pt plus 5cm}real {\bf gmx\-\_\-rng\-\_\-gaussian\-\_\-real} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-rng\-\_\-t}}]{rng}
\end{DoxyParamCaption}
)}}\label{gmx__random_8c_a06f687175bdfd19647cd247482baeebf}


\-Random gmx\-\_\-real\-\_\-t from a gaussian distribution. 

\-This routine returns a random floating-\/point number from the random number generator provided, and updates the state of that \-R\-N\-G.

\-The \-Box-\/\-Muller algorithm is used to provide gaussian random numbers. \-This is not the fastest known algorithm for gaussian numbers, but in contrast to the alternatives it is very well studied and you can trust the returned random numbers to have good properties and no correlations.


\begin{DoxyParams}{\-Parameters}
{\em rng} & \-Handle to random number generator previously returned by \hyperlink{include_2gmx__random_8h_a6f13fc57a365e94a3c2ff7361780681b}{gmx\-\_\-rng\-\_\-init()} or \hyperlink{include_2gmx__random_8h_a54075c4af25bc378bfcdd814a57f7bc8}{gmx\-\_\-rng\-\_\-init\-\_\-array()}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-Gaussian random floating-\/point number with average 0.\-0 and standard deviation 1.\-0. \-You can get any average/mean you want by first multiplying with the desired average and then adding the average you want.
\end{DoxyReturn}
\-Function yes, input data no. \-You should not call this function from two different threads using the same \-R\-N\-G handle at the same time. \-For performance reasons we cannot lock the handle with a mutex every time we need a random number -\/ that would slow the routine down a factor 2-\/5. \-There are two simple solutions\-: either use a mutex and lock it before calling the function, or use a separate \-R\-N\-G handle for each thread.

\-It works perfectly to mix calls to get uniform and gaussian random numbers from the same generator, but since it will affect the sequence of returned numbers it is probably better to use separate random number generator structures. 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__random_8c_a06f687175bdfd19647cd247482baeebf_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__random_8c_a06f687175bdfd19647cd247482baeebf_icgraph}
\end{center}
\end{figure}


\hypertarget{gmx__random_8c_a1a260aac87f56a2fb18dc8792a7fb3d1}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!gmx\-\_\-rng\-\_\-gaussian\-\_\-table@{gmx\-\_\-rng\-\_\-gaussian\-\_\-table}}
\index{gmx\-\_\-rng\-\_\-gaussian\-\_\-table@{gmx\-\_\-rng\-\_\-gaussian\-\_\-table}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{gmx\-\_\-rng\-\_\-gaussian\-\_\-table}]{\setlength{\rightskip}{0pt plus 5cm}real {\bf gmx\-\_\-rng\-\_\-gaussian\-\_\-table} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-rng\-\_\-t}}]{rng}
\end{DoxyParamCaption}
)}}\label{gmx__random_8c_a1a260aac87f56a2fb18dc8792a7fb3d1}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__random_8c_a1a260aac87f56a2fb18dc8792a7fb3d1_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__random_8c_a1a260aac87f56a2fb18dc8792a7fb3d1_icgraph}
\end{center}
\end{figure}


\hypertarget{gmx__random_8c_aeda960f0c1e9ba71886e1be873c13fc0}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!gmx\-\_\-rng\-\_\-get\-\_\-state@{gmx\-\_\-rng\-\_\-get\-\_\-state}}
\index{gmx\-\_\-rng\-\_\-get\-\_\-state@{gmx\-\_\-rng\-\_\-get\-\_\-state}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{gmx\-\_\-rng\-\_\-get\-\_\-state}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} {\bf gmx\-\_\-rng\-\_\-get\-\_\-state} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-rng\-\_\-t}}]{rng, }
\item[{unsigned int $\ast$}]{mt, }
\item[{int $\ast$}]{mti}
\end{DoxyParamCaption}
)}}\label{gmx__random_8c_aeda960f0c1e9ba71886e1be873c13fc0}


\-Get the state of a \-R\-N\-G. 

\-This routine stores the random state in mt and mti, mt should have a size of at least 624, mt of 1.


\begin{DoxyParams}{\-Parameters}
{\em rng} & \-Handle to random number generator previously returned by \hyperlink{include_2gmx__random_8h_a6f13fc57a365e94a3c2ff7361780681b}{gmx\-\_\-rng\-\_\-init()} or \hyperlink{include_2gmx__random_8h_a54075c4af25bc378bfcdd814a57f7bc8}{gmx\-\_\-rng\-\_\-init\-\_\-array()}. \\
\hline
\end{DoxyParams}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__random_8c_aeda960f0c1e9ba71886e1be873c13fc0_icgraph}
\end{center}
\end{figure}


\hypertarget{gmx__random_8c_a57e5327a30670c4538c4cf677fc448ca}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!gmx\-\_\-rng\-\_\-init@{gmx\-\_\-rng\-\_\-init}}
\index{gmx\-\_\-rng\-\_\-init@{gmx\-\_\-rng\-\_\-init}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{gmx\-\_\-rng\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}{\bf gmx\-\_\-rng\-\_\-t} {\bf gmx\-\_\-rng\-\_\-init} (
\begin{DoxyParamCaption}
\item[{unsigned int}]{seed}
\end{DoxyParamCaption}
)}}\label{gmx__random_8c_a57e5327a30670c4538c4cf677fc448ca}


\-Create a new \-R\-N\-G, seeded from a single integer. 

\-If you dont want to pick a seed, just call it as rng=gmx\-\_\-rng\-\_\-init(\hyperlink{include_2gmx__random_8h_a3ae5943ba4258af667dee12c4210fe41}{gmx\-\_\-rng\-\_\-make\-\_\-seed()}) to seed it from the system time or a random device.


\begin{DoxyParams}{\-Parameters}
{\em seed} & \-Random seed, unsigned 32-\/bit integer.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-Reference to a random number generator, or \-N\-U\-L\-L if there was an error.
\end{DoxyReturn}
\-Yes. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{gmx__random_8c_a57e5327a30670c4538c4cf677fc448ca_icgraph}
\end{center}
\end{figure}


\hypertarget{gmx__random_8c_a54075c4af25bc378bfcdd814a57f7bc8}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!gmx\-\_\-rng\-\_\-init\-\_\-array@{gmx\-\_\-rng\-\_\-init\-\_\-array}}
\index{gmx\-\_\-rng\-\_\-init\-\_\-array@{gmx\-\_\-rng\-\_\-init\-\_\-array}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{gmx\-\_\-rng\-\_\-init\-\_\-array}]{\setlength{\rightskip}{0pt plus 5cm}{\bf gmx\-\_\-rng\-\_\-t} {\bf gmx\-\_\-rng\-\_\-init\-\_\-array} (
\begin{DoxyParamCaption}
\item[{unsigned int}]{seed\mbox{[}$\,$\mbox{]}, }
\item[{int}]{seed\-\_\-length}
\end{DoxyParamCaption}
)}}\label{gmx__random_8c_a54075c4af25bc378bfcdd814a57f7bc8}


\-Initialize a \-R\-N\-G with 624 integers ($>$32 bits of entropy). 

\-The \-Mersenne twister \-R\-N\-G used in \-Gromacs has an extremely long period, but when you only initialize it with a 32-\/bit integer there are only 2$^\wedge$32 different possible sequences of number -\/ much less than the generator is capable of.

\-If you really need the full entropy, this routine makes it possible to initialize the \-R\-N\-G with up to 624 32-\/bit integers, which will give you up to 2$^\wedge$19968 bits of entropy.


\begin{DoxyParams}{\-Parameters}
{\em seed} & \-Array of unsigned integers to form a seed \\
\hline
{\em seed\-\_\-length} & \-Number of integers in the array, up to 624 are used.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-Reference to a random number generator, or \-N\-U\-L\-L if there was an error.
\end{DoxyReturn}
\-Yes. 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=288pt]{gmx__random_8c_a54075c4af25bc378bfcdd814a57f7bc8_cgraph}
\end{center}
\end{figure}


\hypertarget{gmx__random_8c_a675c3c886a99c9383693f01a6c553836}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!gmx\-\_\-rng\-\_\-make\-\_\-seed@{gmx\-\_\-rng\-\_\-make\-\_\-seed}}
\index{gmx\-\_\-rng\-\_\-make\-\_\-seed@{gmx\-\_\-rng\-\_\-make\-\_\-seed}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{gmx\-\_\-rng\-\_\-make\-\_\-seed}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int {\bf gmx\-\_\-rng\-\_\-make\-\_\-seed} (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{gmx__random_8c_a675c3c886a99c9383693f01a6c553836}


\-Generate a 'random' \-R\-N\-G seed. 

\-This routine tries to get a seed from /dev/random if present, and if not it uses time-\/of-\/day and process id to generate one.

\begin{DoxyReturn}{\-Returns}
32-\/bit unsigned integer random seed.
\end{DoxyReturn}
\-Tip\-: \-If you use this in your code, it is a good idea to write the returned random seed to a logfile, so you can recreate the exact sequence of random number if you need to reproduce your run later for one reason or another.

\-Yes. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__random_8c_a675c3c886a99c9383693f01a6c553836_icgraph}
\end{center}
\end{figure}


\hypertarget{gmx__random_8c_a0a088042e90fef2a709cef3bba73a101}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!gmx\-\_\-rng\-\_\-n@{gmx\-\_\-rng\-\_\-n}}
\index{gmx\-\_\-rng\-\_\-n@{gmx\-\_\-rng\-\_\-n}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{gmx\-\_\-rng\-\_\-n}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-rng\-\_\-n} (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{gmx__random_8c_a0a088042e90fef2a709cef3bba73a101}


\-Returns the size of the \-R\-N\-G integer data structure. 

\-Returns the size of the \-R\-N\-G integer data structure.  \-Yes. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__random_8c_a0a088042e90fef2a709cef3bba73a101_icgraph}
\end{center}
\end{figure}


\hypertarget{gmx__random_8c_ad72d17255f27bd41196f27ffd42facc7}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!gmx\-\_\-rng\-\_\-set\-\_\-state@{gmx\-\_\-rng\-\_\-set\-\_\-state}}
\index{gmx\-\_\-rng\-\_\-set\-\_\-state@{gmx\-\_\-rng\-\_\-set\-\_\-state}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{gmx\-\_\-rng\-\_\-set\-\_\-state}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} {\bf gmx\-\_\-rng\-\_\-set\-\_\-state} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-rng\-\_\-t}}]{rng, }
\item[{unsigned int $\ast$}]{mt, }
\item[{int}]{mti}
\end{DoxyParamCaption}
)}}\label{gmx__random_8c_ad72d17255f27bd41196f27ffd42facc7}


\-Set the state of a \-R\-N\-G. 

\-This routine sets the random state from mt and mti, mt should have a size of at least 624.


\begin{DoxyParams}{\-Parameters}
{\em rng} & \-Handle to random number generator previously returned by \hyperlink{include_2gmx__random_8h_a6f13fc57a365e94a3c2ff7361780681b}{gmx\-\_\-rng\-\_\-init()} or \hyperlink{include_2gmx__random_8h_a54075c4af25bc378bfcdd814a57f7bc8}{gmx\-\_\-rng\-\_\-init\-\_\-array()}. \\
\hline
\end{DoxyParams}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__random_8c_ad72d17255f27bd41196f27ffd42facc7_icgraph}
\end{center}
\end{figure}


\hypertarget{gmx__random_8c_a1372da6ff3d378d8a1ba110e10292e84}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!gmx\-\_\-rng\-\_\-uniform\-\_\-real@{gmx\-\_\-rng\-\_\-uniform\-\_\-real}}
\index{gmx\-\_\-rng\-\_\-uniform\-\_\-real@{gmx\-\_\-rng\-\_\-uniform\-\_\-real}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{gmx\-\_\-rng\-\_\-uniform\-\_\-real}]{\setlength{\rightskip}{0pt plus 5cm}real {\bf gmx\-\_\-rng\-\_\-uniform\-\_\-real} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-rng\-\_\-t}}]{rng}
\end{DoxyParamCaption}
)}}\label{gmx__random_8c_a1372da6ff3d378d8a1ba110e10292e84}


\-Random gmx\-\_\-real\-\_\-t 0$<$=x$<$1 from a uniform distribution. 

\-This routine returns a random floating-\/point number from the random number generator provided, and updates the state of that \-R\-N\-G.


\begin{DoxyParams}{\-Parameters}
{\em rng} & \-Handle to random number generator previously returned by \hyperlink{include_2gmx__random_8h_a6f13fc57a365e94a3c2ff7361780681b}{gmx\-\_\-rng\-\_\-init()} or \hyperlink{include_2gmx__random_8h_a54075c4af25bc378bfcdd814a57f7bc8}{gmx\-\_\-rng\-\_\-init\-\_\-array()}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
floating-\/point number 0$<$=x$<$1 from a uniform distribution.
\end{DoxyReturn}
\-Function yes, input data no. \-You should not call this function from two different threads using the same \-R\-N\-G handle at the same time. \-For performance reasons we cannot lock the handle with a mutex every time we need a random number -\/ that would slow the routine down a factor 2-\/5. \-There are two simple solutions\-: either use a mutex and lock it before calling the function, or use a separate \-R\-N\-G handle for each thread. 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__random_8c_a1372da6ff3d378d8a1ba110e10292e84_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{gmx__random_8c_a1372da6ff3d378d8a1ba110e10292e84_icgraph}
\end{center}
\end{figure}


\hypertarget{gmx__random_8c_a382d2a35bece09f0d12189fc7b34ba5e}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!gmx\-\_\-rng\-\_\-uniform\-\_\-uint32@{gmx\-\_\-rng\-\_\-uniform\-\_\-uint32}}
\index{gmx\-\_\-rng\-\_\-uniform\-\_\-uint32@{gmx\-\_\-rng\-\_\-uniform\-\_\-uint32}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{gmx\-\_\-rng\-\_\-uniform\-\_\-uint32}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int {\bf gmx\-\_\-rng\-\_\-uniform\-\_\-uint32} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-rng\-\_\-t}}]{rng}
\end{DoxyParamCaption}
)}}\label{gmx__random_8c_a382d2a35bece09f0d12189fc7b34ba5e}


\-Random 32-\/bit integer from a uniform distribution. 

\-This routine returns a random integer from the random number generator provided, and updates the state of that \-R\-N\-G.


\begin{DoxyParams}{\-Parameters}
{\em rng} & \-Handle to random number generator previously returned by \hyperlink{include_2gmx__random_8h_a6f13fc57a365e94a3c2ff7361780681b}{gmx\-\_\-rng\-\_\-init()} or \hyperlink{include_2gmx__random_8h_a54075c4af25bc378bfcdd814a57f7bc8}{gmx\-\_\-rng\-\_\-init\-\_\-array()}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
32-\/bit unsigned integer from a uniform distribution.
\end{DoxyReturn}
\-Function yes, input data no. \-You should not call this function from two different threads using the same \-R\-N\-G handle at the same time. \-For performance reasons we cannot lock the handle with a mutex every time we need a random number -\/ that would slow the routine down a factor 2-\/5. \-There are two simple solutions\-: either use a mutex and lock it before calling the function, or use a separate \-R\-N\-G handle for each thread. 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{gmx__random_8c_a382d2a35bece09f0d12189fc7b34ba5e_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__random_8c_a382d2a35bece09f0d12189fc7b34ba5e_icgraph}
\end{center}
\end{figure}


\hypertarget{gmx__random_8c_a20374d2ecf228dc91fa69b70afe0e99a}{\index{gmx\-\_\-random.\-c@{gmx\-\_\-random.\-c}!gmx\-\_\-rng\-\_\-update@{gmx\-\_\-rng\-\_\-update}}
\index{gmx\-\_\-rng\-\_\-update@{gmx\-\_\-rng\-\_\-update}!gmx_random.c@{gmx\-\_\-random.\-c}}
\subsubsection[{gmx\-\_\-rng\-\_\-update}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} {\bf gmx\-\_\-rng\-\_\-update} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-rng\-\_\-t}}]{rng}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{gmx__random_8c_a20374d2ecf228dc91fa69b70afe0e99a}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__random_8c_a20374d2ecf228dc91fa69b70afe0e99a_icgraph}
\end{center}
\end{figure}


