\hypertarget{gmx__fft_8c}{\section{src/mdlib/gmx\-\_\-fft.c \-File \-Reference}
\label{gmx__fft_8c}\index{src/mdlib/gmx\-\_\-fft.\-c@{src/mdlib/gmx\-\_\-fft.\-c}}
}
{\ttfamily \#include $<$stdio.\-h$>$}\*
{\ttfamily \#include $<$stdlib.\-h$>$}\*
{\ttfamily \#include $<$string.\-h$>$}\*
{\ttfamily \#include $<$errno.\-h$>$}\*
{\ttfamily \#include \char`\"{}types/simple.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}gmxcomplex.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}gmx\-\_\-fft.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}gmx\-\_\-fatal.\-h\char`\"{}}\*
\-Include dependency graph for gmx\-\_\-fft.\-c\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__fft_8c__incl}
\end{center}
\end{figure}
\subsection*{\-Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structgmx__many__fft}{gmx\-\_\-many\-\_\-fft}
\end{DoxyCompactItemize}
\subsection*{\-Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structgmx__many__fft}{gmx\-\_\-many\-\_\-fft} $\ast$ \hyperlink{gmx__fft_8c_a0480bd54f6694c0d4b6621c33cf67b89}{gmx\-\_\-many\-\_\-fft\-\_\-t}
\end{DoxyCompactItemize}
\subsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{gmx__fft_8c_adce6d0b24710ceec9dad481b5210ebd8}{gmx\-\_\-fft\-\_\-init\-\_\-many\-\_\-1d} (\hyperlink{include_2gmx__fft_8h_ac4aa41b4b80187da5d55a98e5f63a025}{gmx\-\_\-fft\-\_\-t} $\ast$pfft, int nx, int howmany, \hyperlink{include_2gmx__fft_8h_aa6b68fb966512d287910879d38472bb4}{gmx\-\_\-fft\-\_\-flag} \hyperlink{nbnxn__cuda_8h_a04d8e308e05daeaa5002e3a3c983a14f}{flags})
\begin{DoxyCompactList}\small\item\em \-Setup multiple 1-\/dimensional complex-\/to-\/complex transform. \end{DoxyCompactList}\item 
int \hyperlink{gmx__fft_8c_adfd5fc4c5d44560a6fd3c07ce78bce6e}{gmx\-\_\-fft\-\_\-init\-\_\-many\-\_\-1d\-\_\-real} (\hyperlink{include_2gmx__fft_8h_ac4aa41b4b80187da5d55a98e5f63a025}{gmx\-\_\-fft\-\_\-t} $\ast$pfft, int nx, int howmany, \hyperlink{include_2gmx__fft_8h_aa6b68fb966512d287910879d38472bb4}{gmx\-\_\-fft\-\_\-flag} \hyperlink{nbnxn__cuda_8h_a04d8e308e05daeaa5002e3a3c983a14f}{flags})
\begin{DoxyCompactList}\small\item\em \-Setup multiple 1-\/dimensional real-\/to-\/complex transform. \end{DoxyCompactList}\item 
int \hyperlink{gmx__fft_8c_af722773aa9ec88a4984aed9d4c1820f5}{gmx\-\_\-fft\-\_\-many\-\_\-1d} (\hyperlink{include_2gmx__fft_8h_ac4aa41b4b80187da5d55a98e5f63a025}{gmx\-\_\-fft\-\_\-t} fft, enum \hyperlink{include_2gmx__fft_8h_af2aa0b3a5f3a4339ecb2bd67cb8f8302}{gmx\-\_\-fft\-\_\-direction} dir, \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$\hyperlink{gmx__msd_8c_a724edea1cc9c40e4660d3da81b358872}{in\-\_\-data}, \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$out\-\_\-data)
\begin{DoxyCompactList}\small\item\em \-Perform many 1-\/dimensional complex-\/to-\/complex transforms. \end{DoxyCompactList}\item 
int \hyperlink{gmx__fft_8c_ae96f00b2f99bc877a359185332216d8c}{gmx\-\_\-fft\-\_\-many\-\_\-1d\-\_\-real} (\hyperlink{include_2gmx__fft_8h_ac4aa41b4b80187da5d55a98e5f63a025}{gmx\-\_\-fft\-\_\-t} fft, enum \hyperlink{include_2gmx__fft_8h_af2aa0b3a5f3a4339ecb2bd67cb8f8302}{gmx\-\_\-fft\-\_\-direction} dir, \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$\hyperlink{gmx__msd_8c_a724edea1cc9c40e4660d3da81b358872}{in\-\_\-data}, \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$out\-\_\-data)
\begin{DoxyCompactList}\small\item\em \-Perform many 1-\/dimensional real-\/to-\/complex transforms. \end{DoxyCompactList}\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{gmx__fft_8c_ade0d0b112bcb9ba359e5fc35944b5693}{gmx\-\_\-many\-\_\-fft\-\_\-destroy} (\hyperlink{include_2gmx__fft_8h_ac4aa41b4b80187da5d55a98e5f63a025}{gmx\-\_\-fft\-\_\-t} fft)
\begin{DoxyCompactList}\small\item\em \-Release a many \-F\-F\-T setup structure. \end{DoxyCompactList}\item 
int \hyperlink{gmx__fft_8c_a05cf1a5a8427f30bbbc35ccbf89128d7}{gmx\-\_\-fft\-\_\-transpose\-\_\-2d} (\hyperlink{structt__complex}{t\-\_\-complex} $\ast$\hyperlink{gmx__msd_8c_a724edea1cc9c40e4660d3da81b358872}{in\-\_\-data}, \hyperlink{structt__complex}{t\-\_\-complex} $\ast$out\-\_\-data, int nx, int ny)
\begin{DoxyCompactList}\small\item\em \-Transpose 2d complex matrix, in-\/place or out-\/of-\/place. \end{DoxyCompactList}\item 
int \hyperlink{gmx__fft_8c_ac6a5e86a73fc2122bcd3296561e74efa}{gmx\-\_\-fft\-\_\-transpose\-\_\-2d\-\_\-nelem} (\hyperlink{structt__complex}{t\-\_\-complex} $\ast$\hyperlink{gmx__msd_8c_a724edea1cc9c40e4660d3da81b358872}{in\-\_\-data}, \hyperlink{structt__complex}{t\-\_\-complex} $\ast$out\-\_\-data, int nx, int ny, int nelem, \hyperlink{structt__complex}{t\-\_\-complex} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a07d916d97d1e4847d954c01319eca34e}{work})
\begin{DoxyCompactList}\small\item\em \-Transpose 2d multi-\/element matrix. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{\-Typedef \-Documentation}
\hypertarget{gmx__fft_8c_a0480bd54f6694c0d4b6621c33cf67b89}{\index{gmx\-\_\-fft.\-c@{gmx\-\_\-fft.\-c}!gmx\-\_\-many\-\_\-fft\-\_\-t@{gmx\-\_\-many\-\_\-fft\-\_\-t}}
\index{gmx\-\_\-many\-\_\-fft\-\_\-t@{gmx\-\_\-many\-\_\-fft\-\_\-t}!gmx_fft.c@{gmx\-\_\-fft.\-c}}
\subsubsection[{gmx\-\_\-many\-\_\-fft\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf gmx\-\_\-many\-\_\-fft}$\ast$ {\bf gmx\-\_\-many\-\_\-fft\-\_\-t}}}\label{gmx__fft_8c_a0480bd54f6694c0d4b6621c33cf67b89}


\subsection{\-Function \-Documentation}
\hypertarget{gmx__fft_8c_adce6d0b24710ceec9dad481b5210ebd8}{\index{gmx\-\_\-fft.\-c@{gmx\-\_\-fft.\-c}!gmx\-\_\-fft\-\_\-init\-\_\-many\-\_\-1d@{gmx\-\_\-fft\-\_\-init\-\_\-many\-\_\-1d}}
\index{gmx\-\_\-fft\-\_\-init\-\_\-many\-\_\-1d@{gmx\-\_\-fft\-\_\-init\-\_\-many\-\_\-1d}!gmx_fft.c@{gmx\-\_\-fft.\-c}}
\subsubsection[{gmx\-\_\-fft\-\_\-init\-\_\-many\-\_\-1d}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-fft\-\_\-init\-\_\-many\-\_\-1d} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-fft\-\_\-t} $\ast$}]{fft, }
\item[{int}]{nx, }
\item[{int}]{howmany, }
\item[{{\bf gmx\-\_\-fft\-\_\-flag}}]{flags}
\end{DoxyParamCaption}
)}}\label{gmx__fft_8c_adce6d0b24710ceec9dad481b5210ebd8}


\-Setup multiple 1-\/dimensional complex-\/to-\/complex transform. 


\begin{DoxyParams}{\-Parameters}
{\em fft} & \-Pointer to opaque \-Gromacs \-F\-F\-T datatype \\
\hline
{\em nx} & \-Length of transform \\
\hline
{\em howmany} & \-Howmany 1\-D \-F\-F\-T \\
\hline
{\em flags} & \-F\-F\-T options\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
status -\/ 0 or a standard error message.
\end{DoxyReturn}
\begin{DoxyNote}{\-Note}
\-Since some of the libraries (e.\-g. \-M\-K\-L) store work array data in their handles this datatype should only be used for one thread at a time, i.\-e. you should create one copy per thread when executing in parallel. 
\end{DoxyNote}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=314pt]{gmx__fft_8c_adce6d0b24710ceec9dad481b5210ebd8_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__fft_8c_adce6d0b24710ceec9dad481b5210ebd8_icgraph}
\end{center}
\end{figure}


\hypertarget{gmx__fft_8c_adfd5fc4c5d44560a6fd3c07ce78bce6e}{\index{gmx\-\_\-fft.\-c@{gmx\-\_\-fft.\-c}!gmx\-\_\-fft\-\_\-init\-\_\-many\-\_\-1d\-\_\-real@{gmx\-\_\-fft\-\_\-init\-\_\-many\-\_\-1d\-\_\-real}}
\index{gmx\-\_\-fft\-\_\-init\-\_\-many\-\_\-1d\-\_\-real@{gmx\-\_\-fft\-\_\-init\-\_\-many\-\_\-1d\-\_\-real}!gmx_fft.c@{gmx\-\_\-fft.\-c}}
\subsubsection[{gmx\-\_\-fft\-\_\-init\-\_\-many\-\_\-1d\-\_\-real}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-fft\-\_\-init\-\_\-many\-\_\-1d\-\_\-real} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-fft\-\_\-t} $\ast$}]{fft, }
\item[{int}]{nx, }
\item[{int}]{howmany, }
\item[{{\bf gmx\-\_\-fft\-\_\-flag}}]{flags}
\end{DoxyParamCaption}
)}}\label{gmx__fft_8c_adfd5fc4c5d44560a6fd3c07ce78bce6e}


\-Setup multiple 1-\/dimensional real-\/to-\/complex transform. 


\begin{DoxyParams}{\-Parameters}
{\em fft} & \-Pointer to opaque \-Gromacs \-F\-F\-T datatype \\
\hline
{\em nx} & \-Length of transform in real space \\
\hline
{\em howmany} & \-Homany 1\-D \-F\-F\-Ts \\
\hline
{\em flags} & \-F\-F\-T options\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
status -\/ 0 or a standard error message.
\end{DoxyReturn}
\begin{DoxyNote}{\-Note}
\-Since some of the libraries (e.\-g. \-M\-K\-L) store work array data in their handles this datatype should only be used for one thread at a time, i.\-e. you should create one copy per thread when executing in parallel. 
\end{DoxyNote}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__fft_8c_adfd5fc4c5d44560a6fd3c07ce78bce6e_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__fft_8c_adfd5fc4c5d44560a6fd3c07ce78bce6e_icgraph}
\end{center}
\end{figure}


\hypertarget{gmx__fft_8c_af722773aa9ec88a4984aed9d4c1820f5}{\index{gmx\-\_\-fft.\-c@{gmx\-\_\-fft.\-c}!gmx\-\_\-fft\-\_\-many\-\_\-1d@{gmx\-\_\-fft\-\_\-many\-\_\-1d}}
\index{gmx\-\_\-fft\-\_\-many\-\_\-1d@{gmx\-\_\-fft\-\_\-many\-\_\-1d}!gmx_fft.c@{gmx\-\_\-fft.\-c}}
\subsubsection[{gmx\-\_\-fft\-\_\-many\-\_\-1d}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-fft\-\_\-many\-\_\-1d} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-fft\-\_\-t}}]{setup, }
\item[{enum {\bf gmx\-\_\-fft\-\_\-direction}}]{dir, }
\item[{{\bf void} $\ast$}]{in\-\_\-data, }
\item[{{\bf void} $\ast$}]{out\-\_\-data}
\end{DoxyParamCaption}
)}}\label{gmx__fft_8c_af722773aa9ec88a4984aed9d4c1820f5}


\-Perform many 1-\/dimensional complex-\/to-\/complex transforms. 

\-Performs many instances of a transform previously initiated.


\begin{DoxyParams}{\-Parameters}
{\em setup} & \-Setup returned from \hyperlink{include_2gmx__fft_8h_a9236a69dfa724f4bf45d2940713a12ec}{gmx\-\_\-fft\-\_\-init\-\_\-1d()} \\
\hline
{\em dir} & \-Forward or \-Backward \\
\hline
{\em in\-\_\-data} & \-Input grid data. \-This should be allocated with gmx\-\_\-new() to make it 16-\/byte aligned for better performance. \\
\hline
{\em out\-\_\-data} & \-Output grid data. \-This should be allocated with gmx\-\_\-new() to make it 16-\/byte aligned for better performance. \-You can provide the same pointer for in\-\_\-data and out\-\_\-data to perform an in-\/place transform.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, or an error code.
\end{DoxyReturn}
\begin{DoxyNote}{\-Note}
\-Data pointers are declared as void, to avoid casting pointers depending on your grid type. 
\end{DoxyNote}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=278pt]{gmx__fft_8c_af722773aa9ec88a4984aed9d4c1820f5_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__fft_8c_af722773aa9ec88a4984aed9d4c1820f5_icgraph}
\end{center}
\end{figure}


\hypertarget{gmx__fft_8c_ae96f00b2f99bc877a359185332216d8c}{\index{gmx\-\_\-fft.\-c@{gmx\-\_\-fft.\-c}!gmx\-\_\-fft\-\_\-many\-\_\-1d\-\_\-real@{gmx\-\_\-fft\-\_\-many\-\_\-1d\-\_\-real}}
\index{gmx\-\_\-fft\-\_\-many\-\_\-1d\-\_\-real@{gmx\-\_\-fft\-\_\-many\-\_\-1d\-\_\-real}!gmx_fft.c@{gmx\-\_\-fft.\-c}}
\subsubsection[{gmx\-\_\-fft\-\_\-many\-\_\-1d\-\_\-real}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-fft\-\_\-many\-\_\-1d\-\_\-real} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-fft\-\_\-t}}]{setup, }
\item[{enum {\bf gmx\-\_\-fft\-\_\-direction}}]{dir, }
\item[{{\bf void} $\ast$}]{in\-\_\-data, }
\item[{{\bf void} $\ast$}]{out\-\_\-data}
\end{DoxyParamCaption}
)}}\label{gmx__fft_8c_ae96f00b2f99bc877a359185332216d8c}


\-Perform many 1-\/dimensional real-\/to-\/complex transforms. 

\-Performs many instances of a transform previously initiated.


\begin{DoxyParams}{\-Parameters}
{\em setup} & \-Setup returned from \hyperlink{include_2gmx__fft_8h_a66c96f88c537ade821e104a3b86f4d9b}{gmx\-\_\-fft\-\_\-init\-\_\-1d\-\_\-real()} \\
\hline
{\em dir} & \-Real-\/to-\/complex or complex-\/to-\/real \\
\hline
{\em in\-\_\-data} & \-Input grid data. \-This should be allocated with gmx\-\_\-new() to make it 16-\/byte aligned for better performance. \\
\hline
{\em out\-\_\-data} & \-Output grid data. \-This should be allocated with gmx\-\_\-new() to make it 16-\/byte aligned for better performance. \-You can provide the same pointer for in\-\_\-data and out\-\_\-data to perform an in-\/place transform.\\
\hline
\end{DoxyParams}
\-If you are doing an in-\/place transform, the array must be padded up to an even integer length so n/2 complex numbers can fit. \-Out-\/of-\/place arrays should not be padded (although it doesn't matter in 1d).

\begin{DoxyReturn}{\-Returns}
0 on success, or an error code.
\end{DoxyReturn}
\begin{DoxyNote}{\-Note}
\-Data pointers are declared as void, to avoid casting pointers depending on transform direction. 
\end{DoxyNote}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{gmx__fft_8c_ae96f00b2f99bc877a359185332216d8c_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__fft_8c_ae96f00b2f99bc877a359185332216d8c_icgraph}
\end{center}
\end{figure}


\hypertarget{gmx__fft_8c_a05cf1a5a8427f30bbbc35ccbf89128d7}{\index{gmx\-\_\-fft.\-c@{gmx\-\_\-fft.\-c}!gmx\-\_\-fft\-\_\-transpose\-\_\-2d@{gmx\-\_\-fft\-\_\-transpose\-\_\-2d}}
\index{gmx\-\_\-fft\-\_\-transpose\-\_\-2d@{gmx\-\_\-fft\-\_\-transpose\-\_\-2d}!gmx_fft.c@{gmx\-\_\-fft.\-c}}
\subsubsection[{gmx\-\_\-fft\-\_\-transpose\-\_\-2d}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-fft\-\_\-transpose\-\_\-2d} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-complex} $\ast$}]{in\-\_\-data, }
\item[{{\bf t\-\_\-complex} $\ast$}]{out\-\_\-data, }
\item[{int}]{nx, }
\item[{int}]{ny}
\end{DoxyParamCaption}
)}}\label{gmx__fft_8c_a05cf1a5a8427f30bbbc35ccbf89128d7}


\-Transpose 2d complex matrix, in-\/place or out-\/of-\/place. 

\-This routines works when the matrix is non-\/square, i.\-e. nx!=ny too, without allocating an entire matrix of work memory, which is important for huge \-F\-F\-T grids.


\begin{DoxyParams}{\-Parameters}
{\em in\-\_\-data} & \-Input data, to be transposed \\
\hline
{\em out\-\_\-data} & \-Output, transposed data. \-If this is identical to in\-\_\-data, an in-\/place transpose is performed. \\
\hline
{\em nx} & \-Number of rows before transpose \\
\hline
{\em ny} & \-Number of columns before transpose\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-G\-M\-X\-\_\-\-S\-U\-C\-C\-E\-S\-S, or an error code from gmx\-\_\-errno.\-h 
\end{DoxyReturn}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=278pt]{gmx__fft_8c_a05cf1a5a8427f30bbbc35ccbf89128d7_cgraph}
\end{center}
\end{figure}


\hypertarget{gmx__fft_8c_ac6a5e86a73fc2122bcd3296561e74efa}{\index{gmx\-\_\-fft.\-c@{gmx\-\_\-fft.\-c}!gmx\-\_\-fft\-\_\-transpose\-\_\-2d\-\_\-nelem@{gmx\-\_\-fft\-\_\-transpose\-\_\-2d\-\_\-nelem}}
\index{gmx\-\_\-fft\-\_\-transpose\-\_\-2d\-\_\-nelem@{gmx\-\_\-fft\-\_\-transpose\-\_\-2d\-\_\-nelem}!gmx_fft.c@{gmx\-\_\-fft.\-c}}
\subsubsection[{gmx\-\_\-fft\-\_\-transpose\-\_\-2d\-\_\-nelem}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-fft\-\_\-transpose\-\_\-2d\-\_\-nelem} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-complex} $\ast$}]{in\-\_\-data, }
\item[{{\bf t\-\_\-complex} $\ast$}]{out\-\_\-data, }
\item[{int}]{nx, }
\item[{int}]{ny, }
\item[{int}]{nelem, }
\item[{{\bf t\-\_\-complex} $\ast$}]{work}
\end{DoxyParamCaption}
)}}\label{gmx__fft_8c_ac6a5e86a73fc2122bcd3296561e74efa}


\-Transpose 2d multi-\/element matrix. 

\-This routine is very similar to \hyperlink{include_2gmx__fft_8h_a05cf1a5a8427f30bbbc35ccbf89128d7}{gmx\-\_\-fft\-\_\-transpose\-\_\-2d()}, but it supports matrices with more than one data value for each position. \-It is extremely useful when transposing the x/y dimensions of a 3d matrix -\/ in that case you just set nelem to nz, and the routine will do and x/y transpose where it moves entire columns of z data

\-This routines works when the matrix is non-\/square, i.\-e. nx!=ny too, without allocating an entire matrix of work memory, which is important for huge \-F\-F\-T grid.

\-For performance reasons you need to provide a {\itshape small\/} workarray with length at least 2$\ast$nelem (note that the type is char, not \hyperlink{structt__complex}{t\-\_\-complex}).


\begin{DoxyParams}{\-Parameters}
{\em in\-\_\-data} & \-Input data, to be transposed \\
\hline
{\em out\-\_\-data} & \-Output, transposed data. \-If this is identical to in\-\_\-data, an in-\/place transpose is performed. \\
\hline
{\em nx} & \-Number of rows before transpose \\
\hline
{\em ny} & \-Number of columns before transpose \\
\hline
{\em nelem} & \-Number of \hyperlink{structt__complex}{t\-\_\-complex} values in each position. \-If this is 1 it is faster to use \hyperlink{include_2gmx__fft_8h_a05cf1a5a8427f30bbbc35ccbf89128d7}{gmx\-\_\-fft\-\_\-transpose\-\_\-2d()} directly. \\
\hline
{\em work} & \-Work array of length 2$\ast$nelem, type \hyperlink{structt__complex}{t\-\_\-complex}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-G\-M\-X\-\_\-\-S\-U\-C\-C\-E\-S\-S, or an error code from gmx\-\_\-errno.\-h 
\end{DoxyReturn}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=322pt]{gmx__fft_8c_ac6a5e86a73fc2122bcd3296561e74efa_cgraph}
\end{center}
\end{figure}


\hypertarget{gmx__fft_8c_ade0d0b112bcb9ba359e5fc35944b5693}{\index{gmx\-\_\-fft.\-c@{gmx\-\_\-fft.\-c}!gmx\-\_\-many\-\_\-fft\-\_\-destroy@{gmx\-\_\-many\-\_\-fft\-\_\-destroy}}
\index{gmx\-\_\-many\-\_\-fft\-\_\-destroy@{gmx\-\_\-many\-\_\-fft\-\_\-destroy}!gmx_fft.c@{gmx\-\_\-fft.\-c}}
\subsubsection[{gmx\-\_\-many\-\_\-fft\-\_\-destroy}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} {\bf gmx\-\_\-many\-\_\-fft\-\_\-destroy} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-fft\-\_\-t}}]{setup}
\end{DoxyParamCaption}
)}}\label{gmx__fft_8c_ade0d0b112bcb9ba359e5fc35944b5693}


\-Release a many \-F\-F\-T setup structure. 

\-Destroy setup and release all allocated memory.


\begin{DoxyParams}{\-Parameters}
{\em setup} & \-Setup returned from \hyperlink{include_2gmx__fft_8h_a9236a69dfa724f4bf45d2940713a12ec}{gmx\-\_\-fft\-\_\-init\-\_\-1d()}, or one of the other initializers. \\
\hline
\end{DoxyParams}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=320pt]{gmx__fft_8c_ade0d0b112bcb9ba359e5fc35944b5693_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gmx__fft_8c_ade0d0b112bcb9ba359e5fc35944b5693_icgraph}
\end{center}
\end{figure}


