\hypertarget{include_2nbsearch_8h}{\section{include/nbsearch.h \-File \-Reference}
\label{include_2nbsearch_8h}\index{include/nbsearch.\-h@{include/nbsearch.\-h}}
}


\-A\-P\-I for neighborhood searching.  


{\ttfamily \#include \char`\"{}typedefs.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}indexutil.\-h\char`\"{}}\*
\-Include dependency graph for nbsearch.\-h\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2nbsearch_8h__incl}
\end{center}
\end{figure}
\subsection*{\-Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structgmx__ana__nbsearch__t}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} \hyperlink{include_2nbsearch_8h_a6d129fc0171ce36a0ae98783035501e1}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t}
\end{DoxyCompactItemize}
\subsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{share_2template_2gromacs_2visibility_8h_af6d678ccc5288db95c70b9d9003f11e2}{\-G\-M\-X\-\_\-\-L\-I\-B\-G\-M\-X\-\_\-\-E\-X\-P\-O\-R\-T} int \hyperlink{include_2nbsearch_8h_a8f3c442d0b5cc3f0cf00d0178fe86b69}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-create} (\hyperlink{structgmx__ana__nbsearch__t}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$$\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, real cutoff, int maxn)
\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{include_2nbsearch_8h_a5281d4ee13a86c089b9911b722f3f512}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-free} (\hyperlink{structgmx__ana__nbsearch__t}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d})
\item 
int \hyperlink{include_2nbsearch_8h_adb93d439fb66a65304f545892dc85685}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-init} (\hyperlink{structgmx__ana__nbsearch__t}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, \hyperlink{structt__pbc}{t\-\_\-pbc} $\ast$pbc, int \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a82736b60ddc8f6ec6c9591b0d6fcb394}{n}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]})
\item 
\hyperlink{share_2template_2gromacs_2visibility_8h_af6d678ccc5288db95c70b9d9003f11e2}{\-G\-M\-X\-\_\-\-L\-I\-B\-G\-M\-X\-\_\-\-E\-X\-P\-O\-R\-T} int \hyperlink{include_2nbsearch_8h_a692b6fd5e07c1417b5249a6502100867}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-init} (\hyperlink{structgmx__ana__nbsearch__t}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, \hyperlink{structt__pbc}{t\-\_\-pbc} $\ast$pbc, struct \hyperlink{structgmx__ana__pos__t}{gmx\-\_\-ana\-\_\-pos\-\_\-t} $\ast$p)
\item 
int \hyperlink{include_2nbsearch_8h_a1545e98dd1bd8d4513c0138ec5c2e4e5}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-set\-\_\-excl} (\hyperlink{structgmx__ana__nbsearch__t}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, int nexcl, int excl\mbox{[}$\,$\mbox{]})
\item 
\hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} \hyperlink{include_2nbsearch_8h_a13e06dbe851ea6d7c0903360ffaf569f}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-is\-\_\-within} (\hyperlink{structgmx__ana__nbsearch__t}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x})
\item 
\hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} \hyperlink{include_2nbsearch_8h_a7f027ec913e21c642a9dda11e01a41f7}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-is\-\_\-within} (\hyperlink{structgmx__ana__nbsearch__t}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, struct \hyperlink{structgmx__ana__pos__t}{gmx\-\_\-ana\-\_\-pos\-\_\-t} $\ast$p, int \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a3c7542401c1cb8bd37ef5e7d9eb0f5a8}{i})
\item 
real \hyperlink{include_2nbsearch_8h_a49c541545147457df662c3c3d33718b2}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-mindist} (\hyperlink{structgmx__ana__nbsearch__t}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x})
\item 
\hyperlink{share_2template_2gromacs_2visibility_8h_af6d678ccc5288db95c70b9d9003f11e2}{\-G\-M\-X\-\_\-\-L\-I\-B\-G\-M\-X\-\_\-\-E\-X\-P\-O\-R\-T} real \hyperlink{include_2nbsearch_8h_a18beda8df2a4a7dc6c169e9ea51f0597}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-mindist} (\hyperlink{structgmx__ana__nbsearch__t}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, struct \hyperlink{structgmx__ana__pos__t}{gmx\-\_\-ana\-\_\-pos\-\_\-t} $\ast$p, int \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a3c7542401c1cb8bd37ef5e7d9eb0f5a8}{i})
\item 
\hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} \hyperlink{include_2nbsearch_8h_a964f7e234609531a00e8087e864a628d}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-first\-\_\-within} (\hyperlink{structgmx__ana__nbsearch__t}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}, int $\ast$jp)
\item 
\hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} \hyperlink{include_2nbsearch_8h_ad93a9a3774b141cd7099c3268739abe8}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-first\-\_\-within} (\hyperlink{structgmx__ana__nbsearch__t}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, struct \hyperlink{structgmx__ana__pos__t}{gmx\-\_\-ana\-\_\-pos\-\_\-t} $\ast$p, int \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a3c7542401c1cb8bd37ef5e7d9eb0f5a8}{i}, int $\ast$jp)
\item 
\hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} \hyperlink{include_2nbsearch_8h_a724eafbcdf1934f85a8f8bc7480c5b04}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-next\-\_\-within} (\hyperlink{structgmx__ana__nbsearch__t}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, int $\ast$jp)
\end{DoxyCompactItemize}


\subsection{\-Detailed \-Description}
\-A\-P\-I for neighborhood searching. \-The \-A\-P\-I is documented in more detail on a separate page\-: \hyperlink{nbsearch}{\-Neighborhood search routines}

\-The functions within this file can be used independently of the other parts of the library. \-The library also uses the functions internally. 

\subsection{\-Typedef \-Documentation}
\hypertarget{include_2nbsearch_8h_a6d129fc0171ce36a0ae98783035501e1}{\index{include/nbsearch.\-h@{include/nbsearch.\-h}!gmx\-\_\-ana\-\_\-nbsearch\-\_\-t@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t}}
\index{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t}!include/nbsearch.h@{include/nbsearch.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-nbsearch\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} {\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-t}}}\label{include_2nbsearch_8h_a6d129fc0171ce36a0ae98783035501e1}
\-Data structure for neighborhood searches. 

\subsection{\-Function \-Documentation}
\hypertarget{include_2nbsearch_8h_a8f3c442d0b5cc3f0cf00d0178fe86b69}{\index{include/nbsearch.\-h@{include/nbsearch.\-h}!gmx\-\_\-ana\-\_\-nbsearch\-\_\-create@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-create}}
\index{gmx\-\_\-ana\-\_\-nbsearch\-\_\-create@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-create}!include/nbsearch.h@{include/nbsearch.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-nbsearch\-\_\-create}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-G\-M\-X\-\_\-\-L\-I\-B\-G\-M\-X\-\_\-\-E\-X\-P\-O\-R\-T} int {\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-create} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$$\ast$}]{data, }
\item[{real}]{cutoff, }
\item[{int}]{maxn}
\end{DoxyParamCaption}
)}}\label{include_2nbsearch_8h_a8f3c442d0b5cc3f0cf00d0178fe86b69}
\-Create a new neighborhood search data structure.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt out}  & {\em data} & \-Neighborhood search data structure pointer to initialize. \\
\hline
\mbox{\tt in}  & {\em cutoff} & \-Cutoff distance for the search ($<$=0 stands for no cutoff). \\
\hline
\mbox{\tt in}  & {\em maxn} & \-Maximum number of reference particles. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success. 
\end{DoxyReturn}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2nbsearch_8h_a8f3c442d0b5cc3f0cf00d0178fe86b69_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2nbsearch_8h_a964f7e234609531a00e8087e864a628d}{\index{include/nbsearch.\-h@{include/nbsearch.\-h}!gmx\-\_\-ana\-\_\-nbsearch\-\_\-first\-\_\-within@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-first\-\_\-within}}
\index{gmx\-\_\-ana\-\_\-nbsearch\-\_\-first\-\_\-within@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-first\-\_\-within}!include/nbsearch.h@{include/nbsearch.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-nbsearch\-\_\-first\-\_\-within}]{\setlength{\rightskip}{0pt plus 5cm}{\bf gmx\-\_\-bool} {\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-first\-\_\-within} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$}]{d, }
\item[{{\bf rvec}}]{x, }
\item[{int $\ast$}]{jp}
\end{DoxyParamCaption}
)}}\label{include_2nbsearch_8h_a964f7e234609531a00e8087e864a628d}
\-Finds the first reference position within the cutoff.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Neighborhood search data structure. \\
\hline
\mbox{\tt in}  & {\em n} & \-Number of test positions in {\ttfamily x}. \\
\hline
\mbox{\tt in}  & {\em x} & \-Test positions. \\
\hline
\mbox{\tt out}  & {\em jp} & \-Index of the reference position in the first pair. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-T\-R\-U\-E if there are positions within the cutoff. 
\end{DoxyReturn}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2nbsearch_8h_a964f7e234609531a00e8087e864a628d_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2nbsearch_8h_a5281d4ee13a86c089b9911b722f3f512}{\index{include/nbsearch.\-h@{include/nbsearch.\-h}!gmx\-\_\-ana\-\_\-nbsearch\-\_\-free@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-free}}
\index{gmx\-\_\-ana\-\_\-nbsearch\-\_\-free@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-free}!include/nbsearch.h@{include/nbsearch.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-nbsearch\-\_\-free}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} {\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-free} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$}]{d}
\end{DoxyParamCaption}
)}}\label{include_2nbsearch_8h_a5281d4ee13a86c089b9911b722f3f512}
\-Free memory allocated for neighborhood search.


\begin{DoxyParams}{\-Parameters}
{\em d} & \-Data structure to free.\\
\hline
\end{DoxyParams}
\-After the call, the pointer {\ttfamily d} is no longer valid. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=340pt]{include_2nbsearch_8h_a5281d4ee13a86c089b9911b722f3f512_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2nbsearch_8h_adb93d439fb66a65304f545892dc85685}{\index{include/nbsearch.\-h@{include/nbsearch.\-h}!gmx\-\_\-ana\-\_\-nbsearch\-\_\-init@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-init}}
\index{gmx\-\_\-ana\-\_\-nbsearch\-\_\-init@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-init}!include/nbsearch.h@{include/nbsearch.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-nbsearch\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-init} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$}]{d, }
\item[{{\bf t\-\_\-pbc} $\ast$}]{pbc, }
\item[{int}]{n, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{include_2nbsearch_8h_adb93d439fb66a65304f545892dc85685}
\-Initializes neighborhood search for a new frame.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em d} & \-Neighborhood search data structure. \\
\hline
\mbox{\tt in}  & {\em pbc} & \-P\-B\-C information for the frame. \\
\hline
\mbox{\tt in}  & {\em n} & \-Number of reference positions for the frame. \\
\hline
\mbox{\tt in}  & {\em x} & {\ttfamily n} reference positions for the frame. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success.
\end{DoxyReturn}
\-Initializes the data structure {\ttfamily d} such that it can be used to search for the neighbors of {\ttfamily x}. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2nbsearch_8h_adb93d439fb66a65304f545892dc85685_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2nbsearch_8h_a13e06dbe851ea6d7c0903360ffaf569f}{\index{include/nbsearch.\-h@{include/nbsearch.\-h}!gmx\-\_\-ana\-\_\-nbsearch\-\_\-is\-\_\-within@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-is\-\_\-within}}
\index{gmx\-\_\-ana\-\_\-nbsearch\-\_\-is\-\_\-within@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-is\-\_\-within}!include/nbsearch.h@{include/nbsearch.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-nbsearch\-\_\-is\-\_\-within}]{\setlength{\rightskip}{0pt plus 5cm}{\bf gmx\-\_\-bool} {\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-is\-\_\-within} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$}]{d, }
\item[{{\bf rvec}}]{x}
\end{DoxyParamCaption}
)}}\label{include_2nbsearch_8h_a13e06dbe851ea6d7c0903360ffaf569f}
\-Check whether a point is within a neighborhood.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Neighborhood search data structure. \\
\hline
\mbox{\tt in}  & {\em x} & \-Test position. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-T\-R\-U\-E if {\ttfamily x} is within the cutoff of any reference position, \-F\-A\-L\-S\-E otherwise. 
\end{DoxyReturn}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2nbsearch_8h_a13e06dbe851ea6d7c0903360ffaf569f_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2nbsearch_8h_a49c541545147457df662c3c3d33718b2}{\index{include/nbsearch.\-h@{include/nbsearch.\-h}!gmx\-\_\-ana\-\_\-nbsearch\-\_\-mindist@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-mindist}}
\index{gmx\-\_\-ana\-\_\-nbsearch\-\_\-mindist@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-mindist}!include/nbsearch.h@{include/nbsearch.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-nbsearch\-\_\-mindist}]{\setlength{\rightskip}{0pt plus 5cm}real {\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-mindist} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$}]{d, }
\item[{{\bf rvec}}]{x}
\end{DoxyParamCaption}
)}}\label{include_2nbsearch_8h_a49c541545147457df662c3c3d33718b2}
\-Calculates the minimun distance from the reference points.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Neighborhood search data structure. \\
\hline
\mbox{\tt in}  & {\em x} & \-Test position. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-The distance to the nearest reference position, or the cutoff value if there are no reference positions within the cutoff. 
\end{DoxyReturn}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2nbsearch_8h_a49c541545147457df662c3c3d33718b2_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2nbsearch_8h_a724eafbcdf1934f85a8f8bc7480c5b04}{\index{include/nbsearch.\-h@{include/nbsearch.\-h}!gmx\-\_\-ana\-\_\-nbsearch\-\_\-next\-\_\-within@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-next\-\_\-within}}
\index{gmx\-\_\-ana\-\_\-nbsearch\-\_\-next\-\_\-within@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-next\-\_\-within}!include/nbsearch.h@{include/nbsearch.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-nbsearch\-\_\-next\-\_\-within}]{\setlength{\rightskip}{0pt plus 5cm}{\bf gmx\-\_\-bool} {\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-next\-\_\-within} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$}]{d, }
\item[{int $\ast$}]{jp}
\end{DoxyParamCaption}
)}}\label{include_2nbsearch_8h_a724eafbcdf1934f85a8f8bc7480c5b04}
\-Finds the next reference position within the cutoff.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Neighborhood search data structure. \\
\hline
\mbox{\tt out}  & {\em jp} & \-Index of the test position in the next pair. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-T\-R\-U\-E if there are positions within the cutoff. 
\end{DoxyReturn}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2nbsearch_8h_a724eafbcdf1934f85a8f8bc7480c5b04_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2nbsearch_8h_ad93a9a3774b141cd7099c3268739abe8}{\index{include/nbsearch.\-h@{include/nbsearch.\-h}!gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-first\-\_\-within@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-first\-\_\-within}}
\index{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-first\-\_\-within@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-first\-\_\-within}!include/nbsearch.h@{include/nbsearch.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-first\-\_\-within}]{\setlength{\rightskip}{0pt plus 5cm}{\bf gmx\-\_\-bool} {\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-first\-\_\-within} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$}]{d, }
\item[{{\bf gmx\-\_\-ana\-\_\-pos\-\_\-t} $\ast$}]{p, }
\item[{int}]{i, }
\item[{int $\ast$}]{jp}
\end{DoxyParamCaption}
)}}\label{include_2nbsearch_8h_ad93a9a3774b141cd7099c3268739abe8}
\-Finds the first reference position within the cutoff.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Neighborhood search data structure. \\
\hline
\mbox{\tt in}  & {\em p} & \-Test positions. \\
\hline
\mbox{\tt in}  & {\em i} & \-Use the i'th position in {\ttfamily p}. \\
\hline
\mbox{\tt out}  & {\em jp} & \-Index of the reference position in the first pair. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-T\-R\-U\-E if there are positions within the cutoff. 
\end{DoxyReturn}
\hypertarget{include_2nbsearch_8h_a692b6fd5e07c1417b5249a6502100867}{\index{include/nbsearch.\-h@{include/nbsearch.\-h}!gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-init@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-init}}
\index{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-init@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-init}!include/nbsearch.h@{include/nbsearch.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-G\-M\-X\-\_\-\-L\-I\-B\-G\-M\-X\-\_\-\-E\-X\-P\-O\-R\-T} int {\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-init} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$}]{d, }
\item[{{\bf t\-\_\-pbc} $\ast$}]{pbc, }
\item[{{\bf gmx\-\_\-ana\-\_\-pos\-\_\-t} $\ast$}]{p}
\end{DoxyParamCaption}
)}}\label{include_2nbsearch_8h_a692b6fd5e07c1417b5249a6502100867}
\-Initializes neighborhood search for a frame using {\ttfamily \hyperlink{structgmx__ana__pos__t}{gmx\-\_\-ana\-\_\-pos\-\_\-t}}.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em d} & \-Neighborhood search data structure. \\
\hline
\mbox{\tt in}  & {\em pbc} & \-P\-B\-C information for the frame. \\
\hline
\mbox{\tt in}  & {\em p} & \-Reference positions for the frame. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success.
\end{DoxyReturn}
\-A convenience wrapper for \hyperlink{include_2nbsearch_8h_adb93d439fb66a65304f545892dc85685}{gmx\-\_\-ana\-\_\-nbsearch\-\_\-init()}. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2nbsearch_8h_a692b6fd5e07c1417b5249a6502100867_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2nbsearch_8h_a7f027ec913e21c642a9dda11e01a41f7}{\index{include/nbsearch.\-h@{include/nbsearch.\-h}!gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-is\-\_\-within@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-is\-\_\-within}}
\index{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-is\-\_\-within@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-is\-\_\-within}!include/nbsearch.h@{include/nbsearch.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-is\-\_\-within}]{\setlength{\rightskip}{0pt plus 5cm}{\bf gmx\-\_\-bool} {\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-is\-\_\-within} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$}]{d, }
\item[{{\bf gmx\-\_\-ana\-\_\-pos\-\_\-t} $\ast$}]{p, }
\item[{int}]{i}
\end{DoxyParamCaption}
)}}\label{include_2nbsearch_8h_a7f027ec913e21c642a9dda11e01a41f7}
\-Check whether a position is within a neighborhood.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Neighborhood search data structure. \\
\hline
\mbox{\tt in}  & {\em p} & \-Test positions. \\
\hline
\mbox{\tt in}  & {\em i} & \-Use the i'th position in {\ttfamily p} for testing. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-T\-R\-U\-E if the test position is within the cutoff of any reference position, \-F\-A\-L\-S\-E otherwise. 
\end{DoxyReturn}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2nbsearch_8h_a7f027ec913e21c642a9dda11e01a41f7_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2nbsearch_8h_a18beda8df2a4a7dc6c169e9ea51f0597}{\index{include/nbsearch.\-h@{include/nbsearch.\-h}!gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-mindist@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-mindist}}
\index{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-mindist@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-mindist}!include/nbsearch.h@{include/nbsearch.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-mindist}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-G\-M\-X\-\_\-\-L\-I\-B\-G\-M\-X\-\_\-\-E\-X\-P\-O\-R\-T} real {\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-pos\-\_\-mindist} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$}]{d, }
\item[{{\bf gmx\-\_\-ana\-\_\-pos\-\_\-t} $\ast$}]{p, }
\item[{int}]{i}
\end{DoxyParamCaption}
)}}\label{include_2nbsearch_8h_a18beda8df2a4a7dc6c169e9ea51f0597}
\-Calculates the minimun distance from the reference points.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Neighborhood search data structure. \\
\hline
\mbox{\tt in}  & {\em p} & \-Test positions. \\
\hline
\mbox{\tt in}  & {\em i} & \-Use the i'th position in {\ttfamily p} for testing. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-The distance to the nearest reference position, or the cutoff value if there are no reference positions within the cutoff. 
\end{DoxyReturn}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2nbsearch_8h_a18beda8df2a4a7dc6c169e9ea51f0597_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2nbsearch_8h_a1545e98dd1bd8d4513c0138ec5c2e4e5}{\index{include/nbsearch.\-h@{include/nbsearch.\-h}!gmx\-\_\-ana\-\_\-nbsearch\-\_\-set\-\_\-excl@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-set\-\_\-excl}}
\index{gmx\-\_\-ana\-\_\-nbsearch\-\_\-set\-\_\-excl@{gmx\-\_\-ana\-\_\-nbsearch\-\_\-set\-\_\-excl}!include/nbsearch.h@{include/nbsearch.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-nbsearch\-\_\-set\-\_\-excl}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-set\-\_\-excl} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-nbsearch\-\_\-t} $\ast$}]{d, }
\item[{int}]{nexcl, }
\item[{int}]{excl\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{include_2nbsearch_8h_a1545e98dd1bd8d4513c0138ec5c2e4e5}
\-Sets the exclusions for the next neighborhood search.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em d} & \-Neighborhood search data structure. \\
\hline
\mbox{\tt in}  & {\em nexcl} & \-Number of reference positions to exclude from next search. \\
\hline
\mbox{\tt in}  & {\em excl} & \-Indices of reference positions to exclude. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success.
\end{DoxyReturn}
\-The set exclusions remain in effect until the next call of this function. 