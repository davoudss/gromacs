\hypertarget{displacement_8c}{\section{src/gmxlib/trajana/displacement.c \-File \-Reference}
\label{displacement_8c}\index{src/gmxlib/trajana/displacement.\-c@{src/gmxlib/trajana/displacement.\-c}}
}
{\ttfamily \#include $<$math.\-h$>$}\*
{\ttfamily \#include $<$pbc.\-h$>$}\*
{\ttfamily \#include $<$smalloc.\-h$>$}\*
{\ttfamily \#include $<$vec.\-h$>$}\*
{\ttfamily \#include $<$displacement.\-h$>$}\*
{\ttfamily \#include $<$position.\-h$>$}\*
\-Include dependency graph for displacement.\-c\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{displacement_8c__incl}
\end{center}
\end{figure}
\subsection*{\-Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structgmx__ana__displpos__t}{gmx\-\_\-ana\-\_\-displpos\-\_\-t}
\item 
struct \hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t}
\end{DoxyCompactItemize}
\subsection*{\-Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structgmx__ana__displpos__t}{gmx\-\_\-ana\-\_\-displpos\-\_\-t} \hyperlink{displacement_8c_a0810c4cbff76246a3c6516933c9ee1c5}{gmx\-\_\-ana\-\_\-displpos\-\_\-t}
\end{DoxyCompactItemize}
\subsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{displacement_8c_a2c2df45c0dc0ba8c0326f692cb7839d1}{gmx\-\_\-ana\-\_\-displ\-\_\-create} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$$\ast$data, int nmax, real tmax)
\item 
int \hyperlink{displacement_8c_a4fbbe00acaff0a0a7b3d4593bf708b96}{gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, real \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a2b515c84b1293071f7584da32ca336c0}{t})
\item 
int \hyperlink{displacement_8c_adc268c27bcc727590b27636bf52daa0d}{gmx\-\_\-ana\-\_\-displ\-\_\-time\-\_\-to\-\_\-steps} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, real time, int $\ast$steps)
\item 
int \hyperlink{displacement_8c_a1249df9ac34685bd9609e1944bccb14a}{gmx\-\_\-ana\-\_\-displ\-\_\-store} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} id, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}, \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} b\-Pres)
\item 
int \hyperlink{displacement_8c_a23227f37b703ca5d00cdaa2af678e728}{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, int \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a82736b60ddc8f6ec6c9591b0d6fcb394}{n}, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} id\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{displacement_8c_acd4c27a82da37705cbecc5400b5001ad}{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} id\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{displacement_8c_aafc782c3271e10f8207c828d5d0fe87f}{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-pos} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, \hyperlink{structgmx__ana__pos__t}{gmx\-\_\-ana\-\_\-pos\-\_\-t} $\ast$p)
\item 
static int \hyperlink{displacement_8c_a81fdcb711db1451146ded14dc295133a}{find\-\_\-store\-\_\-index} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, int step)
\begin{DoxyCompactList}\small\item\em \-Finds the index in the displacement position storage array. \end{DoxyCompactList}\item 
int \hyperlink{displacement_8c_ad2b5a136e9e87e0976ae558bff6fa0a9}{gmx\-\_\-ana\-\_\-displ\-\_\-vector} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, int step, \hyperlink{structt__pbc}{t\-\_\-pbc} $\ast$pbc, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} id, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout, \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} $\ast$pout)
\item 
int \hyperlink{displacement_8c_a07581fadc4db16ad790533b67c7ed7a5}{gmx\-\_\-ana\-\_\-displ\-\_\-vectors} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, int step, \hyperlink{structt__pbc}{t\-\_\-pbc} $\ast$pbc, int \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a82736b60ddc8f6ec6c9591b0d6fcb394}{n}, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} id\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout\mbox{[}$\,$\mbox{]}, \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} $\ast$pout)
\item 
int \hyperlink{displacement_8c_af99ad13734798104a87fbdd44de8627e}{gmx\-\_\-ana\-\_\-displ\-\_\-vectors\-\_\-all} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, int step, \hyperlink{structt__pbc}{t\-\_\-pbc} $\ast$pbc, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout\mbox{[}$\,$\mbox{]}, \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} $\ast$pout)
\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{displacement_8c_a1c6c8a635f8e4918789917d790958f77}{gmx\-\_\-ana\-\_\-displ\-\_\-free} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d})
\end{DoxyCompactItemize}


\subsection{\-Typedef \-Documentation}
\hypertarget{displacement_8c_a0810c4cbff76246a3c6516933c9ee1c5}{\index{displacement.\-c@{displacement.\-c}!gmx\-\_\-ana\-\_\-displpos\-\_\-t@{gmx\-\_\-ana\-\_\-displpos\-\_\-t}}
\index{gmx\-\_\-ana\-\_\-displpos\-\_\-t@{gmx\-\_\-ana\-\_\-displpos\-\_\-t}!displacement.c@{displacement.\-c}}
\subsubsection[{gmx\-\_\-ana\-\_\-displpos\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf gmx\-\_\-ana\-\_\-displpos\-\_\-t}  {\bf gmx\-\_\-ana\-\_\-displpos\-\_\-t}}}\label{displacement_8c_a0810c4cbff76246a3c6516933c9ee1c5}


\subsection{\-Function \-Documentation}
\hypertarget{displacement_8c_a81fdcb711db1451146ded14dc295133a}{\index{displacement.\-c@{displacement.\-c}!find\-\_\-store\-\_\-index@{find\-\_\-store\-\_\-index}}
\index{find\-\_\-store\-\_\-index@{find\-\_\-store\-\_\-index}!displacement.c@{displacement.\-c}}
\subsubsection[{find\-\_\-store\-\_\-index}]{\setlength{\rightskip}{0pt plus 5cm}static int {\bf find\-\_\-store\-\_\-index} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{int}]{step}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{displacement_8c_a81fdcb711db1451146ded14dc295133a}


\-Finds the index in the displacement position storage array. 


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em step} & \-Calculate the index of positions {\ttfamily steps} back. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-Index into the \hyperlink{structgmx__ana__displ__t_a1d95edacacd5dd34716f64b77f5bdce1}{d-\/$>$p} array that contains the positions {\ttfamily steps} back, -\/1 on error.
\end{DoxyReturn}
\-If {\ttfamily step} is too large, -\/1 is returned. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=338pt]{displacement_8c_a81fdcb711db1451146ded14dc295133a_icgraph}
\end{center}
\end{figure}


\hypertarget{displacement_8c_a2c2df45c0dc0ba8c0326f692cb7839d1}{\index{displacement.\-c@{displacement.\-c}!gmx\-\_\-ana\-\_\-displ\-\_\-create@{gmx\-\_\-ana\-\_\-displ\-\_\-create}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-create@{gmx\-\_\-ana\-\_\-displ\-\_\-create}!displacement.c@{displacement.\-c}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-create}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-create} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$$\ast$}]{data, }
\item[{int}]{nmax, }
\item[{real}]{tmax}
\end{DoxyParamCaption}
)}}\label{displacement_8c_a2c2df45c0dc0ba8c0326f692cb7839d1}

\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt out}  & {\em data} & \-Displacement calculation data structure pointer to initialize. \\
\hline
\mbox{\tt in}  & {\em nmax} & \-Number of particles for which displacements should be calculated. \\
\hline
\mbox{\tt in}  & {\em tmax} & \-Maximum interval (in same units as in the trajectory) for which displacements are required. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success.
\end{DoxyReturn}
\-This function only allocates memory for the first frame; \hyperlink{include_2displacement_8h_a4fbbe00acaff0a0a7b3d4593bf708b96}{gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame()} allocates a sufficient amount of memory for storing all the required positions once it known the interval between the trajectory frames. \hypertarget{displacement_8c_a1c6c8a635f8e4918789917d790958f77}{\index{displacement.\-c@{displacement.\-c}!gmx\-\_\-ana\-\_\-displ\-\_\-free@{gmx\-\_\-ana\-\_\-displ\-\_\-free}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-free@{gmx\-\_\-ana\-\_\-displ\-\_\-free}!displacement.c@{displacement.\-c}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-free}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} {\bf gmx\-\_\-ana\-\_\-displ\-\_\-free} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d}
\end{DoxyParamCaption}
)}}\label{displacement_8c_a1c6c8a635f8e4918789917d790958f77}

\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em d} & \-Displacement calculation data.\\
\hline
\end{DoxyParams}
\-After the call, the pointer {\ttfamily d} is invalid. \hypertarget{displacement_8c_a4fbbe00acaff0a0a7b3d4593bf708b96}{\index{displacement.\-c@{displacement.\-c}!gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame@{gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame@{gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame}!displacement.c@{displacement.\-c}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{real}]{t}
\end{DoxyParamCaption}
)}}\label{displacement_8c_a4fbbe00acaff0a0a7b3d4593bf708b96}

\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em t} & \-Time for the new frame. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, -\/1 on failure.
\end{DoxyReturn}
\-This function should be called at the beginning of each frame for which atomic positions should be stored. \-It is required that the times for which this function is called are evenly spaced; otherwise, it reports a fatal error. 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{displacement_8c_a4fbbe00acaff0a0a7b3d4593bf708b96_cgraph}
\end{center}
\end{figure}


\hypertarget{displacement_8c_a1249df9ac34685bd9609e1944bccb14a}{\index{displacement.\-c@{displacement.\-c}!gmx\-\_\-ana\-\_\-displ\-\_\-store@{gmx\-\_\-ana\-\_\-displ\-\_\-store}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-store@{gmx\-\_\-ana\-\_\-displ\-\_\-store}!displacement.c@{displacement.\-c}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-store}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-store} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{{\bf atom\-\_\-id}}]{id, }
\item[{{\bf rvec}}]{x, }
\item[{{\bf gmx\-\_\-bool}}]{b\-Pres}
\end{DoxyParamCaption}
)}}\label{displacement_8c_a1249df9ac34685bd9609e1944bccb14a}

\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em id} & \-Particle \-I\-D. \\
\hline
\mbox{\tt in}  & {\em x} & \-Particle position. \\
\hline
\mbox{\tt in}  & {\em b\-Pres} & \-T\-R\-U\-E if the particle should be marked as present. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success. 
\end{DoxyReturn}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=288pt]{displacement_8c_a1249df9ac34685bd9609e1944bccb14a_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{displacement_8c_a1249df9ac34685bd9609e1944bccb14a_icgraph}
\end{center}
\end{figure}


\hypertarget{displacement_8c_acd4c27a82da37705cbecc5400b5001ad}{\index{displacement.\-c@{displacement.\-c}!gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all@{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all@{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all}!displacement.c@{displacement.\-c}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{{\bf atom\-\_\-id}}]{id\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{displacement_8c_acd4c27a82da37705cbecc5400b5001ad}

\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em id} & \-Particle \-I\-Ds. \\
\hline
\mbox{\tt in}  & {\em x} & \-Particle positions. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success.
\end{DoxyReturn}
\-Both the {\ttfamily id} and {\ttfamily x} arrays should have {\ttfamily nmax} items, where {\ttfamily nmax} was provided for \hyperlink{include_2displacement_8h_a246b6e5b5ce780fd88210f0e0f6410eb}{gmx\-\_\-ana\-\_\-displ\-\_\-create()}, and the {\ttfamily id}\mbox{[}i\mbox{]} should be either {\ttfamily i} or -\/1. \-If {\ttfamily id}\mbox{[}i\mbox{]}==-\/1, then that particle is marked as not present, but the position is still stored. 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{displacement_8c_acd4c27a82da37705cbecc5400b5001ad_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{displacement_8c_acd4c27a82da37705cbecc5400b5001ad_icgraph}
\end{center}
\end{figure}


\hypertarget{displacement_8c_a23227f37b703ca5d00cdaa2af678e728}{\index{displacement.\-c@{displacement.\-c}!gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array@{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array@{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array}!displacement.c@{displacement.\-c}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{int}]{n, }
\item[{{\bf atom\-\_\-id}}]{id\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{displacement_8c_a23227f37b703ca5d00cdaa2af678e728}

\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em n} & \-Number of elements in the {\ttfamily id} and {\ttfamily x} arrays. \\
\hline
\mbox{\tt in}  & {\em id} & \-Particle \-I\-Ds. \\
\hline
\mbox{\tt in}  & {\em x} & \-Particle positions. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success.
\end{DoxyReturn}
\-The positions of the given {\ttfamily n} particles are stored, and all of them are marked as present. 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{displacement_8c_a23227f37b703ca5d00cdaa2af678e728_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{displacement_8c_a23227f37b703ca5d00cdaa2af678e728_icgraph}
\end{center}
\end{figure}


\hypertarget{displacement_8c_aafc782c3271e10f8207c828d5d0fe87f}{\index{displacement.\-c@{displacement.\-c}!gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-pos@{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-pos}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-pos@{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-pos}!displacement.c@{displacement.\-c}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-pos}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-pos} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{{\bf gmx\-\_\-ana\-\_\-pos\-\_\-t} $\ast$}]{p}
\end{DoxyParamCaption}
)}}\label{displacement_8c_aafc782c3271e10f8207c828d5d0fe87f}

\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em p} & \-Particle positions. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success.
\end{DoxyReturn}
{\ttfamily p} should have at most {\ttfamily nmax} positions, where {\ttfamily nmax} was provided for \hyperlink{include_2displacement_8h_a246b6e5b5ce780fd88210f0e0f6410eb}{gmx\-\_\-ana\-\_\-displ\-\_\-create()}. \-If {\ttfamily has} exactly {\ttfamily nmax} positions, \hyperlink{include_2displacement_8h_acd4c27a82da37705cbecc5400b5001ad}{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all()} is called, otherwise \hyperlink{include_2displacement_8h_a23227f37b703ca5d00cdaa2af678e728}{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array()} is used. 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{displacement_8c_aafc782c3271e10f8207c828d5d0fe87f_cgraph}
\end{center}
\end{figure}


\hypertarget{displacement_8c_adc268c27bcc727590b27636bf52daa0d}{\index{displacement.\-c@{displacement.\-c}!gmx\-\_\-ana\-\_\-displ\-\_\-time\-\_\-to\-\_\-steps@{gmx\-\_\-ana\-\_\-displ\-\_\-time\-\_\-to\-\_\-steps}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-time\-\_\-to\-\_\-steps@{gmx\-\_\-ana\-\_\-displ\-\_\-time\-\_\-to\-\_\-steps}!displacement.c@{displacement.\-c}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-time\-\_\-to\-\_\-steps}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-time\-\_\-to\-\_\-steps} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{real}]{time, }
\item[{int $\ast$}]{steps}
\end{DoxyParamCaption}
)}}\label{displacement_8c_adc268c27bcc727590b27636bf52daa0d}

\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em time} & \-Time to convert to steps. \\
\hline
\mbox{\tt out}  & {\em steps} & \-The number of steps between the frames separated by {\ttfamily time}, 0 if the number of steps cannot be determined. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success (also if {\ttfamily $\ast$steps} is 0), -\/1 on error.
\end{DoxyReturn}
{\ttfamily $\ast$steps} is set to zero if \hyperlink{include_2displacement_8h_a4fbbe00acaff0a0a7b3d4593bf708b96}{gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame()} has not yet been called twice. -\/1 is returned if {\ttfamily time} is not an integer multiple of the interval between frames. 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=348pt]{displacement_8c_adc268c27bcc727590b27636bf52daa0d_cgraph}
\end{center}
\end{figure}


\hypertarget{displacement_8c_ad2b5a136e9e87e0976ae558bff6fa0a9}{\index{displacement.\-c@{displacement.\-c}!gmx\-\_\-ana\-\_\-displ\-\_\-vector@{gmx\-\_\-ana\-\_\-displ\-\_\-vector}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-vector@{gmx\-\_\-ana\-\_\-displ\-\_\-vector}!displacement.c@{displacement.\-c}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-vector}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-vector} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{int}]{step, }
\item[{{\bf t\-\_\-pbc} $\ast$}]{pbc, }
\item[{{\bf atom\-\_\-id}}]{id, }
\item[{{\bf rvec}}]{x, }
\item[{{\bf rvec}}]{xout, }
\item[{{\bf gmx\-\_\-bool} $\ast$}]{pout}
\end{DoxyParamCaption}
)}}\label{displacement_8c_ad2b5a136e9e87e0976ae558bff6fa0a9}

\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em step} & \-Displacement is calculated from the location {\ttfamily step} steps back. \\
\hline
\mbox{\tt in}  & {\em pbc} & \-Periodic boundary structure (if \-N\-U\-L\-L, \-P\-B\-C are not used in distance calculation). \\
\hline
\mbox{\tt in}  & {\em id} & \-Particle \-I\-D for which the displacement is calculated. \\
\hline
\mbox{\tt in}  & {\em x} & \-Current particle position. \\
\hline
\mbox{\tt out}  & {\em xout} & \-Displacement of the particle. \\
\hline
\mbox{\tt out}  & {\em pout} & \-T\-R\-U\-E if the old particle position was marked present. \-If {\ttfamily $\ast$pout} is \-F\-A\-L\-S\-E and the old particle position was not stored, the value of {\ttfamily xout} is undefined. \-Can be \-N\-U\-L\-L, in which case the value is not stored. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, -\/1 if less than {\ttfamily step} frames have been stored or {\ttfamily step} $<$= 0, or \-E\-I\-N\-V\-A\-L if {\ttfamily step} is too large. 
\end{DoxyReturn}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{displacement_8c_ad2b5a136e9e87e0976ae558bff6fa0a9_cgraph}
\end{center}
\end{figure}


\hypertarget{displacement_8c_a07581fadc4db16ad790533b67c7ed7a5}{\index{displacement.\-c@{displacement.\-c}!gmx\-\_\-ana\-\_\-displ\-\_\-vectors@{gmx\-\_\-ana\-\_\-displ\-\_\-vectors}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-vectors@{gmx\-\_\-ana\-\_\-displ\-\_\-vectors}!displacement.c@{displacement.\-c}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-vectors}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-vectors} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{int}]{step, }
\item[{{\bf t\-\_\-pbc} $\ast$}]{pbc, }
\item[{int}]{n, }
\item[{{\bf atom\-\_\-id}}]{id\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{xout\mbox{[}$\,$\mbox{]}, }
\item[{{\bf gmx\-\_\-bool} $\ast$}]{pout}
\end{DoxyParamCaption}
)}}\label{displacement_8c_a07581fadc4db16ad790533b67c7ed7a5}

\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em step} & \-Displacement is calculated from the location {\ttfamily step} steps back. \\
\hline
\mbox{\tt in}  & {\em pbc} & \-Periodic boundary structure (if \-N\-U\-L\-L, \-P\-B\-C are not used in distance calculation). \\
\hline
\mbox{\tt in}  & {\em n} & \-Number of particles for which to calculate. \\
\hline
\mbox{\tt in}  & {\em id} & \-Particle \-I\-Ds for which the displacement is calculated. \\
\hline
\mbox{\tt in}  & {\em x} & \-Current particle positions. \\
\hline
\mbox{\tt out}  & {\em xout} & \-Displacement of the particles. \\
\hline
\mbox{\tt out}  & {\em pout} & \-T\-R\-U\-E if the old particle position was marked present. \-If {\ttfamily pout}\mbox{[}i\mbox{]} is \-F\-A\-L\-S\-E and the old particle position was not stored, the value of {\ttfamily xout}\mbox{[}i\mbox{]} is undefined. \-Can be \-N\-U\-L\-L, in which case the value is not stored. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, -\/1 if less than {\ttfamily step} frames have been stored or {\ttfamily step} $<$= 0, or \-E\-I\-N\-V\-A\-L if {\ttfamily step} is too large. 
\end{DoxyReturn}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=324pt]{displacement_8c_a07581fadc4db16ad790533b67c7ed7a5_cgraph}
\end{center}
\end{figure}


\hypertarget{displacement_8c_af99ad13734798104a87fbdd44de8627e}{\index{displacement.\-c@{displacement.\-c}!gmx\-\_\-ana\-\_\-displ\-\_\-vectors\-\_\-all@{gmx\-\_\-ana\-\_\-displ\-\_\-vectors\-\_\-all}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-vectors\-\_\-all@{gmx\-\_\-ana\-\_\-displ\-\_\-vectors\-\_\-all}!displacement.c@{displacement.\-c}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-vectors\-\_\-all}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-vectors\-\_\-all} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{int}]{step, }
\item[{{\bf t\-\_\-pbc} $\ast$}]{pbc, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{xout\mbox{[}$\,$\mbox{]}, }
\item[{{\bf gmx\-\_\-bool} $\ast$}]{pout}
\end{DoxyParamCaption}
)}}\label{displacement_8c_af99ad13734798104a87fbdd44de8627e}

\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em step} & \-Displacement is calculated from the location {\ttfamily step} steps back. \\
\hline
\mbox{\tt in}  & {\em pbc} & \-Periodic boundary structure (if \-N\-U\-L\-L, \-P\-B\-C are not used in distance calculation). \\
\hline
\mbox{\tt in}  & {\em x} & \-Current particle positions. \\
\hline
\mbox{\tt out}  & {\em xout} & \-Displacement of the particles. \\
\hline
\mbox{\tt out}  & {\em pout} & \-T\-R\-U\-E if the old particle position was marked present. \-If {\ttfamily pout}\mbox{[}i\mbox{]} is \-F\-A\-L\-S\-E and the old particle position was not stored, the value of {\ttfamily xout}\mbox{[}i\mbox{]} is undefined. \-Can be \-N\-U\-L\-L, in which case the value is not stored. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, -\/1 if less than {\ttfamily step} frames have been stored or {\ttfamily step} $<$= 0, or \-E\-I\-N\-V\-A\-L if {\ttfamily step} is too large.
\end{DoxyReturn}
\-The {\ttfamily x} array should have {\ttfamily nmax} items, where {\ttfamily nmax} is the one provided to init\-\_\-displ\-\_\-calc(). 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=338pt]{displacement_8c_af99ad13734798104a87fbdd44de8627e_cgraph}
\end{center}
\end{figure}


