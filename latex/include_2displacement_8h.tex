\hypertarget{include_2displacement_8h}{\section{include/displacement.h \-File \-Reference}
\label{include_2displacement_8h}\index{include/displacement.\-h@{include/displacement.\-h}}
}


\-A\-P\-I for on-\/line calculation of displacements.  


{\ttfamily \#include \char`\"{}typedefs.\-h\char`\"{}}\*
\-Include dependency graph for displacement.\-h\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2displacement_8h__incl}
\end{center}
\end{figure}
\subsection*{\-Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} \hyperlink{include_2displacement_8h_a97d670636cda13c6201303b7c48e95aa}{gmx\-\_\-ana\-\_\-displ\-\_\-t}
\end{DoxyCompactItemize}
\subsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{include_2displacement_8h_a246b6e5b5ce780fd88210f0e0f6410eb}{gmx\-\_\-ana\-\_\-displ\-\_\-create} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$$\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, int nmax, real tmax)
\item 
int \hyperlink{include_2displacement_8h_a4fbbe00acaff0a0a7b3d4593bf708b96}{gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, real \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a2b515c84b1293071f7584da32ca336c0}{t})
\item 
int \hyperlink{include_2displacement_8h_a87f1257d1fff4526bfc989d1dbfd177a}{gmx\-\_\-ana\-\_\-displ\-\_\-time\-\_\-to\-\_\-steps} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, real time, int $\ast$nsteps)
\item 
int \hyperlink{include_2displacement_8h_a1249df9ac34685bd9609e1944bccb14a}{gmx\-\_\-ana\-\_\-displ\-\_\-store} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} id, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}, \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} b\-Pres)
\item 
int \hyperlink{include_2displacement_8h_a23227f37b703ca5d00cdaa2af678e728}{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, int \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a82736b60ddc8f6ec6c9591b0d6fcb394}{n}, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} id\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{include_2displacement_8h_acd4c27a82da37705cbecc5400b5001ad}{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} id\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{include_2displacement_8h_ab79079085cbe4605fc2c5ea9754a91e5}{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-pos} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, struct \hyperlink{structgmx__ana__pos__t}{gmx\-\_\-ana\-\_\-pos\-\_\-t} $\ast$p)
\item 
int \hyperlink{include_2displacement_8h_ad2b5a136e9e87e0976ae558bff6fa0a9}{gmx\-\_\-ana\-\_\-displ\-\_\-vector} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, int step, \hyperlink{structt__pbc}{t\-\_\-pbc} $\ast$pbc, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} id, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout, \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} $\ast$pout)
\item 
int \hyperlink{include_2displacement_8h_a07581fadc4db16ad790533b67c7ed7a5}{gmx\-\_\-ana\-\_\-displ\-\_\-vectors} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, int step, \hyperlink{structt__pbc}{t\-\_\-pbc} $\ast$pbc, int \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a82736b60ddc8f6ec6c9591b0d6fcb394}{n}, \hyperlink{include_2types_2simple_8h_ad3f47cdb48677e516e2049719612c737}{atom\-\_\-id} id\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout\mbox{[}$\,$\mbox{]}, \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} $\ast$pout)
\item 
int \hyperlink{include_2displacement_8h_af99ad13734798104a87fbdd44de8627e}{gmx\-\_\-ana\-\_\-displ\-\_\-vectors\-\_\-all} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d}, int step, \hyperlink{structt__pbc}{t\-\_\-pbc} $\ast$pbc, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}\mbox{[}$\,$\mbox{]}, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} xout\mbox{[}$\,$\mbox{]}, \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} $\ast$pout)
\item 
\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{include_2displacement_8h_a1c6c8a635f8e4918789917d790958f77}{gmx\-\_\-ana\-\_\-displ\-\_\-free} (\hyperlink{structgmx__ana__displ__t}{gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$\hyperlink{share_2template_2gromacs_2gmx__lapack_8h_ae624f265c646670d373e9de0306f184b}{d})
\end{DoxyCompactItemize}


\subsection{\-Detailed \-Description}
\-A\-P\-I for on-\/line calculation of displacements. \-The \-A\-P\-I is documented in more detail on a separate page\-: \hyperlink{displacements}{\-Displacement calculation routines}

\-The functions within this file can be used and developed independently of the other parts of the library. \-Other parts of the library do not reference these functions. 

\subsection{\-Typedef \-Documentation}
\hypertarget{include_2displacement_8h_a97d670636cda13c6201303b7c48e95aa}{\index{include/displacement.\-h@{include/displacement.\-h}!gmx\-\_\-ana\-\_\-displ\-\_\-t@{gmx\-\_\-ana\-\_\-displ\-\_\-t}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-t@{gmx\-\_\-ana\-\_\-displ\-\_\-t}!include/displacement.h@{include/displacement.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} {\bf gmx\-\_\-ana\-\_\-displ\-\_\-t}}}\label{include_2displacement_8h_a97d670636cda13c6201303b7c48e95aa}
\-Data structure for displacement calculation. 

\subsection{\-Function \-Documentation}
\hypertarget{include_2displacement_8h_a246b6e5b5ce780fd88210f0e0f6410eb}{\index{include/displacement.\-h@{include/displacement.\-h}!gmx\-\_\-ana\-\_\-displ\-\_\-create@{gmx\-\_\-ana\-\_\-displ\-\_\-create}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-create@{gmx\-\_\-ana\-\_\-displ\-\_\-create}!include/displacement.h@{include/displacement.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-create}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-create} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$$\ast$}]{data, }
\item[{int}]{nmax, }
\item[{real}]{tmax}
\end{DoxyParamCaption}
)}}\label{include_2displacement_8h_a246b6e5b5ce780fd88210f0e0f6410eb}
\-Allocates memory for displacement calculation.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt out}  & {\em data} & \-Displacement calculation data structure pointer to initialize. \\
\hline
\mbox{\tt in}  & {\em nmax} & \-Number of particles for which displacements should be calculated. \\
\hline
\mbox{\tt in}  & {\em tmax} & \-Maximum interval (in same units as in the trajectory) for which displacements are required. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success.
\end{DoxyReturn}
\-This function only allocates memory for the first frame; \hyperlink{include_2displacement_8h_a4fbbe00acaff0a0a7b3d4593bf708b96}{gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame()} allocates a sufficient amount of memory for storing all the required positions once it known the interval between the trajectory frames. \hypertarget{include_2displacement_8h_a1c6c8a635f8e4918789917d790958f77}{\index{include/displacement.\-h@{include/displacement.\-h}!gmx\-\_\-ana\-\_\-displ\-\_\-free@{gmx\-\_\-ana\-\_\-displ\-\_\-free}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-free@{gmx\-\_\-ana\-\_\-displ\-\_\-free}!include/displacement.h@{include/displacement.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-free}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} {\bf gmx\-\_\-ana\-\_\-displ\-\_\-free} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d}
\end{DoxyParamCaption}
)}}\label{include_2displacement_8h_a1c6c8a635f8e4918789917d790958f77}
\-Frees the memory allocated for displacement calculation.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em d} & \-Displacement calculation data.\\
\hline
\end{DoxyParams}
\-After the call, the pointer {\ttfamily d} is invalid. \hypertarget{include_2displacement_8h_a4fbbe00acaff0a0a7b3d4593bf708b96}{\index{include/displacement.\-h@{include/displacement.\-h}!gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame@{gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame@{gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame}!include/displacement.h@{include/displacement.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{real}]{t}
\end{DoxyParamCaption}
)}}\label{include_2displacement_8h_a4fbbe00acaff0a0a7b3d4593bf708b96}
\-Initializes displacement calculation for a frame.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em t} & \-Time for the new frame. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, -\/1 on failure.
\end{DoxyReturn}
\-This function should be called at the beginning of each frame for which atomic positions should be stored. \-It is required that the times for which this function is called are evenly spaced; otherwise, it reports a fatal error. \hypertarget{include_2displacement_8h_a1249df9ac34685bd9609e1944bccb14a}{\index{include/displacement.\-h@{include/displacement.\-h}!gmx\-\_\-ana\-\_\-displ\-\_\-store@{gmx\-\_\-ana\-\_\-displ\-\_\-store}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-store@{gmx\-\_\-ana\-\_\-displ\-\_\-store}!include/displacement.h@{include/displacement.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-store}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-store} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{{\bf atom\-\_\-id}}]{id, }
\item[{{\bf rvec}}]{x, }
\item[{{\bf gmx\-\_\-bool}}]{b\-Pres}
\end{DoxyParamCaption}
)}}\label{include_2displacement_8h_a1249df9ac34685bd9609e1944bccb14a}
\-Stores the position of a particle for displacement calculation.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em id} & \-Particle \-I\-D. \\
\hline
\mbox{\tt in}  & {\em x} & \-Particle position. \\
\hline
\mbox{\tt in}  & {\em b\-Pres} & \-T\-R\-U\-E if the particle should be marked as present. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success. 
\end{DoxyReturn}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2displacement_8h_a1249df9ac34685bd9609e1944bccb14a_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2displacement_8h_acd4c27a82da37705cbecc5400b5001ad}{\index{include/displacement.\-h@{include/displacement.\-h}!gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all@{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all@{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all}!include/displacement.h@{include/displacement.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{{\bf atom\-\_\-id}}]{id\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{include_2displacement_8h_acd4c27a82da37705cbecc5400b5001ad}
\-Stores an array of particle positions for displacement calculation, including unselected particles.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em id} & \-Particle \-I\-Ds. \\
\hline
\mbox{\tt in}  & {\em x} & \-Particle positions. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success.
\end{DoxyReturn}
\-Both the {\ttfamily id} and {\ttfamily x} arrays should have {\ttfamily nmax} items, where {\ttfamily nmax} was provided for \hyperlink{include_2displacement_8h_a246b6e5b5ce780fd88210f0e0f6410eb}{gmx\-\_\-ana\-\_\-displ\-\_\-create()}, and the {\ttfamily id}\mbox{[}i\mbox{]} should be either {\ttfamily i} or -\/1. \-If {\ttfamily id}\mbox{[}i\mbox{]}==-\/1, then that particle is marked as not present, but the position is still stored. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2displacement_8h_acd4c27a82da37705cbecc5400b5001ad_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2displacement_8h_a23227f37b703ca5d00cdaa2af678e728}{\index{include/displacement.\-h@{include/displacement.\-h}!gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array@{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array@{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array}!include/displacement.h@{include/displacement.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{int}]{n, }
\item[{{\bf atom\-\_\-id}}]{id\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{include_2displacement_8h_a23227f37b703ca5d00cdaa2af678e728}
\-Convenience function for storing an array of particle positions for displacement calculation.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em n} & \-Number of elements in the {\ttfamily id} and {\ttfamily x} arrays. \\
\hline
\mbox{\tt in}  & {\em id} & \-Particle \-I\-Ds. \\
\hline
\mbox{\tt in}  & {\em x} & \-Particle positions. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success.
\end{DoxyReturn}
\-The positions of the given {\ttfamily n} particles are stored, and all of them are marked as present. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2displacement_8h_a23227f37b703ca5d00cdaa2af678e728_icgraph}
\end{center}
\end{figure}


\hypertarget{include_2displacement_8h_ab79079085cbe4605fc2c5ea9754a91e5}{\index{include/displacement.\-h@{include/displacement.\-h}!gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-pos@{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-pos}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-pos@{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-pos}!include/displacement.h@{include/displacement.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-pos}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-pos} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{{\bf gmx\-\_\-ana\-\_\-pos\-\_\-t} $\ast$}]{p}
\end{DoxyParamCaption}
)}}\label{include_2displacement_8h_ab79079085cbe4605fc2c5ea9754a91e5}
\-Convenience function for storing a set of positions from {\ttfamily \hyperlink{structgmx__ana__pos__t}{gmx\-\_\-ana\-\_\-pos\-\_\-t}}.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em p} & \-Particle positions. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success.
\end{DoxyReturn}
{\ttfamily p} should have at most {\ttfamily nmax} positions, where {\ttfamily nmax} was provided for \hyperlink{include_2displacement_8h_a246b6e5b5ce780fd88210f0e0f6410eb}{gmx\-\_\-ana\-\_\-displ\-\_\-create()}. \-If {\ttfamily has} exactly {\ttfamily nmax} positions, \hyperlink{include_2displacement_8h_acd4c27a82da37705cbecc5400b5001ad}{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-all()} is called, otherwise \hyperlink{include_2displacement_8h_a23227f37b703ca5d00cdaa2af678e728}{gmx\-\_\-ana\-\_\-displ\-\_\-store\-\_\-array()} is used. \hypertarget{include_2displacement_8h_a87f1257d1fff4526bfc989d1dbfd177a}{\index{include/displacement.\-h@{include/displacement.\-h}!gmx\-\_\-ana\-\_\-displ\-\_\-time\-\_\-to\-\_\-steps@{gmx\-\_\-ana\-\_\-displ\-\_\-time\-\_\-to\-\_\-steps}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-time\-\_\-to\-\_\-steps@{gmx\-\_\-ana\-\_\-displ\-\_\-time\-\_\-to\-\_\-steps}!include/displacement.h@{include/displacement.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-time\-\_\-to\-\_\-steps}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-time\-\_\-to\-\_\-steps} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{real}]{time, }
\item[{int $\ast$}]{steps}
\end{DoxyParamCaption}
)}}\label{include_2displacement_8h_a87f1257d1fff4526bfc989d1dbfd177a}
\-Returns the number of steps corresponding to a given time interval.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em time} & \-Time to convert to steps. \\
\hline
\mbox{\tt out}  & {\em steps} & \-The number of steps between the frames separated by {\ttfamily time}, 0 if the number of steps cannot be determined. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success (also if {\ttfamily $\ast$steps} is 0), -\/1 on error.
\end{DoxyReturn}
{\ttfamily $\ast$steps} is set to zero if \hyperlink{include_2displacement_8h_a4fbbe00acaff0a0a7b3d4593bf708b96}{gmx\-\_\-ana\-\_\-displ\-\_\-start\-\_\-frame()} has not yet been called twice. -\/1 is returned if {\ttfamily time} is not an integer multiple of the interval between frames. \hypertarget{include_2displacement_8h_ad2b5a136e9e87e0976ae558bff6fa0a9}{\index{include/displacement.\-h@{include/displacement.\-h}!gmx\-\_\-ana\-\_\-displ\-\_\-vector@{gmx\-\_\-ana\-\_\-displ\-\_\-vector}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-vector@{gmx\-\_\-ana\-\_\-displ\-\_\-vector}!include/displacement.h@{include/displacement.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-vector}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-vector} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{int}]{step, }
\item[{{\bf t\-\_\-pbc} $\ast$}]{pbc, }
\item[{{\bf atom\-\_\-id}}]{id, }
\item[{{\bf rvec}}]{x, }
\item[{{\bf rvec}}]{xout, }
\item[{{\bf gmx\-\_\-bool} $\ast$}]{pout}
\end{DoxyParamCaption}
)}}\label{include_2displacement_8h_ad2b5a136e9e87e0976ae558bff6fa0a9}
\-Calculates the displacement vector for a particle.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em step} & \-Displacement is calculated from the location {\ttfamily step} steps back. \\
\hline
\mbox{\tt in}  & {\em pbc} & \-Periodic boundary structure (if \-N\-U\-L\-L, \-P\-B\-C are not used in distance calculation). \\
\hline
\mbox{\tt in}  & {\em id} & \-Particle \-I\-D for which the displacement is calculated. \\
\hline
\mbox{\tt in}  & {\em x} & \-Current particle position. \\
\hline
\mbox{\tt out}  & {\em xout} & \-Displacement of the particle. \\
\hline
\mbox{\tt out}  & {\em pout} & \-T\-R\-U\-E if the old particle position was marked present. \-If {\ttfamily $\ast$pout} is \-F\-A\-L\-S\-E and the old particle position was not stored, the value of {\ttfamily xout} is undefined. \-Can be \-N\-U\-L\-L, in which case the value is not stored. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, -\/1 if less than {\ttfamily step} frames have been stored or {\ttfamily step} $<$= 0, or \-E\-I\-N\-V\-A\-L if {\ttfamily step} is too large. 
\end{DoxyReturn}
\hypertarget{include_2displacement_8h_a07581fadc4db16ad790533b67c7ed7a5}{\index{include/displacement.\-h@{include/displacement.\-h}!gmx\-\_\-ana\-\_\-displ\-\_\-vectors@{gmx\-\_\-ana\-\_\-displ\-\_\-vectors}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-vectors@{gmx\-\_\-ana\-\_\-displ\-\_\-vectors}!include/displacement.h@{include/displacement.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-vectors}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-vectors} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{int}]{step, }
\item[{{\bf t\-\_\-pbc} $\ast$}]{pbc, }
\item[{int}]{n, }
\item[{{\bf atom\-\_\-id}}]{id\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{xout\mbox{[}$\,$\mbox{]}, }
\item[{{\bf gmx\-\_\-bool} $\ast$}]{pout}
\end{DoxyParamCaption}
)}}\label{include_2displacement_8h_a07581fadc4db16ad790533b67c7ed7a5}
\-Calculates the displacement vectors for a list of particles.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em step} & \-Displacement is calculated from the location {\ttfamily step} steps back. \\
\hline
\mbox{\tt in}  & {\em pbc} & \-Periodic boundary structure (if \-N\-U\-L\-L, \-P\-B\-C are not used in distance calculation). \\
\hline
\mbox{\tt in}  & {\em n} & \-Number of particles for which to calculate. \\
\hline
\mbox{\tt in}  & {\em id} & \-Particle \-I\-Ds for which the displacement is calculated. \\
\hline
\mbox{\tt in}  & {\em x} & \-Current particle positions. \\
\hline
\mbox{\tt out}  & {\em xout} & \-Displacement of the particles. \\
\hline
\mbox{\tt out}  & {\em pout} & \-T\-R\-U\-E if the old particle position was marked present. \-If {\ttfamily pout}\mbox{[}i\mbox{]} is \-F\-A\-L\-S\-E and the old particle position was not stored, the value of {\ttfamily xout}\mbox{[}i\mbox{]} is undefined. \-Can be \-N\-U\-L\-L, in which case the value is not stored. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, -\/1 if less than {\ttfamily step} frames have been stored or {\ttfamily step} $<$= 0, or \-E\-I\-N\-V\-A\-L if {\ttfamily step} is too large. 
\end{DoxyReturn}
\hypertarget{include_2displacement_8h_af99ad13734798104a87fbdd44de8627e}{\index{include/displacement.\-h@{include/displacement.\-h}!gmx\-\_\-ana\-\_\-displ\-\_\-vectors\-\_\-all@{gmx\-\_\-ana\-\_\-displ\-\_\-vectors\-\_\-all}}
\index{gmx\-\_\-ana\-\_\-displ\-\_\-vectors\-\_\-all@{gmx\-\_\-ana\-\_\-displ\-\_\-vectors\-\_\-all}!include/displacement.h@{include/displacement.\-h}}
\subsubsection[{gmx\-\_\-ana\-\_\-displ\-\_\-vectors\-\_\-all}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf gmx\-\_\-ana\-\_\-displ\-\_\-vectors\-\_\-all} (
\begin{DoxyParamCaption}
\item[{{\bf gmx\-\_\-ana\-\_\-displ\-\_\-t} $\ast$}]{d, }
\item[{int}]{step, }
\item[{{\bf t\-\_\-pbc} $\ast$}]{pbc, }
\item[{{\bf rvec}}]{x\mbox{[}$\,$\mbox{]}, }
\item[{{\bf rvec}}]{xout\mbox{[}$\,$\mbox{]}, }
\item[{{\bf gmx\-\_\-bool} $\ast$}]{pout}
\end{DoxyParamCaption}
)}}\label{include_2displacement_8h_af99ad13734798104a87fbdd44de8627e}
\-Calculates the displacement vectors for all particles, including unselected.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em d} & \-Displacement calculation data. \\
\hline
\mbox{\tt in}  & {\em step} & \-Displacement is calculated from the location {\ttfamily step} steps back. \\
\hline
\mbox{\tt in}  & {\em pbc} & \-Periodic boundary structure (if \-N\-U\-L\-L, \-P\-B\-C are not used in distance calculation). \\
\hline
\mbox{\tt in}  & {\em x} & \-Current particle positions. \\
\hline
\mbox{\tt out}  & {\em xout} & \-Displacement of the particles. \\
\hline
\mbox{\tt out}  & {\em pout} & \-T\-R\-U\-E if the old particle position was marked present. \-If {\ttfamily pout}\mbox{[}i\mbox{]} is \-F\-A\-L\-S\-E and the old particle position was not stored, the value of {\ttfamily xout}\mbox{[}i\mbox{]} is undefined. \-Can be \-N\-U\-L\-L, in which case the value is not stored. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, -\/1 if less than {\ttfamily step} frames have been stored or {\ttfamily step} $<$= 0, or \-E\-I\-N\-V\-A\-L if {\ttfamily step} is too large.
\end{DoxyReturn}
\-The {\ttfamily x} array should have {\ttfamily nmax} items, where {\ttfamily nmax} is the one provided to init\-\_\-displ\-\_\-calc(). 