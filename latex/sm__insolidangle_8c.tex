\hypertarget{sm__insolidangle_8c}{\section{src/gmxlib/selection/sm\-\_\-insolidangle.c \-File \-Reference}
\label{sm__insolidangle_8c}\index{src/gmxlib/selection/sm\-\_\-insolidangle.\-c@{src/gmxlib/selection/sm\-\_\-insolidangle.\-c}}
}
{\ttfamily \#include $<$math.\-h$>$}\*
{\ttfamily \#include $<$macros.\-h$>$}\*
{\ttfamily \#include $<$maths.\-h$>$}\*
{\ttfamily \#include $<$pbc.\-h$>$}\*
{\ttfamily \#include $<$physics.\-h$>$}\*
{\ttfamily \#include $<$smalloc.\-h$>$}\*
{\ttfamily \#include $<$vec.\-h$>$}\*
{\ttfamily \#include $<$indexutil.\-h$>$}\*
{\ttfamily \#include $<$position.\-h$>$}\*
{\ttfamily \#include $<$selection.\-h$>$}\*
{\ttfamily \#include $<$selmethod.\-h$>$}\*
{\ttfamily \#include \char`\"{}selelem.\-h\char`\"{}}\*
\-Include dependency graph for sm\-\_\-insolidangle.\-c\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c__incl}
\end{center}
\end{figure}
\subsection*{\-Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structt__partition__item}{t\-\_\-partition\-\_\-item}
\item 
struct \hyperlink{structt__partition}{t\-\_\-partition}
\item 
struct \hyperlink{structt__spheresurfacebin}{t\-\_\-spheresurfacebin}
\item 
struct \hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle}
\end{DoxyCompactItemize}
\subsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$ \hyperlink{sm__insolidangle_8c_a6fbff8808916f20c2821c76fec999d21}{init\-\_\-data\-\_\-insolidangle} (int npar, \hyperlink{structgmx__ana__selparam__t}{gmx\-\_\-ana\-\_\-selparam\-\_\-t} $\ast$param)
\item 
static int \hyperlink{sm__insolidangle_8c_aecfb88782327dc2794b910af87c0f330}{init\-\_\-insolidangle} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, int npar, \hyperlink{structgmx__ana__selparam__t}{gmx\-\_\-ana\-\_\-selparam\-\_\-t} $\ast$param, \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$data)
\item 
static \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{sm__insolidangle_8c_ace8d18e823d61441a945964ef2ada14a}{free\-\_\-data\-\_\-insolidangle} (\hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$data)
\item 
static int \hyperlink{sm__insolidangle_8c_ac30d2c3a370177cda8026e13062f0155}{init\-\_\-frame\-\_\-insolidangle} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{include_2types_2trx_8h_a206f77137d72a5db1097a457a7144ad5}{t\-\_\-trxframe} $\ast$\hyperlink{addconf_8c_ae8414314f87c5e49503ac0117eb511ad}{fr}, \hyperlink{structt__pbc}{t\-\_\-pbc} $\ast$pbc, \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$data)
\item 
static \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} \hyperlink{sm__insolidangle_8c_a7d06eb95d210dccde5af6f2217bcc0ec}{accept\-\_\-insolidangle} (\hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x}, \hyperlink{structt__pbc}{t\-\_\-pbc} $\ast$pbc, \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$data)
\item 
static int \hyperlink{sm__insolidangle_8c_a6789c9f3cfaa008d74b09575ff88ae5a}{evaluate\-\_\-insolidangle} (\hyperlink{structt__topology}{t\-\_\-topology} $\ast$\hyperlink{gmx__disre_8c_a1b538a2ce75aba6c346bc03980ffeb28}{top}, \hyperlink{include_2types_2trx_8h_a206f77137d72a5db1097a457a7144ad5}{t\-\_\-trxframe} $\ast$\hyperlink{addconf_8c_ae8414314f87c5e49503ac0117eb511ad}{fr}, \hyperlink{structt__pbc}{t\-\_\-pbc} $\ast$pbc, \hyperlink{structgmx__ana__pos__t}{gmx\-\_\-ana\-\_\-pos\-\_\-t} $\ast$pos, \hyperlink{structgmx__ana__selvalue__t}{gmx\-\_\-ana\-\_\-selvalue\-\_\-t} $\ast$out, \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} $\ast$data)
\item 
static real \hyperlink{sm__insolidangle_8c_a8e5d6ce11a70396827d8ceedfc5f4198}{sph\-\_\-distc} (\hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} x1, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} x2)
\item 
static int \hyperlink{sm__insolidangle_8c_a1324da71f63606aa2bb4220409c9c5fc}{find\-\_\-partition\-\_\-bin} (\hyperlink{structt__partition}{t\-\_\-partition} $\ast$p, real value)
\item 
static int \hyperlink{sm__insolidangle_8c_a6ded2bc422fdb91cb94466a5db45c886}{find\-\_\-surface\-\_\-bin} (\hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle} $\ast$surf, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x})
\item 
static \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{sm__insolidangle_8c_ac1c3ab216e483c81b1fb4c17b56433f9}{clear\-\_\-surface\-\_\-points} (\hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle} $\ast$surf)
\item 
static \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{sm__insolidangle_8c_a469087daddb33e03c9f378345d625d39}{free\-\_\-surface\-\_\-points} (\hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle} $\ast$surf)
\item 
static \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{sm__insolidangle_8c_adf3f11f16c8bb3bd9b54ed1e96ae189a}{add\-\_\-surface\-\_\-point} (\hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle} $\ast$surf, int tbin, int pbin, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x})
\item 
static \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{sm__insolidangle_8c_ad016ba6ae3e4a77948222f08f4004e4f}{mark\-\_\-surface\-\_\-covered} (\hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle} $\ast$surf, int tbin, int pbin)
\item 
static \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{sm__insolidangle_8c_a84534e84139d84e4734245abfbbbc253}{update\-\_\-surface\-\_\-bin} (\hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle} $\ast$surf, int tbin, real phi, real pdelta1, real pdelta2, real pdeltamax, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x})
\item 
static \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{sm__insolidangle_8c_a2364e1a3b6b8dfc58b95d8bf821ab28f}{store\-\_\-surface\-\_\-point} (\hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle} $\ast$surf, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x})
\item 
static \hyperlink{nbnxn__kernel__simd__4xn__outer_8h_a8dc3f4a797ed992dff49d2fa3477eee8}{void} \hyperlink{sm__insolidangle_8c_aadef1b206fd479d83a526a388faa275e}{optimize\-\_\-surface\-\_\-points} (\hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle} $\ast$surf)
\item 
static real \hyperlink{sm__insolidangle_8c_a76c1764a76a76b01b28265fe7483af19}{estimate\-\_\-covered\-\_\-fraction} (\hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle} $\ast$surf)
\item 
static \hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} \hyperlink{sm__insolidangle_8c_a2fa46c90d1f7602cfa5b28b4a5c80f7e}{is\-\_\-surface\-\_\-covered} (\hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle} $\ast$surf, \hyperlink{share_2template_2gromacs_2types_2simple_8h_aa02a552a4abd2f180c282a083dc3a999}{rvec} \hyperlink{share_2template_2gromacs_2gmx__lapack_8h_a36b8fb392443aff4dd09ac968a2acfe8}{x})
\item 
\hyperlink{include_2types_2simple_8h_a8fddad319f226e856400d190198d5151}{gmx\-\_\-bool} \hyperlink{sm__insolidangle_8c_af07ec4ec2094802c6a54791f9f4b64fd}{\-\_\-gmx\-\_\-selelem\-\_\-can\-\_\-estimate\-\_\-cover} (\hyperlink{structt__selelem}{t\-\_\-selelem} $\ast$sel)
\item 
real \hyperlink{sm__insolidangle_8c_aa65e319fbe4d3ce33c38a58aa383b1de}{\-\_\-gmx\-\_\-selelem\-\_\-estimate\-\_\-coverfrac} (\hyperlink{structt__selelem}{t\-\_\-selelem} $\ast$sel)
\end{DoxyCompactItemize}
\subsection*{\-Variables}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{structgmx__ana__selparam__t}{gmx\-\_\-ana\-\_\-selparam\-\_\-t} \hyperlink{sm__insolidangle_8c_a0f3d667fedb112ad79037d23f2ac948d}{smparams\-\_\-insolidangle} \mbox{[}$\,$\mbox{]}
\item 
static const char $\ast$ \hyperlink{sm__insolidangle_8c_af5aa0874a5ff484dc3db771ac0c8470c}{help\-\_\-insolidangle} \mbox{[}$\,$\mbox{]}
\item 
\hyperlink{structgmx__ana__selmethod__t}{gmx\-\_\-ana\-\_\-selmethod\-\_\-t} \hyperlink{sm__insolidangle_8c_a91d0726e5b25e139e82d56bad168f17a}{sm\-\_\-insolidangle}
\end{DoxyCompactItemize}


\subsection{\-Function \-Documentation}
\hypertarget{sm__insolidangle_8c_af07ec4ec2094802c6a54791f9f4b64fd}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!\-\_\-gmx\-\_\-selelem\-\_\-can\-\_\-estimate\-\_\-cover@{\-\_\-gmx\-\_\-selelem\-\_\-can\-\_\-estimate\-\_\-cover}}
\index{\-\_\-gmx\-\_\-selelem\-\_\-can\-\_\-estimate\-\_\-cover@{\-\_\-gmx\-\_\-selelem\-\_\-can\-\_\-estimate\-\_\-cover}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{\-\_\-gmx\-\_\-selelem\-\_\-can\-\_\-estimate\-\_\-cover}]{\setlength{\rightskip}{0pt plus 5cm}{\bf gmx\-\_\-bool} {\bf \-\_\-gmx\-\_\-selelem\-\_\-can\-\_\-estimate\-\_\-cover} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-selelem} $\ast$}]{sel}
\end{DoxyParamCaption}
)}}\label{sm__insolidangle_8c_af07ec4ec2094802c6a54791f9f4b64fd}

\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em sel} & \-Selection element to query. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-T\-R\-U\-E if the covered fraction can be estimated for {\ttfamily sel} with \hyperlink{selelem_8h_aa65e319fbe4d3ce33c38a58aa383b1de}{\-\_\-gmx\-\_\-selelem\-\_\-estimate\-\_\-coverfrac()}, \-F\-A\-L\-S\-E otherwise. 
\end{DoxyReturn}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_af07ec4ec2094802c6a54791f9f4b64fd_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_af07ec4ec2094802c6a54791f9f4b64fd_icgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_aa65e319fbe4d3ce33c38a58aa383b1de}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!\-\_\-gmx\-\_\-selelem\-\_\-estimate\-\_\-coverfrac@{\-\_\-gmx\-\_\-selelem\-\_\-estimate\-\_\-coverfrac}}
\index{\-\_\-gmx\-\_\-selelem\-\_\-estimate\-\_\-coverfrac@{\-\_\-gmx\-\_\-selelem\-\_\-estimate\-\_\-coverfrac}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{\-\_\-gmx\-\_\-selelem\-\_\-estimate\-\_\-coverfrac}]{\setlength{\rightskip}{0pt plus 5cm}real {\bf \-\_\-gmx\-\_\-selelem\-\_\-estimate\-\_\-coverfrac} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-selelem} $\ast$}]{sel}
\end{DoxyParamCaption}
)}}\label{sm__insolidangle_8c_aa65e319fbe4d3ce33c38a58aa383b1de}

\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em sel} & \-Selection for which the fraction should be calculated. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-Fraction of angles covered by the selection (between zero and one).
\end{DoxyReturn}
\-The return value is undefined if \hyperlink{selelem_8h_af07ec4ec2094802c6a54791f9f4b64fd}{\-\_\-gmx\-\_\-selelem\-\_\-can\-\_\-estimate\-\_\-cover()} returns \-F\-A\-L\-S\-E. \-Should be called after gmx\-\_\-ana\-\_\-evaluate\-\_\-selections() has been called for the frame. 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_aa65e319fbe4d3ce33c38a58aa383b1de_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_aa65e319fbe4d3ce33c38a58aa383b1de_icgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_a7d06eb95d210dccde5af6f2217bcc0ec}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!accept\-\_\-insolidangle@{accept\-\_\-insolidangle}}
\index{accept\-\_\-insolidangle@{accept\-\_\-insolidangle}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{accept\-\_\-insolidangle}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf gmx\-\_\-bool} {\bf accept\-\_\-insolidangle} (
\begin{DoxyParamCaption}
\item[{{\bf rvec}}]{x, }
\item[{{\bf t\-\_\-pbc} $\ast$}]{pbc, }
\item[{{\bf void} $\ast$}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_a7d06eb95d210dccde5af6f2217bcc0ec}
\-Internal helper function for \hyperlink{sm__insolidangle_8c_a6789c9f3cfaa008d74b09575ff88ae5a}{evaluate\-\_\-insolidangle()}.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em x} & \-Test point. \\
\hline
\mbox{\tt in}  & {\em pbc} & \-P\-B\-C data (if \-N\-U\-L\-L, no \-P\-B\-C are used). \\
\hline
\mbox{\tt in}  & {\em data} & \-Pointer to a {\ttfamily \hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle}} data structure. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-T\-R\-U\-E if {\ttfamily x} is within the solid angle, \-F\-A\-L\-S\-E otherwise. 
\end{DoxyReturn}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_a7d06eb95d210dccde5af6f2217bcc0ec_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=328pt]{sm__insolidangle_8c_a7d06eb95d210dccde5af6f2217bcc0ec_icgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_adf3f11f16c8bb3bd9b54ed1e96ae189a}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!add\-\_\-surface\-\_\-point@{add\-\_\-surface\-\_\-point}}
\index{add\-\_\-surface\-\_\-point@{add\-\_\-surface\-\_\-point}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{add\-\_\-surface\-\_\-point}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} {\bf add\-\_\-surface\-\_\-point} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-methoddata\-\_\-insolidangle} $\ast$}]{surf, }
\item[{int}]{tbin, }
\item[{int}]{pbin, }
\item[{{\bf rvec}}]{x}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_adf3f11f16c8bb3bd9b54ed1e96ae189a}
\-Adds a reference point to a given bin.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em surf} & \-Surface data structure. \\
\hline
\mbox{\tt in}  & {\em tbin} & \-Bin number in the zenith angle direction. \\
\hline
\mbox{\tt in}  & {\em pbin} & \-Bin number in the azimuthal angle direction. \\
\hline
\mbox{\tt in}  & {\em x} & \-Point to store. \\
\hline
\end{DoxyParams}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=274pt]{sm__insolidangle_8c_adf3f11f16c8bb3bd9b54ed1e96ae189a_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_adf3f11f16c8bb3bd9b54ed1e96ae189a_icgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_ac1c3ab216e483c81b1fb4c17b56433f9}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!clear\-\_\-surface\-\_\-points@{clear\-\_\-surface\-\_\-points}}
\index{clear\-\_\-surface\-\_\-points@{clear\-\_\-surface\-\_\-points}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{clear\-\_\-surface\-\_\-points}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} {\bf clear\-\_\-surface\-\_\-points} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-methoddata\-\_\-insolidangle} $\ast$}]{surf}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_ac1c3ab216e483c81b1fb4c17b56433f9}
\-Clears/initializes the bins on the unit sphere surface.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em surf} & \-Surface data structure.\\
\hline
\end{DoxyParams}
\-Clears the reference points from the bins and (re)initializes the edges of the azimuthal bins. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=340pt]{sm__insolidangle_8c_ac1c3ab216e483c81b1fb4c17b56433f9_icgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_a76c1764a76a76b01b28265fe7483af19}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!estimate\-\_\-covered\-\_\-fraction@{estimate\-\_\-covered\-\_\-fraction}}
\index{estimate\-\_\-covered\-\_\-fraction@{estimate\-\_\-covered\-\_\-fraction}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{estimate\-\_\-covered\-\_\-fraction}]{\setlength{\rightskip}{0pt plus 5cm}static real {\bf estimate\-\_\-covered\-\_\-fraction} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-methoddata\-\_\-insolidangle} $\ast$}]{surf}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_a76c1764a76a76b01b28265fe7483af19}
\-Estimates the area covered by the reference cones.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em surf} & \-Surface data structure. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-An estimate for the area covered by the reference points. 
\end{DoxyReturn}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_a76c1764a76a76b01b28265fe7483af19_icgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_a6789c9f3cfaa008d74b09575ff88ae5a}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!evaluate\-\_\-insolidangle@{evaluate\-\_\-insolidangle}}
\index{evaluate\-\_\-insolidangle@{evaluate\-\_\-insolidangle}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{evaluate\-\_\-insolidangle}]{\setlength{\rightskip}{0pt plus 5cm}static int {\bf evaluate\-\_\-insolidangle} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf t\-\_\-trxframe} $\ast$}]{fr, }
\item[{{\bf t\-\_\-pbc} $\ast$}]{pbc, }
\item[{{\bf gmx\-\_\-ana\-\_\-pos\-\_\-t} $\ast$}]{pos, }
\item[{{\bf gmx\-\_\-ana\-\_\-selvalue\-\_\-t} $\ast$}]{out, }
\item[{{\bf void} $\ast$}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_a6789c9f3cfaa008d74b09575ff88ae5a}
\-Evaluates the {\ttfamily insolidangle} selection method.

\-See \hyperlink{include_2selmethod_8h_a8492a3e2b034f195b558030d2bcecb18}{sel\-\_\-updatefunc()} for description of the parameters. {\ttfamily data} should point to a {\ttfamily \hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle}}.

\-Calculates which atoms in {\ttfamily g} are within the solid angle spanned by {\ttfamily \hyperlink{structt__methoddata__insolidangle_aad5ce88f1a977f3fee8c77be3928c727}{t\-\_\-methoddata\-\_\-insolidangle\-::span}} and centered at {\ttfamily \hyperlink{structt__methoddata__insolidangle_a6539e42606add2a09beb64be51c783eb}{t\-\_\-methoddata\-\_\-insolidangle\-::center}}, and stores the result in {\ttfamily out-\/$>$u.\-g}. 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_a6789c9f3cfaa008d74b09575ff88ae5a_cgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_a1324da71f63606aa2bb4220409c9c5fc}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!find\-\_\-partition\-\_\-bin@{find\-\_\-partition\-\_\-bin}}
\index{find\-\_\-partition\-\_\-bin@{find\-\_\-partition\-\_\-bin}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{find\-\_\-partition\-\_\-bin}]{\setlength{\rightskip}{0pt plus 5cm}static int {\bf find\-\_\-partition\-\_\-bin} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-partition} $\ast$}]{p, }
\item[{real}]{value}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_a1324da71f63606aa2bb4220409c9c5fc}
\-Does a binary search on a {\ttfamily \hyperlink{structt__partition}{t\-\_\-partition}} to find a bin for a value.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em p} & \-Partition to search. \\
\hline
\mbox{\tt in}  & {\em value} & \-Value to search for. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-The partition index in {\ttfamily p} that contains {\ttfamily value}.
\end{DoxyReturn}
\-If {\ttfamily value} is outside the range of {\ttfamily p}, the first/last index is returned. \-Otherwise, the return value {\ttfamily i} satisfies {\ttfamily p-\/$>$p}\mbox{[}i\mbox{]}.left$<$=value and {\ttfamily p-\/$>$p}\mbox{[}i+1\mbox{]}.left$>$value 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_a1324da71f63606aa2bb4220409c9c5fc_icgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_a6ded2bc422fdb91cb94466a5db45c886}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!find\-\_\-surface\-\_\-bin@{find\-\_\-surface\-\_\-bin}}
\index{find\-\_\-surface\-\_\-bin@{find\-\_\-surface\-\_\-bin}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{find\-\_\-surface\-\_\-bin}]{\setlength{\rightskip}{0pt plus 5cm}static int {\bf find\-\_\-surface\-\_\-bin} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-methoddata\-\_\-insolidangle} $\ast$}]{surf, }
\item[{{\bf rvec}}]{x}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_a6ded2bc422fdb91cb94466a5db45c886}
\-Finds a bin that corresponds to a location on the unit sphere surface.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em surf} & \-Surface data structure to search. \\
\hline
\mbox{\tt in}  & {\em x} & \-Unit vector to find. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-The bin index that contains {\ttfamily x}.
\end{DoxyReturn}
\-The return value is an index to the {\ttfamily surf-\/$>$bin} array. 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=294pt]{sm__insolidangle_8c_a6ded2bc422fdb91cb94466a5db45c886_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_a6ded2bc422fdb91cb94466a5db45c886_icgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_ace8d18e823d61441a945964ef2ada14a}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!free\-\_\-data\-\_\-insolidangle@{free\-\_\-data\-\_\-insolidangle}}
\index{free\-\_\-data\-\_\-insolidangle@{free\-\_\-data\-\_\-insolidangle}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{free\-\_\-data\-\_\-insolidangle}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} {\bf free\-\_\-data\-\_\-insolidangle} (
\begin{DoxyParamCaption}
\item[{{\bf void} $\ast$}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_ace8d18e823d61441a945964ef2ada14a}
\-Frees the data allocated for the {\ttfamily insolidangle} selection method.


\begin{DoxyParams}{\-Parameters}
{\em data} & \-Data to free (should point to a \hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle}).\\
\hline
\end{DoxyParams}
\-Frees the memory allocated for {\ttfamily \hyperlink{structt__methoddata__insolidangle_a6539e42606add2a09beb64be51c783eb}{t\-\_\-methoddata\-\_\-insolidangle\-::center}} and {\ttfamily \hyperlink{structt__methoddata__insolidangle_aad5ce88f1a977f3fee8c77be3928c727}{t\-\_\-methoddata\-\_\-insolidangle\-::span}}, as well as the memory for the internal bin structure. 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=332pt]{sm__insolidangle_8c_ace8d18e823d61441a945964ef2ada14a_cgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_a469087daddb33e03c9f378345d625d39}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!free\-\_\-surface\-\_\-points@{free\-\_\-surface\-\_\-points}}
\index{free\-\_\-surface\-\_\-points@{free\-\_\-surface\-\_\-points}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{free\-\_\-surface\-\_\-points}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} {\bf free\-\_\-surface\-\_\-points} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-methoddata\-\_\-insolidangle} $\ast$}]{surf}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_a469087daddb33e03c9f378345d625d39}
\-Frees memory allocated for storing the reference points in the surface bins.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em surf} & \-Surface data structure. \\
\hline
\end{DoxyParams}


\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{sm__insolidangle_8c_a469087daddb33e03c9f378345d625d39_icgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_a6fbff8808916f20c2821c76fec999d21}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!init\-\_\-data\-\_\-insolidangle@{init\-\_\-data\-\_\-insolidangle}}
\index{init\-\_\-data\-\_\-insolidangle@{init\-\_\-data\-\_\-insolidangle}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{init\-\_\-data\-\_\-insolidangle}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} $\ast$ {\bf init\-\_\-data\-\_\-insolidangle} (
\begin{DoxyParamCaption}
\item[{int}]{npar, }
\item[{{\bf gmx\-\_\-ana\-\_\-selparam\-\_\-t} $\ast$}]{param}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_a6fbff8808916f20c2821c76fec999d21}
\-Allocates data for the {\ttfamily insolidangle} selection method.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em npar} & \-Not used (should be 3). \\
\hline
\mbox{\tt in,out}  & {\em param} & \-Method parameters (should point to \hyperlink{sm__insolidangle_8c_a0f3d667fedb112ad79037d23f2ac948d}{smparams\-\_\-insolidangle}). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-Pointer to the allocated data (\hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle}).
\end{DoxyReturn}
\-Allocates memory for a \hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle} structure and initializes the parameter as follows\-:
\begin{DoxyItemize}
\item {\ttfamily center} defines the value for \hyperlink{structt__methoddata__insolidangle_a6539e42606add2a09beb64be51c783eb}{t\-\_\-methoddata\-\_\-insolidangle\-::center}.
\item {\ttfamily span} defines the value for \hyperlink{structt__methoddata__insolidangle_aad5ce88f1a977f3fee8c77be3928c727}{t\-\_\-methoddata\-\_\-insolidangle\-::span}.
\item {\ttfamily cutoff} defines the value for \hyperlink{structt__methoddata__insolidangle_a3719abb1ecb6c567fe408df3df588c83}{t\-\_\-methoddata\-\_\-insolidangle\-::angcut}. 
\end{DoxyItemize}\hypertarget{sm__insolidangle_8c_ac30d2c3a370177cda8026e13062f0155}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!init\-\_\-frame\-\_\-insolidangle@{init\-\_\-frame\-\_\-insolidangle}}
\index{init\-\_\-frame\-\_\-insolidangle@{init\-\_\-frame\-\_\-insolidangle}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{init\-\_\-frame\-\_\-insolidangle}]{\setlength{\rightskip}{0pt plus 5cm}static int {\bf init\-\_\-frame\-\_\-insolidangle} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{{\bf t\-\_\-trxframe} $\ast$}]{fr, }
\item[{{\bf t\-\_\-pbc} $\ast$}]{pbc, }
\item[{{\bf void} $\ast$}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_ac30d2c3a370177cda8026e13062f0155}
\-Initializes the evaluation of the {\ttfamily insolidangle} selection method for a frame.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em top} & \-Not used. \\
\hline
\mbox{\tt in}  & {\em fr} & \-Current frame. \\
\hline
\mbox{\tt in}  & {\em pbc} & \-P\-B\-C structure. \\
\hline
 & {\em data} & \-Should point to a \hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle}. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, a non-\/zero error code on error.
\end{DoxyReturn}
\-Creates a lookup structure that enables fast queries of whether a point is within the solid angle or not. 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_ac30d2c3a370177cda8026e13062f0155_cgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_aecfb88782327dc2794b910af87c0f330}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!init\-\_\-insolidangle@{init\-\_\-insolidangle}}
\index{init\-\_\-insolidangle@{init\-\_\-insolidangle}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{init\-\_\-insolidangle}]{\setlength{\rightskip}{0pt plus 5cm}static int {\bf init\-\_\-insolidangle} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-topology} $\ast$}]{top, }
\item[{int}]{npar, }
\item[{{\bf gmx\-\_\-ana\-\_\-selparam\-\_\-t} $\ast$}]{param, }
\item[{{\bf void} $\ast$}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_aecfb88782327dc2794b910af87c0f330}
\-Initializes the {\ttfamily insolidangle} selection method.


\begin{DoxyParams}{\-Parameters}
{\em top} & \-Not used. \\
\hline
{\em npar} & \-Not used. \\
\hline
{\em param} & \-Not used. \\
\hline
{\em data} & \-Pointer to \hyperlink{structt__methoddata__insolidangle}{t\-\_\-methoddata\-\_\-insolidangle} to initialize. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
0 on success, -\/1 on failure.
\end{DoxyReturn}
\-Converts \hyperlink{structt__methoddata__insolidangle_a3719abb1ecb6c567fe408df3df588c83}{t\-\_\-methoddata\-\_\-insolidangle\-::angcut} to radians and allocates and allocates memory for the bins used during the evaluation. \hypertarget{sm__insolidangle_8c_a2fa46c90d1f7602cfa5b28b4a5c80f7e}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!is\-\_\-surface\-\_\-covered@{is\-\_\-surface\-\_\-covered}}
\index{is\-\_\-surface\-\_\-covered@{is\-\_\-surface\-\_\-covered}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{is\-\_\-surface\-\_\-covered}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf gmx\-\_\-bool} {\bf is\-\_\-surface\-\_\-covered} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-methoddata\-\_\-insolidangle} $\ast$}]{surf, }
\item[{{\bf rvec}}]{x}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_a2fa46c90d1f7602cfa5b28b4a5c80f7e}
\-Checks whether a point lies within a solid angle.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em surf} & \-Surface data structure to search. \\
\hline
\mbox{\tt in}  & {\em x} & \-Unit vector to check. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-T\-R\-U\-E if {\ttfamily x} is within the solid angle, \-F\-A\-L\-S\-E otherwise. 
\end{DoxyReturn}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_a2fa46c90d1f7602cfa5b28b4a5c80f7e_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_a2fa46c90d1f7602cfa5b28b4a5c80f7e_icgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_ad016ba6ae3e4a77948222f08f4004e4f}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!mark\-\_\-surface\-\_\-covered@{mark\-\_\-surface\-\_\-covered}}
\index{mark\-\_\-surface\-\_\-covered@{mark\-\_\-surface\-\_\-covered}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{mark\-\_\-surface\-\_\-covered}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} {\bf mark\-\_\-surface\-\_\-covered} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-methoddata\-\_\-insolidangle} $\ast$}]{surf, }
\item[{int}]{tbin, }
\item[{int}]{pbin}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_ad016ba6ae3e4a77948222f08f4004e4f}
\-Marks a bin as completely covered.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em surf} & \-Surface data structure. \\
\hline
\mbox{\tt in}  & {\em tbin} & \-Bin number in the zenith angle direction. \\
\hline
\mbox{\tt in}  & {\em pbin} & \-Bin number in the azimuthal angle direction. \\
\hline
\end{DoxyParams}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=262pt]{sm__insolidangle_8c_ad016ba6ae3e4a77948222f08f4004e4f_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_ad016ba6ae3e4a77948222f08f4004e4f_icgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_aadef1b206fd479d83a526a388faa275e}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!optimize\-\_\-surface\-\_\-points@{optimize\-\_\-surface\-\_\-points}}
\index{optimize\-\_\-surface\-\_\-points@{optimize\-\_\-surface\-\_\-points}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{optimize\-\_\-surface\-\_\-points}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} {\bf optimize\-\_\-surface\-\_\-points} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-methoddata\-\_\-insolidangle} $\ast$}]{surf}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_aadef1b206fd479d83a526a388faa275e}
\-Optimizes the surface bins for faster searching.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em surf} & \-Surface data structure.\\
\hline
\end{DoxyParams}
\-Currently, this function does nothing. 

\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_aadef1b206fd479d83a526a388faa275e_icgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_a8e5d6ce11a70396827d8ceedfc5f4198}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!sph\-\_\-distc@{sph\-\_\-distc}}
\index{sph\-\_\-distc@{sph\-\_\-distc}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{sph\-\_\-distc}]{\setlength{\rightskip}{0pt plus 5cm}static real {\bf sph\-\_\-distc} (
\begin{DoxyParamCaption}
\item[{{\bf rvec}}]{x1, }
\item[{{\bf rvec}}]{x2}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_a8e5d6ce11a70396827d8ceedfc5f4198}
\-Calculates the distance between unit vectors.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em x1} & \-Unit vector 1. \\
\hline
\mbox{\tt in}  & {\em x2} & \-Unit vector 2. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-Minus the dot product of {\ttfamily x1} and {\ttfamily x2}.
\end{DoxyReturn}
\-This function is used internally to calculate the distance between the unit vectors {\ttfamily x1} and {\ttfamily x2} to find out whether {\ttfamily x2} is within the cone centered at {\ttfamily x1}. \-Currently, the cosine of the angle is used for efficiency, and the minus is there to make it behave like a normal distance (larger values mean longer distances). 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=214pt]{sm__insolidangle_8c_a8e5d6ce11a70396827d8ceedfc5f4198_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_a8e5d6ce11a70396827d8ceedfc5f4198_icgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_a2364e1a3b6b8dfc58b95d8bf821ab28f}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!store\-\_\-surface\-\_\-point@{store\-\_\-surface\-\_\-point}}
\index{store\-\_\-surface\-\_\-point@{store\-\_\-surface\-\_\-point}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{store\-\_\-surface\-\_\-point}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} {\bf store\-\_\-surface\-\_\-point} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-methoddata\-\_\-insolidangle} $\ast$}]{surf, }
\item[{{\bf rvec}}]{x}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_a2364e1a3b6b8dfc58b95d8bf821ab28f}
\-Adds a single reference point and updates the surface bins.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em surf} & \-Surface data structure. \\
\hline
\mbox{\tt in}  & {\em x} & \-Point to store (should have unit length).\\
\hline
\end{DoxyParams}
\-Finds all the bins covered by the cone centered at {\ttfamily x} and calls \hyperlink{sm__insolidangle_8c_a84534e84139d84e4734245abfbbbc253}{update\-\_\-surface\-\_\-bin()} to update them. 

\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_a2364e1a3b6b8dfc58b95d8bf821ab28f_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{sm__insolidangle_8c_a2364e1a3b6b8dfc58b95d8bf821ab28f_icgraph}
\end{center}
\end{figure}


\hypertarget{sm__insolidangle_8c_a84534e84139d84e4734245abfbbbc253}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!update\-\_\-surface\-\_\-bin@{update\-\_\-surface\-\_\-bin}}
\index{update\-\_\-surface\-\_\-bin@{update\-\_\-surface\-\_\-bin}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{update\-\_\-surface\-\_\-bin}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} {\bf update\-\_\-surface\-\_\-bin} (
\begin{DoxyParamCaption}
\item[{{\bf t\-\_\-methoddata\-\_\-insolidangle} $\ast$}]{surf, }
\item[{int}]{tbin, }
\item[{real}]{phi, }
\item[{real}]{pdelta1, }
\item[{real}]{pdelta2, }
\item[{real}]{pdeltamax, }
\item[{{\bf rvec}}]{x}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_a84534e84139d84e4734245abfbbbc253}
\-Helper function for \hyperlink{sm__insolidangle_8c_a2364e1a3b6b8dfc58b95d8bf821ab28f}{store\-\_\-surface\-\_\-point()} to update a single zenith angle bin.


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in,out}  & {\em surf} & \-Surface data structure. \\
\hline
\mbox{\tt in}  & {\em tbin} & \-Bin number in the zenith angle direction. \\
\hline
\mbox{\tt in}  & {\em phi} & \-Azimuthal angle of {\ttfamily x}. \\
\hline
\mbox{\tt in}  & {\em pdelta1} & \-Width of the cone at the lower edge of {\ttfamily tbin}. \\
\hline
\mbox{\tt in}  & {\em pdelta2} & \-Width of the cone at the uppper edge of {\ttfamily tbin}. \\
\hline
\mbox{\tt in}  & {\em pdeltamax} & \-Max. width of the cone inside {\ttfamily tbin}. \\
\hline
\mbox{\tt in}  & {\em x} & \-Point to store (should have unit length). \\
\hline
\end{DoxyParams}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_a84534e84139d84e4734245abfbbbc253_cgraph}
\end{center}
\end{figure}




\-Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{sm__insolidangle_8c_a84534e84139d84e4734245abfbbbc253_icgraph}
\end{center}
\end{figure}




\subsection{\-Variable \-Documentation}
\hypertarget{sm__insolidangle_8c_af5aa0874a5ff484dc3db771ac0c8470c}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!help\-\_\-insolidangle@{help\-\_\-insolidangle}}
\index{help\-\_\-insolidangle@{help\-\_\-insolidangle}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{help\-\_\-insolidangle}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ {\bf help\-\_\-insolidangle}\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_af5aa0874a5ff484dc3db771ac0c8470c}
{\bfseries \-Initial value\-:}
\begin{DoxyCode}
 {
    "SELECTING ATOMS IN A SOLID ANGLE[PAR]",

    "[TT]insolidangle center POS span POS_EXPR [cutoff REAL][tt][PAR]",

    "This keyword selects atoms that are within [TT]REAL[tt] degrees",
    "(default=5) of any position in [TT]POS_EXPR[tt] as seen from [TT]POS[tt]",
    "a position expression that evaluates to a single position), i.e., atoms",
    "in the solid angle spanned by the positions in [TT]POS_EXPR[tt] and",
    "centered at [TT]POS[tt].[PAR]"

    "Technically, the solid angle is constructed as a union of small cones",
    "whose tip is at [TT]POS[tt] and the axis goes through a point in",
    "[TT]POS_EXPR[tt]. There is such a cone for each position in",
    "[TT]POS_EXPR[tt], and point is in the solid angle if it lies within any",
    "of these cones. The cutoff determines the width of the cones.",
}
\end{DoxyCode}
\-Help text for the {\ttfamily insolidangle} selection method. \hypertarget{sm__insolidangle_8c_a91d0726e5b25e139e82d56bad168f17a}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!sm\-\_\-insolidangle@{sm\-\_\-insolidangle}}
\index{sm\-\_\-insolidangle@{sm\-\_\-insolidangle}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{sm\-\_\-insolidangle}]{\setlength{\rightskip}{0pt plus 5cm}{\bf gmx\-\_\-ana\-\_\-selmethod\-\_\-t} {\bf sm\-\_\-insolidangle}}}\label{sm__insolidangle_8c_a91d0726e5b25e139e82d56bad168f17a}
{\bfseries \-Initial value\-:}
\begin{DoxyCode}
 {
    "insolidangle", GROUP_VALUE, SMETH_DYNAMIC,
    asize(smparams_insolidangle), smparams_insolidangle,
    &init_data_insolidangle,
    NULL,
    &init_insolidangle,
    NULL,
    &free_data_insolidangle,
    &init_frame_insolidangle,
    NULL,
    &evaluate_insolidangle,
    {"insolidangle center POS span POS_EXPR [cutoff REAL]",
     asize(help_insolidangle), help_insolidangle},
}
\end{DoxyCode}
\hypertarget{sm__insolidangle_8c_a0f3d667fedb112ad79037d23f2ac948d}{\index{sm\-\_\-insolidangle.\-c@{sm\-\_\-insolidangle.\-c}!smparams\-\_\-insolidangle@{smparams\-\_\-insolidangle}}
\index{smparams\-\_\-insolidangle@{smparams\-\_\-insolidangle}!sm_insolidangle.c@{sm\-\_\-insolidangle.\-c}}
\subsubsection[{smparams\-\_\-insolidangle}]{\setlength{\rightskip}{0pt plus 5cm}{\bf gmx\-\_\-ana\-\_\-selparam\-\_\-t} {\bf smparams\-\_\-insolidangle}\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{sm__insolidangle_8c_a0f3d667fedb112ad79037d23f2ac948d}
{\bfseries \-Initial value\-:}
\begin{DoxyCode}
 {
    {"center", {POS_VALUE,   1, {NULL}}, NULL, SPAR_DYNAMIC},
    {"span",   {POS_VALUE,  -1, {NULL}}, NULL, SPAR_DYNAMIC | SPAR_VARNUM},
    {"cutoff", {REAL_VALUE,  1, {NULL}}, NULL, SPAR_OPTIONAL},
}
\end{DoxyCode}
\-Parameters for the {\ttfamily insolidangle} selection method. 