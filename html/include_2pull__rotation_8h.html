<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>My Project: include/pull_rotation.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">include/pull_rotation.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="include_2visibility_8h_source.html">visibility.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="include_2vec_8h_source.html">vec.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="include_2typedefs_8h_source.html">typedefs.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for pull_rotation.h:</div>
<div class="dyncontent">
<div class="center"><img src="include_2pull__rotation_8h__incl.png" border="0" usemap="#include_2pull__rotation_8h" alt=""/></div>
<map name="include_2pull__rotation_8h" id="include_2pull__rotation_8h">
<area shape="rect" id="node3" href="include_2visibility_8h.html" title="visibility.h" alt="" coords="2912,392,2992,421"/><area shape="rect" id="node5" href="include_2vec_8h.html" title="vec.h" alt="" coords="2719,83,2772,112"/><area shape="rect" id="node18" href="include_2typedefs_8h.html" title="typedefs.h" alt="" coords="1505,237,1588,267"/><area shape="rect" id="node8" href="include_2types_2simple_8h.html" title="types/simple.h" alt="" coords="827,547,933,576"/><area shape="rect" id="node12" href="include_2maths_8h.html" title="maths.h" alt="" coords="2657,160,2727,189"/><area shape="rect" id="node23" href="include_2sysstuff_8h.html" title="sysstuff.h" alt="" coords="2797,392,2877,421"/><area shape="rect" id="node125" href="include_2macros_8h.html" title="macros.h" alt="" coords="2559,160,2633,189"/><area shape="rect" id="node128" href="include_2gmx__fatal_8h.html" title="gmx_fatal.h" alt="" coords="3121,315,3212,344"/><area shape="rect" id="node136" href="include_2mpelogging_8h.html" title="mpelogging.h" alt="" coords="2751,160,2849,189"/><area shape="rect" id="node138" href="include_2physics_8h.html" title="physics.h" alt="" coords="2873,160,2951,189"/><area shape="rect" id="node43" href="include_2types_2enums_8h.html" title="types/enums.h" alt="" coords="2616,315,2723,344"/><area shape="rect" id="node45" href="include_2types_2block_8h.html" title="types/block.h" alt="" coords="813,392,912,421"/><area shape="rect" id="node47" href="include_2types_2idef_8h.html" title="idef.h" alt="" coords="923,469,976,499"/><area shape="rect" id="node50" href="include_2types_2symtab_8h.html" title="types/symtab.h" alt="" coords="397,392,509,421"/><area shape="rect" id="node53" href="include_2types_2atoms_8h.html" title="types/atoms.h" alt="" coords="533,392,637,421"/><area shape="rect" id="node56" href="include_2types_2trx_8h.html" title="types/trx.h" alt="" coords="499,315,581,344"/><area shape="rect" id="node59" href="include_2types_2topology_8h.html" title="types/topology.h" alt="" coords="605,315,723,344"/><area shape="rect" id="node66" href="include_2types_2energy_8h.html" title="types/energy.h" alt="" coords="757,469,864,499"/><area shape="rect" id="node69" href="include_2types_2inputrec_8h.html" title="types/inputrec.h" alt="" coords="2477,315,2592,344"/><area shape="rect" id="node73" href="include_2types_2ishift_8h.html" title="types/ishift.h" alt="" coords="848,315,944,344"/><area shape="rect" id="node75" href="include_2types_2graph_8h.html" title="types/graph.h" alt="" coords="1408,392,1509,421"/><area shape="rect" id="node78" href="include_2types_2nrnb_8h.html" title="types/nrnb.h" alt="" coords="1019,315,1112,344"/><area shape="rect" id="node80" href="include_2types_2nblist_8h.html" title="types/nblist.h" alt="" coords="1136,315,1235,344"/><area shape="rect" id="node82" href="include_2types_2nbnxn__pairlist_8h.html" title="types/nbnxn_pairlist.h" alt="" coords="1259,315,1408,344"/><area shape="rect" id="node84" href="include_2types_2nsgrid_8h.html" title="types/nsgrid.h" alt="" coords="2091,469,2195,499"/><area shape="rect" id="node87" href="include_2types_2forcerec_8h.html" title="types/forcerec.h" alt="" coords="1064,392,1179,421"/><area shape="rect" id="node90" href="include_2types_2fcdata_8h.html" title="types/fcdata.h" alt="" coords="1280,392,1384,421"/><area shape="rect" id="node92" href="include_2types_2mdatom_8h.html" title="types/mdatom.h" alt="" coords="1584,392,1699,421"/><area shape="rect" id="node95" href="include_2types_2pbc_8h.html" title="types/pbc.h" alt="" coords="1723,392,1813,421"/><area shape="rect" id="node98" href="include_2types_2ifunc_8h.html" title="types/ifunc.h" alt="" coords="1584,315,1680,344"/><area shape="rect" id="node106" href="include_2types_2filenm_8h.html" title="types/filenm.h" alt="" coords="1805,315,1909,344"/><area shape="rect" id="node108" href="include_2types_2group_8h.html" title="types/group.h" alt="" coords="43,392,144,421"/><area shape="rect" id="node111" href="include_2types_2state_8h.html" title="types/state.h" alt="" coords="157,469,256,499"/><area shape="rect" id="node114" href="include_2types_2shellfc_8h.html" title="types/shellfc.h" alt="" coords="1933,315,2040,344"/><area shape="rect" id="node116" href="include_2types_2constr_8h.html" title="types/constr.h" alt="" coords="2064,315,2168,344"/><area shape="rect" id="node118" href="include_2types_2matrix_8h.html" title="types/matrix.h" alt="" coords="219,392,323,421"/><area shape="rect" id="node121" href="include_2types_2oenv_8h.html" title="types/oenv.h" alt="" coords="2192,315,2288,344"/><area shape="rect" id="node33" href="include_2gmx__header__config_8h.html" title="gmx_header_config.h" alt="" coords="2373,469,2520,499"/><area shape="rect" id="node35" href="include_2version_8h.html" title="version.h" alt="" coords="2544,469,2619,499"/></map>
</div>
</div>
<p><a href="include_2pull__rotation_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="share_2template_2gromacs_2visibility_8h.html#ab80ef94c2b909a1a948639e98e63b612">GMX_LIBMD_EXPORT</a> <a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2pull__rotation_8h.html#aa078f96c50103aec325b6a554c5f0eb5">init_rot</a> (FILE *fplog, <a class="el" href="structt__inputrec.html">t_inputrec</a> *ir, int nfile, const <a class="el" href="structt__filenm.html">t_filenm</a> fnm[], <a class="el" href="structt__commrec.html">t_commrec</a> *cr, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> *<a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#a7ea9c2a830d3f743b887387e33645a83">matrix</a> box, <a class="el" href="structgmx__mtop__t.html">gmx_mtop_t</a> *mtop, const <a class="el" href="include_2types_2oenv_8h.html#a6a48d77d95132d7318780544821da6a5">output_env_t</a> oenv, <a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> bVerbose, unsigned long Flags)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the enforced rotation groups.  <a href="#aa078f96c50103aec325b6a554c5f0eb5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2pull__rotation_8h.html#aa4961bfc9547fb230b5c746a96d46967">dd_make_local_rotation_groups</a> (<a class="el" href="structgmx__domdec__t.html">gmx_domdec_t</a> *dd, <a class="el" href="structt__rot.html">t_rot</a> *<a class="el" href="hxprops_8c.html#adb6a00314ae684ae974fcce76dea126f">rot</a>)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Make a selection of the home atoms for all enforced rotation groups.  <a href="#aa4961bfc9547fb230b5c746a96d46967"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2pull__rotation_8h.html#a697bc400e3ddbdf1cbfc0037e03cbdca">do_rotation</a> (<a class="el" href="structt__commrec.html">t_commrec</a> *cr, <a class="el" href="structt__inputrec.html">t_inputrec</a> *ir, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#a7ea9c2a830d3f743b887387e33645a83">matrix</a> box, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], real <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a2b515c84b1293071f7584da32ca336c0">t</a>, gmx_large_int_t step, <a class="el" href="include_2types_2nrnb_8h.html#adc47bf7d40bee1f733f4c00cf76e85d9">gmx_wallcycle_t</a> wcycle, <a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> bNS)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of the enforced rotation potential.  <a href="#a697bc400e3ddbdf1cbfc0037e03cbdca"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2pull__rotation_8h.html#ac990bfdb352481759957710aa3993a31">add_rot_forces</a> (<a class="el" href="structt__rot.html">t_rot</a> *<a class="el" href="hxprops_8c.html#adb6a00314ae684ae974fcce76dea126f">rot</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="copyrite_8c.html#a0757cfb6fe645a02867727255faa4f8b">f</a>[], <a class="el" href="structt__commrec.html">t_commrec</a> *cr, gmx_large_int_t step, real <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a2b515c84b1293071f7584da32ca336c0">t</a>)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Add the enforced rotation forces to the official force array.  <a href="#ac990bfdb352481759957710aa3993a31"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="share_2template_2gromacs_2visibility_8h.html#ab80ef94c2b909a1a948639e98e63b612">GMX_LIBMD_EXPORT</a> <a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2pull__rotation_8h.html#a47520e0126d56a023bfb5a42c12f5403">finish_rot</a> (FILE *fplog, <a class="el" href="structt__rot.html">t_rot</a> *<a class="el" href="hxprops_8c.html#adb6a00314ae684ae974fcce76dea126f">rot</a>)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the enforced rotation output files.  <a href="#a47520e0126d56a023bfb5a42c12f5403"></a><br/></td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ac990bfdb352481759957710aa3993a31"></a><!-- doxytag: member="pull_rotation.h::add_rot_forces" ref="ac990bfdb352481759957710aa3993a31" args="(t_rot *rot, rvec f[], t_commrec *cr, gmx_large_int_t step, real t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real <a class="el" href="pull__rotation_8c.html#ac990bfdb352481759957710aa3993a31">add_rot_forces</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__rot.html">t_rot</a> *&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>f</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__commrec.html">t_commrec</a> *&#160;</td>
          <td class="paramname"><em>cr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gmx_large_int_t&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add the enforced rotation forces to the official force array. </p>
<p>Adds the forces from enforced rotation potential to the local forces and sums up the contributions to the rotation potential from all the nodes. Since this needs communication, this routine should be called after the SR forces have been evaluated (in order not to spoil cycle counts). This routine also outputs data to the various rotation output files (e.g. the potential, the angle of the group, torques and more).</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rot</td><td>Pointer to all the enforced rotation data. </td></tr>
    <tr><td class="paramname">f</td><td>The local forces to which the rotational forces have to be added. </td></tr>
    <tr><td class="paramname">cr</td><td>Pointer to MPI communication data. </td></tr>
    <tr><td class="paramname">step</td><td>The time step, used for output. </td></tr>
    <tr><td class="paramname">t</td><td>Time, used for output. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="include_2pull__rotation_8h_ac990bfdb352481759957710aa3993a31_icgraph.png" border="0" usemap="#include_2pull__rotation_8h_ac990bfdb352481759957710aa3993a31_icgraph" alt=""/></div>
<map name="include_2pull__rotation_8h_ac990bfdb352481759957710aa3993a31_icgraph" id="include_2pull__rotation_8h_ac990bfdb352481759957710aa3993a31_icgraph">
<area shape="rect" id="node3" href="sim__util_8c.html#a1d3281248b5954a553f69210c9d0c64d" title="do_force_cutsGROUP" alt="" coords="164,112,316,141"/><area shape="rect" id="node5" href="sim__util_8c.html#ae84da958cc847100953511b93beace28" title="do_force" alt="" coords="365,112,437,141"/><area shape="rect" id="node7" href="md_8c.html#ab03e50f07db7a24087c44ccdce343305" title="do_md" alt="" coords="521,32,583,61"/><area shape="rect" id="node9" href="minimize_8c.html#aad33a4afc8acff28fd568113b6640cb6" title="evaluate_energy" alt="" coords="493,85,611,115"/><area shape="rect" id="node19" href="shellfc_8c.html#ab995a0cadc09ea92f161b56ece2eb639" title="relax_shell_flexcon" alt="" coords="485,139,619,168"/><area shape="rect" id="node21" href="tpi_8c.html#a85cdc1fc8f1c59d64289bfed1474523a" title="do_tpi" alt="" coords="524,192,580,221"/><area shape="rect" id="node11" href="minimize_8c.html#a94b84868513558ebf1b177f04c39d167" title="do_cg" alt="" coords="676,5,732,35"/><area shape="rect" id="node13" href="minimize_8c.html#a53d420a517454c935d80f0d4a8d31634" title="do_lbfgs" alt="" coords="669,59,739,88"/><area shape="rect" id="node15" href="minimize_8c.html#a684fce135fec8d36bbf9739a871c7607" title="do_steep" alt="" coords="667,112,741,141"/><area shape="rect" id="node17" href="minimize_8c.html#a26a93ab5eaa25efa390ade3b20be07d5" title="do_nm" alt="" coords="673,165,735,195"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa4961bfc9547fb230b5c746a96d46967"></a><!-- doxytag: member="pull_rotation.h::dd_make_local_rotation_groups" ref="aa4961bfc9547fb230b5c746a96d46967" args="(gmx_domdec_t *dd, t_rot *rot)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a> <a class="el" href="pull__rotation_8c.html#aa4961bfc9547fb230b5c746a96d46967">dd_make_local_rotation_groups</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgmx__domdec__t.html">gmx_domdec_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__rot.html">t_rot</a> *&#160;</td>
          <td class="paramname"><em>rot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Make a selection of the home atoms for all enforced rotation groups. </p>
<p>This routine is similar to dd_make_local_pull_groups, but works only with domain decomposition. It should be called at every domain decomposition.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dd</td><td>Structure containing domain decomposition data. </td></tr>
    <tr><td class="paramname">rot</td><td>Pointer to all the enforced rotation data. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="include_2pull__rotation_8h_aa4961bfc9547fb230b5c746a96d46967_icgraph.png" border="0" usemap="#include_2pull__rotation_8h_aa4961bfc9547fb230b5c746a96d46967_icgraph" alt=""/></div>
<map name="include_2pull__rotation_8h_aa4961bfc9547fb230b5c746a96d46967_icgraph" id="include_2pull__rotation_8h_aa4961bfc9547fb230b5c746a96d46967_icgraph">
<area shape="rect" id="node3" href="domdec_8c.html#ad9975f2c1f834b25a14c3ff65932474f" title="dd_partition_system" alt="" coords="259,60,397,89"/><area shape="rect" id="node5" href="md_8c.html#ab03e50f07db7a24087c44ccdce343305" title="do_md" alt="" coords="497,7,559,36"/><area shape="rect" id="node7" href="minimize_8c.html#a9c79930a574d848d46ab1a4c9bbb9c43" title="init_em" alt="" coords="685,112,749,141"/><area shape="rect" id="node17" href="minimize_8c.html#adce4401383f53969c3073b7362e36ec5" title="em_dd_partition_system" alt="" coords="447,60,609,89"/><area shape="rect" id="node9" href="minimize_8c.html#a94b84868513558ebf1b177f04c39d167" title="do_cg" alt="" coords="833,5,889,35"/><area shape="rect" id="node11" href="minimize_8c.html#a53d420a517454c935d80f0d4a8d31634" title="do_lbfgs" alt="" coords="827,59,896,88"/><area shape="rect" id="node13" href="minimize_8c.html#a684fce135fec8d36bbf9739a871c7607" title="do_steep" alt="" coords="824,165,899,195"/><area shape="rect" id="node15" href="minimize_8c.html#a26a93ab5eaa25efa390ade3b20be07d5" title="do_nm" alt="" coords="831,112,892,141"/><area shape="rect" id="node19" href="minimize_8c.html#aad33a4afc8acff28fd568113b6640cb6" title="evaluate_energy" alt="" coords="659,59,776,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a697bc400e3ddbdf1cbfc0037e03cbdca"></a><!-- doxytag: member="pull_rotation.h::do_rotation" ref="a697bc400e3ddbdf1cbfc0037e03cbdca" args="(t_commrec *cr, t_inputrec *ir, matrix box, rvec x[], real t, gmx_large_int_t step, gmx_wallcycle_t wcycle, gmx_bool bNS)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a> <a class="el" href="pull__rotation_8c.html#a697bc400e3ddbdf1cbfc0037e03cbdca">do_rotation</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__commrec.html">t_commrec</a> *&#160;</td>
          <td class="paramname"><em>cr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__inputrec.html">t_inputrec</a> *&#160;</td>
          <td class="paramname"><em>ir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#a7ea9c2a830d3f743b887387e33645a83">matrix</a>&#160;</td>
          <td class="paramname"><em>box</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gmx_large_int_t&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2nrnb_8h.html#adc47bf7d40bee1f733f4c00cf76e85d9">gmx_wallcycle_t</a>&#160;</td>
          <td class="paramname"><em>wcycle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td>
          <td class="paramname"><em>bNS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculation of the enforced rotation potential. </p>
<p>This is the main enforced rotation module which is called during every time step. Here the rotation potential as well as the resulting forces are calculated.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">cr</td><td>Pointer to MPI communication data. </td></tr>
    <tr><td class="paramname">ir</td><td>Struct containing MD input parameters, among those </td></tr>
    <tr><td class="paramname">box</td><td>Simulation box, needed to make group whole. </td></tr>
    <tr><td class="paramname">x</td><td>The positions of all the local particles. </td></tr>
    <tr><td class="paramname">t</td><td>Time. </td></tr>
    <tr><td class="paramname">step</td><td>The time step. </td></tr>
    <tr><td class="paramname">wcycle</td><td>During the potential calculation the wallcycles are counted. Later they enter the dynamic load balancing. </td></tr>
    <tr><td class="paramname">bNS</td><td>After domain decomposition / neighborsearching several local arrays have to be updated (masses, shifts) </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="include_2pull__rotation_8h_a697bc400e3ddbdf1cbfc0037e03cbdca_icgraph.png" border="0" usemap="#include_2pull__rotation_8h_a697bc400e3ddbdf1cbfc0037e03cbdca_icgraph" alt=""/></div>
<map name="include_2pull__rotation_8h_a697bc400e3ddbdf1cbfc0037e03cbdca_icgraph" id="include_2pull__rotation_8h_a697bc400e3ddbdf1cbfc0037e03cbdca_icgraph">
<area shape="rect" id="node3" href="sim__util_8c.html#a1d3281248b5954a553f69210c9d0c64d" title="do_force_cutsGROUP" alt="" coords="143,112,295,141"/><area shape="rect" id="node5" href="sim__util_8c.html#ae84da958cc847100953511b93beace28" title="do_force" alt="" coords="344,112,416,141"/><area shape="rect" id="node7" href="md_8c.html#ab03e50f07db7a24087c44ccdce343305" title="do_md" alt="" coords="500,32,561,61"/><area shape="rect" id="node9" href="minimize_8c.html#aad33a4afc8acff28fd568113b6640cb6" title="evaluate_energy" alt="" coords="472,85,589,115"/><area shape="rect" id="node19" href="shellfc_8c.html#ab995a0cadc09ea92f161b56ece2eb639" title="relax_shell_flexcon" alt="" coords="464,139,597,168"/><area shape="rect" id="node21" href="tpi_8c.html#a85cdc1fc8f1c59d64289bfed1474523a" title="do_tpi" alt="" coords="503,192,559,221"/><area shape="rect" id="node11" href="minimize_8c.html#a94b84868513558ebf1b177f04c39d167" title="do_cg" alt="" coords="655,5,711,35"/><area shape="rect" id="node13" href="minimize_8c.html#a53d420a517454c935d80f0d4a8d31634" title="do_lbfgs" alt="" coords="648,59,717,88"/><area shape="rect" id="node15" href="minimize_8c.html#a684fce135fec8d36bbf9739a871c7607" title="do_steep" alt="" coords="645,112,720,141"/><area shape="rect" id="node17" href="minimize_8c.html#a26a93ab5eaa25efa390ade3b20be07d5" title="do_nm" alt="" coords="652,165,713,195"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a47520e0126d56a023bfb5a42c12f5403"></a><!-- doxytag: member="pull_rotation.h::finish_rot" ref="a47520e0126d56a023bfb5a42c12f5403" args="(FILE *fplog, t_rot *rot)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="share_2template_2gromacs_2visibility_8h.html#ab80ef94c2b909a1a948639e98e63b612">GMX_LIBMD_EXPORT</a> <a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a> <a class="el" href="pull__rotation_8c.html#a5b83e8205aab6c133b1afb3d009c8218">finish_rot</a> </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fplog</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__rot.html">t_rot</a> *&#160;</td>
          <td class="paramname"><em>rot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Close the enforced rotation output files. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fplog</td><td>General output file, normally md.log. </td></tr>
    <tr><td class="paramname">rot</td><td>Pointer to all the enforced rotation data. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="include_2pull__rotation_8h_a47520e0126d56a023bfb5a42c12f5403_icgraph.png" border="0" usemap="#include_2pull__rotation_8h_a47520e0126d56a023bfb5a42c12f5403_icgraph" alt=""/></div>
<map name="include_2pull__rotation_8h_a47520e0126d56a023bfb5a42c12f5403_icgraph" id="include_2pull__rotation_8h_a47520e0126d56a023bfb5a42c12f5403_icgraph">
<area shape="rect" id="node3" href="runner__openmm_8c.html#a1c2f054bfc5afc44cd980cf25546190d" title="mdrunner" alt="" coords="129,5,204,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa078f96c50103aec325b6a554c5f0eb5"></a><!-- doxytag: member="pull_rotation.h::init_rot" ref="aa078f96c50103aec325b6a554c5f0eb5" args="(FILE *fplog, t_inputrec *ir, int nfile, const t_filenm fnm[], t_commrec *cr, rvec *x, matrix box, gmx_mtop_t *mtop, const output_env_t oenv, gmx_bool bVerbose, unsigned long Flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="share_2template_2gromacs_2visibility_8h.html#ab80ef94c2b909a1a948639e98e63b612">GMX_LIBMD_EXPORT</a> <a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a> <a class="el" href="pull__rotation_8c.html#a6c62c69ba660120e6c6d5c7092fc55e7">init_rot</a> </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fplog</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__inputrec.html">t_inputrec</a> *&#160;</td>
          <td class="paramname"><em>ir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structt__filenm.html">t_filenm</a>&#160;</td>
          <td class="paramname"><em>fnm</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__commrec.html">t_commrec</a> *&#160;</td>
          <td class="paramname"><em>cr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#a7ea9c2a830d3f743b887387e33645a83">matrix</a>&#160;</td>
          <td class="paramname"><em>box</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgmx__mtop__t.html">gmx_mtop_t</a> *&#160;</td>
          <td class="paramname"><em>mtop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="include_2types_2oenv_8h.html#a6a48d77d95132d7318780544821da6a5">output_env_t</a>&#160;</td>
          <td class="paramname"><em>oenv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td>
          <td class="paramname"><em>bVerbose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>Flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize the enforced rotation groups. </p>
<p>This routine does the memory allocation for various helper arrays, opens the output files etc.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fplog</td><td>General output file, normally md.log. </td></tr>
    <tr><td class="paramname">ir</td><td>Struct containing MD input parameters, among those also the enforced rotation parameters. </td></tr>
    <tr><td class="paramname">nfile</td><td>Number of entries in the fnm structure. </td></tr>
    <tr><td class="paramname">fnm</td><td>The filenames struct containing also the names of the rotation output files. </td></tr>
    <tr><td class="paramname">cr</td><td>Pointer to MPI communication data. </td></tr>
    <tr><td class="paramname">x</td><td>The positions of all MD particles. </td></tr>
    <tr><td class="paramname">mtop</td><td>Molecular topology. </td></tr>
    <tr><td class="paramname">oenv</td><td>Needed to open the rotation output xvgr file. </td></tr>
    <tr><td class="paramname">Flags</td><td>Flags passed over from main, used to determine whether or not we are doing a rerun. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="include_2pull__rotation_8h_aa078f96c50103aec325b6a554c5f0eb5_icgraph.png" border="0" usemap="#include_2pull__rotation_8h_aa078f96c50103aec325b6a554c5f0eb5_icgraph" alt=""/></div>
<map name="include_2pull__rotation_8h_aa078f96c50103aec325b6a554c5f0eb5_icgraph" id="include_2pull__rotation_8h_aa078f96c50103aec325b6a554c5f0eb5_icgraph">
<area shape="rect" id="node3" href="runner__openmm_8c.html#a1c2f054bfc5afc44cd980cf25546190d" title="mdrunner" alt="" coords="116,5,191,35"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Sat Dec 20 2014 17:22:24 for My Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
