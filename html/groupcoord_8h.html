<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>My Project: src/mdlib/groupcoord.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">src/mdlib/groupcoord.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Assemble atom positions for comparison with a reference set.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &quot;typedefs.h&quot;</code><br/>
<code>#include &quot;types/commrec.h&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for groupcoord.h:</div>
<div class="dyncontent">
<div class="center"><img src="groupcoord_8h__incl.png" border="0" usemap="#src_2mdlib_2groupcoord_8h" alt=""/></div>
<map name="src_2mdlib_2groupcoord_8h" id="src_2mdlib_2groupcoord_8h">
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="groupcoord_8h__dep__incl.png" border="0" usemap="#src_2mdlib_2groupcoord_8hdep" alt=""/></div>
<map name="src_2mdlib_2groupcoord_8hdep" id="src_2mdlib_2groupcoord_8hdep">
<area shape="rect" id="node3" href="edsam_8c.html" title="src/mdlib/edsam.c" alt="" coords="5,83,133,112"/><area shape="rect" id="node5" href="groupcoord_8c.html" title="src/mdlib/groupcoord.c" alt="" coords="157,83,312,112"/><area shape="rect" id="node7" href="pull__rotation_8c.html" title="src/mdlib/pull_rotation.c" alt="" coords="336,83,496,112"/></map>
</div>
</div>
<p><a href="groupcoord_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="groupcoord_8h.html#ad02da958f7cd0f75e0533dc5052b277b">dd_make_local_group_indices</a> (<a class="el" href="include_2types_2commrec_8h.html#afc231fdc02683c223ce94b6dee2a0e46">gmx_ga2la_t</a> ga2la, const int <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a560e4062098f77c2d7e5fe83bf09c394">nr</a>, int anrs[], int *nr_loc, int *anrs_loc[], int *nalloc_loc, int coll_ind[])</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Select local atoms of a group.  <a href="#ad02da958f7cd0f75e0533dc5052b277b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="groupcoord_8h.html#a20467c38340aadf3f059e16f12670109">communicate_group_positions</a> (<a class="el" href="structt__commrec.html">t_commrec</a> *cr, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> *xcoll, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#a74f6ffdb4a9c1764f5293969d8c681b6">ivec</a> *shifts, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#a74f6ffdb4a9c1764f5293969d8c681b6">ivec</a> *extra_shifts, const <a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> bNS, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> *x_loc, const int <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a560e4062098f77c2d7e5fe83bf09c394">nr</a>, const int nr_loc, int *anrs_loc, int *coll_ind, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> *xcoll_old, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#a7ea9c2a830d3f743b887387e33645a83">matrix</a> box)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Assemble local positions into a collective array present on all nodes.  <a href="#a20467c38340aadf3f059e16f12670109"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="groupcoord_8h.html#ade257f0bec734eec877f8dde10926aba">get_center</a> (<a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], real weight[], const int <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a560e4062098f77c2d7e5fe83bf09c394">nr</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> center)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the center of the positions x locally.  <a href="#ade257f0bec734eec877f8dde10926aba"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="groupcoord_8h.html#aa094e1b1d1067fc15558e2aa169f99a0">get_sum_of_positions</a> (<a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], real weight[], const int <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a560e4062098f77c2d7e5fe83bf09c394">nr</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#ac3f526097e99b43b9962d8676756017d">dvec</a> dsumvec)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the sum of the positions x locally.  <a href="#aa094e1b1d1067fc15558e2aa169f99a0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="groupcoord_8h.html#a05a0f3b223b46ce34e8470d5e13a4e5c">get_center_comm</a> (<a class="el" href="structt__commrec.html">t_commrec</a> *cr, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> x_loc[], real weight_loc[], int nr_loc, int nr_group, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> center)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the global center of all local arrays x.  <a href="#a05a0f3b223b46ce34e8470d5e13a4e5c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="groupcoord_8h.html#aa739dbdc71986caa8bcbcda9009778ff">translate_x</a> (<a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], const int <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a560e4062098f77c2d7e5fe83bf09c394">nr</a>, const <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> transvec)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Translate positions.  <a href="#aa739dbdc71986caa8bcbcda9009778ff"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="groupcoord_8h.html#a918543f4782aca4196ce2a5cc6a3272a">rotate_x</a> (<a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], const int <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a560e4062098f77c2d7e5fe83bf09c394">nr</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#a7ea9c2a830d3f743b887387e33645a83">matrix</a> rmat)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate positions.  <a href="#a918543f4782aca4196ce2a5cc6a3272a"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Assemble atom positions for comparison with a reference set. </p>
<p>This file contains functions to assemble the positions of a subset of the atoms and to do operations on it like determining the center of mass, or doing translations and rotations. These functions are useful when a subset of the positions needs to be compared to some set of reference positions, as e.g. done for essential dynamics. </p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a20467c38340aadf3f059e16f12670109"></a><!-- doxytag: member="groupcoord.h::communicate_group_positions" ref="a20467c38340aadf3f059e16f12670109" args="(t_commrec *cr, rvec *xcoll, ivec *shifts, ivec *extra_shifts, const gmx_bool bNS, rvec *x_loc, const int nr, const int nr_loc, int *anrs_loc, int *coll_ind, rvec *xcoll_old, matrix box)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a> <a class="el" href="groupcoord_8h.html#a20467c38340aadf3f059e16f12670109">communicate_group_positions</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__commrec.html">t_commrec</a> *&#160;</td>
          <td class="paramname"><em>cr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> *&#160;</td>
          <td class="paramname"><em>xcoll</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#a74f6ffdb4a9c1764f5293969d8c681b6">ivec</a> *&#160;</td>
          <td class="paramname"><em>shifts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#a74f6ffdb4a9c1764f5293969d8c681b6">ivec</a> *&#160;</td>
          <td class="paramname"><em>extra_shifts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td>
          <td class="paramname"><em>bNS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> *&#160;</td>
          <td class="paramname"><em>x_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nr_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>anrs_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>coll_ind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> *&#160;</td>
          <td class="paramname"><em>xcoll_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#a7ea9c2a830d3f743b887387e33645a83">matrix</a>&#160;</td>
          <td class="paramname"><em>box</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Assemble local positions into a collective array present on all nodes. </p>
<p>Communicate the positions of the group's atoms such that every node has all of them. Unless running on huge number of cores, this is not a big performance impact as long as the collective subset [0..nr] is kept small. The atom indices are retrieved from anrs_loc[0..nr_loc]. If you call the routine for the serial case, provide an array coll_ind[i] = i for i in 1..nr.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">cr[in]</td><td>Pointer to MPI communication data. </td></tr>
    <tr><td class="paramname">xcoll[out]</td><td>Collective array of positions, idential on all nodes after this routine has been called. </td></tr>
    <tr><td class="paramname">shifts[inout]</td><td>Collective array of shifts for xcoll, needed to make the group whole. This array remembers the shifts since the start of the simulation (where the group is whole) and must therefore not be changed outside of this routine! </td></tr>
    <tr><td class="paramname">extra_shifts[buf]</td><td>Extra shifts since last time step, only needed as buffer variable [0..nr]. </td></tr>
    <tr><td class="paramname">bNS[in]</td><td>Neighborsearching/domain redecomposition has been performed at the begin of this time step such that the shifts have changed and need to be updated. </td></tr>
    <tr><td class="paramname">x_loc[in]</td><td>Pointer to the local atom positions this node has. </td></tr>
    <tr><td class="paramname">nr[in]</td><td>Total number of atoms in the group. </td></tr>
    <tr><td class="paramname">nr_loc[in]</td><td>Number of group atoms on the local node. </td></tr>
    <tr><td class="paramname">anrs_loc[in]</td><td>Array of the local atom indices. </td></tr>
    <tr><td class="paramname">coll_ind[in]</td><td>This array of size nr stores for each local atom where it belongs in the collective array so that the local contributions can be gmx_summed. It is provided by dd_make_local_group_indices. </td></tr>
    <tr><td class="paramname">xcoll_old[inout]</td><td>Positions from the last time step, used to make the group whole. </td></tr>
    <tr><td class="paramname">box[in]</td><td>Simulation box matrix, needed to shift xcoll such that the group becomes whole. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="groupcoord_8h_a20467c38340aadf3f059e16f12670109_cgraph.png" border="0" usemap="#groupcoord_8h_a20467c38340aadf3f059e16f12670109_cgraph" alt=""/></div>
<map name="groupcoord_8h_a20467c38340aadf3f059e16f12670109_cgraph" id="groupcoord_8h_a20467c38340aadf3f059e16f12670109_cgraph">
<area shape="rect" id="node3" href="include_2vec_8h.html#aec4ae0c9224a70f28af3dc5181f2950e" title="clear_rvecs" alt="" coords="283,5,371,35"/><area shape="rect" id="node7" href="include_2vec_8h.html#abed978b9186481e940dc0a059f948baf" title="copy_rvec" alt="" coords="285,59,368,88"/><area shape="rect" id="node9" href="groupcoord_8c.html#a08f7a4658a4501a76617e3f09adf843b" title="shift_positions_group" alt="" coords="255,112,399,141"/><area shape="rect" id="node11" href="groupcoord_8c.html#ae4d8f19f2b5baff3f20e5468be29aae7" title="get_shifts_group" alt="" coords="268,165,385,195"/><area shape="rect" id="node5" href="include_2vec_8h.html#afcff0f0d52146c7d16ca019707d24b05" title="clear_rvec" alt="" coords="448,5,531,35"/><area shape="rect" id="node13" href="include_2vec_8h.html#af07b59e747fb877076d9f13d2c2e44a7" title="clear_ivec" alt="" coords="449,139,529,168"/><area shape="rect" id="node15" href="include_2vec_8h.html#aa42bdc6353729bddfb2cb149a3ae3652" title="rvec_sub" alt="" coords="452,192,527,221"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="groupcoord_8h_a20467c38340aadf3f059e16f12670109_icgraph.png" border="0" usemap="#groupcoord_8h_a20467c38340aadf3f059e16f12670109_icgraph" alt=""/></div>
<map name="groupcoord_8h_a20467c38340aadf3f059e16f12670109_icgraph" id="groupcoord_8h_a20467c38340aadf3f059e16f12670109_icgraph">
<area shape="rect" id="node3" href="edsam_8c.html#ae66923390c3e62ad94ad92264ed0220d" title="do_single_flood" alt="" coords="253,85,365,115"/><area shape="rect" id="node30" href="edsam_8c.html#a14f16676bee65b22fa373ee0a0cac80a" title="do_edsam" alt="" coords="268,139,351,168"/><area shape="rect" id="node34" href="pull__rotation_8c.html#a697bc400e3ddbdf1cbfc0037e03cbdca" title="Calculation of the enforced rotation potential." alt="" coords="415,192,500,221"/><area shape="rect" id="node5" href="edsam_8c.html#a1774ffce043cc82bd18fc9c9d8884273" title="do_flood" alt="" coords="423,85,492,115"/><area shape="rect" id="node7" href="sim__util_8c.html#aebeca502354732c126db3e81220059a4" title="do_force_cutsVERLET" alt="" coords="551,85,705,115"/><area shape="rect" id="node27" href="sim__util_8c.html#a1d3281248b5954a553f69210c9d0c64d" title="do_force_cutsGROUP" alt="" coords="552,139,704,168"/><area shape="rect" id="node9" href="sim__util_8c.html#ae84da958cc847100953511b93beace28" title="do_force" alt="" coords="755,112,827,141"/><area shape="rect" id="node11" href="md_8c.html#ab03e50f07db7a24087c44ccdce343305" title="do_md" alt="" coords="911,32,972,61"/><area shape="rect" id="node13" href="minimize_8c.html#aad33a4afc8acff28fd568113b6640cb6" title="evaluate_energy" alt="" coords="883,85,1000,115"/><area shape="rect" id="node23" href="shellfc_8c.html#ab995a0cadc09ea92f161b56ece2eb639" title="relax_shell_flexcon" alt="" coords="875,139,1008,168"/><area shape="rect" id="node25" href="tpi_8c.html#a85cdc1fc8f1c59d64289bfed1474523a" title="do_tpi" alt="" coords="913,192,969,221"/><area shape="rect" id="node15" href="minimize_8c.html#a94b84868513558ebf1b177f04c39d167" title="do_cg" alt="" coords="1065,5,1121,35"/><area shape="rect" id="node17" href="minimize_8c.html#a53d420a517454c935d80f0d4a8d31634" title="do_lbfgs" alt="" coords="1059,59,1128,88"/><area shape="rect" id="node19" href="minimize_8c.html#a684fce135fec8d36bbf9739a871c7607" title="do_steep" alt="" coords="1056,112,1131,141"/><area shape="rect" id="node21" href="minimize_8c.html#a26a93ab5eaa25efa390ade3b20be07d5" title="do_nm" alt="" coords="1063,165,1124,195"/><area shape="rect" id="node32" href="constr_8c.html#af8c58c3a20b512808951b711bfc76394" title="constrain" alt="" coords="420,139,495,168"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad02da958f7cd0f75e0533dc5052b277b"></a><!-- doxytag: member="groupcoord.h::dd_make_local_group_indices" ref="ad02da958f7cd0f75e0533dc5052b277b" args="(gmx_ga2la_t ga2la, const int nr, int anrs[], int *nr_loc, int *anrs_loc[], int *nalloc_loc, int coll_ind[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a> <a class="el" href="groupcoord_8h.html#ad02da958f7cd0f75e0533dc5052b277b">dd_make_local_group_indices</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="include_2types_2commrec_8h.html#afc231fdc02683c223ce94b6dee2a0e46">gmx_ga2la_t</a>&#160;</td>
          <td class="paramname"><em>ga2la</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>anrs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nr_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>anrs_loc</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nalloc_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>coll_ind</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Select local atoms of a group. </p>
<p>Selects the indices of local atoms of a group and stores them in anrs_loc[0..nr_loc]. If you need the positions of the group's atoms on all nodes, provide a coll_ind[0..nr] array and pass it on to communicate_group_positions. Thus the collective array will always have the same atom order (ascending indices).</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ga2la[in]</td><td>Global to local atom index conversion data. </td></tr>
    <tr><td class="paramname">nr[in]</td><td>The total number of atoms that the group contains. </td></tr>
    <tr><td class="paramname">anrs[in]</td><td>The global atom number of the group's atoms. </td></tr>
    <tr><td class="paramname">nr_loc[out]</td><td>The number of group atoms present on the local node. </td></tr>
    <tr><td class="paramname">anrs_loc[out]</td><td>The local atom numbers of the group. </td></tr>
    <tr><td class="paramname">nalloc_loc[inout]</td><td>Local allocation size of anrs_loc array. </td></tr>
    <tr><td class="paramname">coll_ind[opt]</td><td>If not NULL this array must be of size nr. It stores for each local atom where it belongs in the global (collective) array such that it can be gmx_summed in the communicate_group_positions routine. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="groupcoord_8h_ad02da958f7cd0f75e0533dc5052b277b_cgraph.png" border="0" usemap="#groupcoord_8h_ad02da958f7cd0f75e0533dc5052b277b_cgraph" alt=""/></div>
<map name="groupcoord_8h_ad02da958f7cd0f75e0533dc5052b277b_cgraph" id="groupcoord_8h_ad02da958f7cd0f75e0533dc5052b277b_cgraph">
<area shape="rect" id="node3" href="include_2gmx__ga2la_8h.html#a08748d2b3c1848c86d38fc6f6f08a4b1" title="ga2la_get_home" alt="" coords="251,5,368,35"/><area shape="rect" id="node5" href="include_2typedefs_8h.html#ab18fdd7de6fc645126f004d17a8b7811" title="over_alloc_dd" alt="" coords="259,59,360,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="groupcoord_8h_ad02da958f7cd0f75e0533dc5052b277b_icgraph.png" border="0" usemap="#groupcoord_8h_ad02da958f7cd0f75e0533dc5052b277b_icgraph" alt=""/></div>
<map name="groupcoord_8h_ad02da958f7cd0f75e0533dc5052b277b_icgraph" id="groupcoord_8h_ad02da958f7cd0f75e0533dc5052b277b_icgraph">
<area shape="rect" id="node3" href="edsam_8c.html#a3c895e322f5f64b1c3672ec7e3a56d72" title="dd_make_local_ed_indices" alt="" coords="264,7,443,36"/><area shape="rect" id="node5" href="pull__rotation_8c.html#aa4961bfc9547fb230b5c746a96d46967" title="Make a selection of the home atoms for all enforced rotation groups." alt="" coords="251,60,456,89"/><area shape="rect" id="node7" href="domdec_8c.html#ad9975f2c1f834b25a14c3ff65932474f" title="dd_partition_system" alt="" coords="504,60,643,89"/><area shape="rect" id="node9" href="md_8c.html#ab03e50f07db7a24087c44ccdce343305" title="do_md" alt="" coords="743,7,804,36"/><area shape="rect" id="node11" href="minimize_8c.html#a9c79930a574d848d46ab1a4c9bbb9c43" title="init_em" alt="" coords="931,112,995,141"/><area shape="rect" id="node21" href="minimize_8c.html#adce4401383f53969c3073b7362e36ec5" title="em_dd_partition_system" alt="" coords="692,60,855,89"/><area shape="rect" id="node13" href="minimize_8c.html#a94b84868513558ebf1b177f04c39d167" title="do_cg" alt="" coords="1079,5,1135,35"/><area shape="rect" id="node15" href="minimize_8c.html#a53d420a517454c935d80f0d4a8d31634" title="do_lbfgs" alt="" coords="1072,59,1141,88"/><area shape="rect" id="node17" href="minimize_8c.html#a684fce135fec8d36bbf9739a871c7607" title="do_steep" alt="" coords="1069,165,1144,195"/><area shape="rect" id="node19" href="minimize_8c.html#a26a93ab5eaa25efa390ade3b20be07d5" title="do_nm" alt="" coords="1076,112,1137,141"/><area shape="rect" id="node23" href="minimize_8c.html#aad33a4afc8acff28fd568113b6640cb6" title="evaluate_energy" alt="" coords="904,59,1021,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ade257f0bec734eec877f8dde10926aba"></a><!-- doxytag: member="groupcoord.h::get_center" ref="ade257f0bec734eec877f8dde10926aba" args="(rvec x[], real weight[], const int nr, rvec center)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a> <a class="el" href="groupcoord_8h.html#ade257f0bec734eec877f8dde10926aba">get_center</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>weight</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates the center of the positions x locally. </p>
<p>Calculates the center of mass (if masses are given in the weight array) or the geometrical center (if NULL is passed as weight).</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">x[in]</td><td>Positions. </td></tr>
    <tr><td class="paramname">weight[in]</td><td>Can be NULL or an array of weights. If masses are given as weights, the COM is calculated. </td></tr>
    <tr><td class="paramname">nr[in]</td><td>Number of positions and weights if present. </td></tr>
    <tr><td class="paramname">center[out]</td><td>The (weighted) center of the positions. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="groupcoord_8h_ade257f0bec734eec877f8dde10926aba_cgraph.png" border="0" usemap="#groupcoord_8h_ade257f0bec734eec877f8dde10926aba_cgraph" alt=""/></div>
<map name="groupcoord_8h_ade257f0bec734eec877f8dde10926aba_cgraph" id="groupcoord_8h_ade257f0bec734eec877f8dde10926aba_cgraph">
<area shape="rect" id="node3" href="groupcoord_8c.html#a19f3fb1e455ae9fb5fa23da901968911" title="Calculates the sum of the positions x locally." alt="" coords="136,32,285,61"/><area shape="rect" id="node9" href="include_2vec_8h.html#a2c6401caad42fd39e9642d97d9b300e9" title="dsvmul" alt="" coords="179,85,243,115"/><area shape="rect" id="node5" href="include_2vec_8h.html#a3fd54b0b94a40e03e97a33435bc27507" title="clear_dvec" alt="" coords="333,5,419,35"/><area shape="rect" id="node7" href="include_2vec_8h.html#a6a437400111a6ffdb6085571c6e9b530" title="svmul" alt="" coords="348,59,404,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="groupcoord_8h_ade257f0bec734eec877f8dde10926aba_icgraph.png" border="0" usemap="#groupcoord_8h_ade257f0bec734eec877f8dde10926aba_icgraph" alt=""/></div>
<map name="groupcoord_8h_ade257f0bec734eec877f8dde10926aba_icgraph" id="groupcoord_8h_ade257f0bec734eec877f8dde10926aba_icgraph">
<area shape="rect" id="node3" href="edsam_8c.html#a218f649ae5b4709e023aa17a3c78227c" title="init_edi" alt="" coords="180,32,241,61"/><area shape="rect" id="node11" href="edsam_8c.html#ad7ac552e63d90b8a5c264dc49da3cdd8" title="fit_to_reference" alt="" coords="155,137,267,167"/><area shape="rect" id="node45" href="pull__rotation_8c.html#af67134d8db7183fccd7a5627d6b18cfd" title="flex_fit_angle" alt="" coords="161,373,260,403"/><area shape="rect" id="node49" href="pull__rotation_8c.html#a697bc400e3ddbdf1cbfc0037e03cbdca" title="Calculation of the enforced rotation potential." alt="" coords="533,268,619,297"/><area shape="rect" id="node52" href="pull__rotation_8c.html#a80f752c0bc92a00b32f6d1f31efd4e2e" title="flex_fit_angle_perslab" alt="" coords="137,320,284,349"/><area shape="rect" id="node55" href="pull__rotation_8c.html#ae4dc0fba73dfb1f11de070196b1c1f78" title="do_radial_motion_pf" alt="" coords="333,399,472,428"/><area shape="rect" id="node58" href="pull__rotation_8c.html#a0fd041b01eadf5d5e10930cf30ff1787" title="do_radial_motion2" alt="" coords="148,216,273,245"/><area shape="rect" id="node61" href="pull__rotation_8c.html#a1d2cf00ce89bc00d56831f827f9d77cc" title="init_rot_group" alt="" coords="353,59,452,88"/><area shape="rect" id="node5" href="edsam_8c.html#af9beb797572c126058d1a6d0a148db9c" title="init_edsam" alt="" coords="360,5,445,35"/><area shape="rect" id="node7" href="constr_8c.html#ade24bc7be86c9273e62da9f54dd2947e" title="init_constraints" alt="" coords="521,5,631,35"/><area shape="rect" id="node9" href="runner__openmm_8c.html#a1c2f054bfc5afc44cd980cf25546190d" title="mdrunner" alt="" coords="721,32,796,61"/><area shape="rect" id="node13" href="edsam_8c.html#ae66923390c3e62ad94ad92264ed0220d" title="do_single_flood" alt="" coords="347,112,459,141"/><area shape="rect" id="node41" href="edsam_8c.html#a14f16676bee65b22fa373ee0a0cac80a" title="do_edsam" alt="" coords="361,165,444,195"/><area shape="rect" id="node15" href="edsam_8c.html#a1774ffce043cc82bd18fc9c9d8884273" title="do_flood" alt="" coords="541,112,611,141"/><area shape="rect" id="node17" href="sim__util_8c.html#aebeca502354732c126db3e81220059a4" title="do_force_cutsVERLET" alt="" coords="681,112,836,141"/><area shape="rect" id="node37" href="sim__util_8c.html#a1d3281248b5954a553f69210c9d0c64d" title="do_force_cutsGROUP" alt="" coords="683,165,835,195"/><area shape="rect" id="node19" href="sim__util_8c.html#ae84da958cc847100953511b93beace28" title="do_force" alt="" coords="885,139,957,168"/><area shape="rect" id="node21" href="md_8c.html#ab03e50f07db7a24087c44ccdce343305" title="do_md" alt="" coords="1041,59,1103,88"/><area shape="rect" id="node23" href="minimize_8c.html#aad33a4afc8acff28fd568113b6640cb6" title="evaluate_energy" alt="" coords="1013,112,1131,141"/><area shape="rect" id="node33" href="shellfc_8c.html#ab995a0cadc09ea92f161b56ece2eb639" title="relax_shell_flexcon" alt="" coords="1005,165,1139,195"/><area shape="rect" id="node35" href="tpi_8c.html#a85cdc1fc8f1c59d64289bfed1474523a" title="do_tpi" alt="" coords="1044,219,1100,248"/><area shape="rect" id="node25" href="minimize_8c.html#a94b84868513558ebf1b177f04c39d167" title="do_cg" alt="" coords="1196,32,1252,61"/><area shape="rect" id="node27" href="minimize_8c.html#a53d420a517454c935d80f0d4a8d31634" title="do_lbfgs" alt="" coords="1189,85,1259,115"/><area shape="rect" id="node29" href="minimize_8c.html#a684fce135fec8d36bbf9739a871c7607" title="do_steep" alt="" coords="1187,139,1261,168"/><area shape="rect" id="node31" href="minimize_8c.html#a26a93ab5eaa25efa390ade3b20be07d5" title="do_nm" alt="" coords="1193,192,1255,221"/><area shape="rect" id="node43" href="constr_8c.html#af8c58c3a20b512808951b711bfc76394" title="constrain" alt="" coords="539,165,613,195"/><area shape="rect" id="node47" href="pull__rotation_8c.html#a193fc60f86d5ff4b8951eb227bafcc8e" title="do_flexible" alt="" coords="361,320,444,349"/><area shape="rect" id="node63" href="pull__rotation_8c.html#a6c62c69ba660120e6c6d5c7092fc55e7" title="Initialize the enforced rotation groups." alt="" coords="545,59,607,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a05a0f3b223b46ce34e8470d5e13a4e5c"></a><!-- doxytag: member="groupcoord.h::get_center_comm" ref="a05a0f3b223b46ce34e8470d5e13a4e5c" args="(t_commrec *cr, rvec x_loc[], real weight_loc[], int nr_loc, int nr_group, rvec center)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a> <a class="el" href="groupcoord_8h.html#a05a0f3b223b46ce34e8470d5e13a4e5c">get_center_comm</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__commrec.html">t_commrec</a> *&#160;</td>
          <td class="paramname"><em>cr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x_loc</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>weight_loc</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nr_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nr_group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates the global center of all local arrays x. </p>
<p>Get the center from local positions [0..nr_loc], this involves communication. Not that the positions must already have the correct PBC representation. Use this routine if no collective coordinates are assembled from which the center could be calculated without communication.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">cr[in]</td><td>Pointer to MPI communication data. </td></tr>
    <tr><td class="paramname">x_loc[in]</td><td>Array of local positions [0..nr_loc]. </td></tr>
    <tr><td class="paramname">weight_loc[in]</td><td>Array of local weights, these are the masses if the center of mass is to be calculated. </td></tr>
    <tr><td class="paramname">nr_loc[in]</td><td>The number of positions on the local node. </td></tr>
    <tr><td class="paramname">nr_group[in]</td><td>The number of positions in the whole group. Since this is known anyway, we do not need to communicate and sum nr_loc if we pass it over. </td></tr>
    <tr><td class="paramname">center[out]</td><td>The (weighted) center of all x_loc from all the nodes. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="groupcoord_8h_a05a0f3b223b46ce34e8470d5e13a4e5c_cgraph.png" border="0" usemap="#groupcoord_8h_a05a0f3b223b46ce34e8470d5e13a4e5c_cgraph" alt=""/></div>
<map name="groupcoord_8h_a05a0f3b223b46ce34e8470d5e13a4e5c_cgraph" id="groupcoord_8h_a05a0f3b223b46ce34e8470d5e13a4e5c_cgraph">
<area shape="rect" id="node3" href="groupcoord_8c.html#a19f3fb1e455ae9fb5fa23da901968911" title="Calculates the sum of the positions x locally." alt="" coords="181,32,331,61"/><area shape="rect" id="node9" href="include_2network_8h.html#ad7c7b1284e2c50b9e9fb20a9be90eaa9" title="gmx_sumd" alt="" coords="213,85,299,115"/><area shape="rect" id="node5" href="include_2vec_8h.html#a3fd54b0b94a40e03e97a33435bc27507" title="clear_dvec" alt="" coords="379,5,464,35"/><area shape="rect" id="node7" href="include_2vec_8h.html#a6a437400111a6ffdb6085571c6e9b530" title="svmul" alt="" coords="393,59,449,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="groupcoord_8h_a05a0f3b223b46ce34e8470d5e13a4e5c_icgraph.png" border="0" usemap="#groupcoord_8h_a05a0f3b223b46ce34e8470d5e13a4e5c_icgraph" alt=""/></div>
<map name="groupcoord_8h_a05a0f3b223b46ce34e8470d5e13a4e5c_icgraph" id="groupcoord_8h_a05a0f3b223b46ce34e8470d5e13a4e5c_icgraph">
<area shape="rect" id="node3" href="pull__rotation_8c.html#a697bc400e3ddbdf1cbfc0037e03cbdca" title="Calculation of the enforced rotation potential." alt="" coords="183,112,268,141"/><area shape="rect" id="node5" href="sim__util_8c.html#a1d3281248b5954a553f69210c9d0c64d" title="do_force_cutsGROUP" alt="" coords="319,112,471,141"/><area shape="rect" id="node7" href="sim__util_8c.html#ae84da958cc847100953511b93beace28" title="do_force" alt="" coords="520,112,592,141"/><area shape="rect" id="node9" href="md_8c.html#ab03e50f07db7a24087c44ccdce343305" title="do_md" alt="" coords="676,32,737,61"/><area shape="rect" id="node11" href="minimize_8c.html#aad33a4afc8acff28fd568113b6640cb6" title="evaluate_energy" alt="" coords="648,85,765,115"/><area shape="rect" id="node21" href="shellfc_8c.html#ab995a0cadc09ea92f161b56ece2eb639" title="relax_shell_flexcon" alt="" coords="640,139,773,168"/><area shape="rect" id="node23" href="tpi_8c.html#a85cdc1fc8f1c59d64289bfed1474523a" title="do_tpi" alt="" coords="679,192,735,221"/><area shape="rect" id="node13" href="minimize_8c.html#a94b84868513558ebf1b177f04c39d167" title="do_cg" alt="" coords="831,5,887,35"/><area shape="rect" id="node15" href="minimize_8c.html#a53d420a517454c935d80f0d4a8d31634" title="do_lbfgs" alt="" coords="824,59,893,88"/><area shape="rect" id="node17" href="minimize_8c.html#a684fce135fec8d36bbf9739a871c7607" title="do_steep" alt="" coords="821,112,896,141"/><area shape="rect" id="node19" href="minimize_8c.html#a26a93ab5eaa25efa390ade3b20be07d5" title="do_nm" alt="" coords="828,165,889,195"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa094e1b1d1067fc15558e2aa169f99a0"></a><!-- doxytag: member="groupcoord.h::get_sum_of_positions" ref="aa094e1b1d1067fc15558e2aa169f99a0" args="(rvec x[], real weight[], const int nr, dvec dsumvec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="groupcoord_8h.html#aa094e1b1d1067fc15558e2aa169f99a0">get_sum_of_positions</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>weight</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#ac3f526097e99b43b9962d8676756017d">dvec</a>&#160;</td>
          <td class="paramname"><em>dsumvec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates the sum of the positions x locally. </p>
<p>Calculates the (weighted) sum of position vectors and returns the sum of weights, which is needed when local contributions shall be summed to a global weighted center.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">x[in]</td><td>Array of positions. </td></tr>
    <tr><td class="paramname">weight[in]</td><td>Can be NULL or an array of weights. </td></tr>
    <tr><td class="paramname">nr[in]</td><td>Number of positions and weights if present. </td></tr>
    <tr><td class="paramname">dsumvec[out]</td><td>The (weighted) sum of the positions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Sum of weights. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="groupcoord_8h_aa094e1b1d1067fc15558e2aa169f99a0_cgraph.png" border="0" usemap="#groupcoord_8h_aa094e1b1d1067fc15558e2aa169f99a0_cgraph" alt=""/></div>
<map name="groupcoord_8h_aa094e1b1d1067fc15558e2aa169f99a0_cgraph" id="groupcoord_8h_aa094e1b1d1067fc15558e2aa169f99a0_cgraph">
<area shape="rect" id="node3" href="include_2vec_8h.html#a3fd54b0b94a40e03e97a33435bc27507" title="clear_dvec" alt="" coords="203,5,288,35"/><area shape="rect" id="node5" href="include_2vec_8h.html#a6a437400111a6ffdb6085571c6e9b530" title="svmul" alt="" coords="217,59,273,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="groupcoord_8h_aa094e1b1d1067fc15558e2aa169f99a0_icgraph.png" border="0" usemap="#groupcoord_8h_aa094e1b1d1067fc15558e2aa169f99a0_icgraph" alt=""/></div>
<map name="groupcoord_8h_aa094e1b1d1067fc15558e2aa169f99a0_icgraph" id="groupcoord_8h_aa094e1b1d1067fc15558e2aa169f99a0_icgraph">
<area shape="rect" id="node3" href="groupcoord_8h.html#ade257f0bec734eec877f8dde10926aba" title="Calculates the center of the positions x locally." alt="" coords="225,219,308,248"/><area shape="rect" id="node69" href="groupcoord_8h.html#a05a0f3b223b46ce34e8470d5e13a4e5c" title="Calculates the global center of all local arrays x." alt="" coords="204,348,329,377"/><area shape="rect" id="node5" href="edsam_8c.html#a218f649ae5b4709e023aa17a3c78227c" title="init_edi" alt="" coords="423,59,484,88"/><area shape="rect" id="node13" href="edsam_8c.html#ad7ac552e63d90b8a5c264dc49da3cdd8" title="fit_to_reference" alt="" coords="397,112,509,141"/><area shape="rect" id="node47" href="pull__rotation_8c.html#af67134d8db7183fccd7a5627d6b18cfd" title="flex_fit_angle" alt="" coords="404,165,503,195"/><area shape="rect" id="node51" href="pull__rotation_8c.html#a697bc400e3ddbdf1cbfc0037e03cbdca" title="Calculation of the enforced rotation potential." alt="" coords="776,297,861,327"/><area shape="rect" id="node54" href="pull__rotation_8c.html#a80f752c0bc92a00b32f6d1f31efd4e2e" title="flex_fit_angle_perslab" alt="" coords="380,219,527,248"/><area shape="rect" id="node57" href="pull__rotation_8c.html#ae4dc0fba73dfb1f11de070196b1c1f78" title="do_radial_motion_pf" alt="" coords="576,323,715,352"/><area shape="rect" id="node60" href="pull__rotation_8c.html#a0fd041b01eadf5d5e10930cf30ff1787" title="do_radial_motion2" alt="" coords="391,373,516,403"/><area shape="rect" id="node63" href="pull__rotation_8c.html#a1d2cf00ce89bc00d56831f827f9d77cc" title="init_rot_group" alt="" coords="596,5,695,35"/><area shape="rect" id="node7" href="edsam_8c.html#af9beb797572c126058d1a6d0a148db9c" title="init_edsam" alt="" coords="603,59,688,88"/><area shape="rect" id="node9" href="constr_8c.html#ade24bc7be86c9273e62da9f54dd2947e" title="init_constraints" alt="" coords="764,59,873,88"/><area shape="rect" id="node11" href="runner__openmm_8c.html#a1c2f054bfc5afc44cd980cf25546190d" title="mdrunner" alt="" coords="964,32,1039,61"/><area shape="rect" id="node15" href="edsam_8c.html#ae66923390c3e62ad94ad92264ed0220d" title="do_single_flood" alt="" coords="589,112,701,141"/><area shape="rect" id="node43" href="edsam_8c.html#a14f16676bee65b22fa373ee0a0cac80a" title="do_edsam" alt="" coords="604,165,687,195"/><area shape="rect" id="node17" href="edsam_8c.html#a1774ffce043cc82bd18fc9c9d8884273" title="do_flood" alt="" coords="784,112,853,141"/><area shape="rect" id="node19" href="sim__util_8c.html#aebeca502354732c126db3e81220059a4" title="do_force_cutsVERLET" alt="" coords="924,112,1079,141"/><area shape="rect" id="node39" href="sim__util_8c.html#a1d3281248b5954a553f69210c9d0c64d" title="do_force_cutsGROUP" alt="" coords="925,165,1077,195"/><area shape="rect" id="node21" href="sim__util_8c.html#ae84da958cc847100953511b93beace28" title="do_force" alt="" coords="1128,139,1200,168"/><area shape="rect" id="node23" href="md_8c.html#ab03e50f07db7a24087c44ccdce343305" title="do_md" alt="" coords="1284,59,1345,88"/><area shape="rect" id="node25" href="minimize_8c.html#aad33a4afc8acff28fd568113b6640cb6" title="evaluate_energy" alt="" coords="1256,112,1373,141"/><area shape="rect" id="node35" href="shellfc_8c.html#ab995a0cadc09ea92f161b56ece2eb639" title="relax_shell_flexcon" alt="" coords="1248,165,1381,195"/><area shape="rect" id="node37" href="tpi_8c.html#a85cdc1fc8f1c59d64289bfed1474523a" title="do_tpi" alt="" coords="1287,219,1343,248"/><area shape="rect" id="node27" href="minimize_8c.html#a94b84868513558ebf1b177f04c39d167" title="do_cg" alt="" coords="1439,32,1495,61"/><area shape="rect" id="node29" href="minimize_8c.html#a53d420a517454c935d80f0d4a8d31634" title="do_lbfgs" alt="" coords="1432,85,1501,115"/><area shape="rect" id="node31" href="minimize_8c.html#a684fce135fec8d36bbf9739a871c7607" title="do_steep" alt="" coords="1429,139,1504,168"/><area shape="rect" id="node33" href="minimize_8c.html#a26a93ab5eaa25efa390ade3b20be07d5" title="do_nm" alt="" coords="1436,192,1497,221"/><area shape="rect" id="node45" href="constr_8c.html#af8c58c3a20b512808951b711bfc76394" title="constrain" alt="" coords="781,165,856,195"/><area shape="rect" id="node49" href="pull__rotation_8c.html#a193fc60f86d5ff4b8951eb227bafcc8e" title="do_flexible" alt="" coords="604,219,687,248"/><area shape="rect" id="node65" href="pull__rotation_8c.html#a6c62c69ba660120e6c6d5c7092fc55e7" title="Initialize the enforced rotation groups." alt="" coords="788,5,849,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a918543f4782aca4196ce2a5cc6a3272a"></a><!-- doxytag: member="groupcoord.h::rotate_x" ref="a918543f4782aca4196ce2a5cc6a3272a" args="(rvec x[], const int nr, matrix rmat)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a> <a class="el" href="groupcoord_8h.html#a918543f4782aca4196ce2a5cc6a3272a">rotate_x</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#a7ea9c2a830d3f743b887387e33645a83">matrix</a>&#160;</td>
          <td class="paramname"><em>rmat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate positions. </p>
<p>Rotate the positions with the rotation matrix.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">x[inout]</td><td>Array of positions. </td></tr>
    <tr><td class="paramname">nr[in]</td><td>Number of entries in the position array. </td></tr>
    <tr><td class="paramname">rmat[in]</td><td>Rotation matrix to operate on all positions. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa739dbdc71986caa8bcbcda9009778ff"></a><!-- doxytag: member="groupcoord.h::translate_x" ref="aa739dbdc71986caa8bcbcda9009778ff" args="(rvec x[], const int nr, const rvec transvec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a> <a class="el" href="groupcoord_8h.html#aa739dbdc71986caa8bcbcda9009778ff">translate_x</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>transvec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Translate positions. </p>
<p>Add a translation vector to the positions x.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">x[inout]</td><td>Array of positions. </td></tr>
    <tr><td class="paramname">nr[in]</td><td>Number of entries in the position array. </td></tr>
    <tr><td class="paramname">transvec[in]</td><td>Translation vector to be added to all positions. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="groupcoord_8h_aa739dbdc71986caa8bcbcda9009778ff_cgraph.png" border="0" usemap="#groupcoord_8h_aa739dbdc71986caa8bcbcda9009778ff_cgraph" alt=""/></div>
<map name="groupcoord_8h_aa739dbdc71986caa8bcbcda9009778ff_cgraph" id="groupcoord_8h_aa739dbdc71986caa8bcbcda9009778ff_cgraph">
<area shape="rect" id="node3" href="include_2vec_8h.html#a5058762b39b3376b2b401692a9379749" title="rvec_inc" alt="" coords="143,5,212,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="groupcoord_8h_aa739dbdc71986caa8bcbcda9009778ff_icgraph.png" border="0" usemap="#groupcoord_8h_aa739dbdc71986caa8bcbcda9009778ff_icgraph" alt=""/></div>
<map name="groupcoord_8h_aa739dbdc71986caa8bcbcda9009778ff_icgraph" id="groupcoord_8h_aa739dbdc71986caa8bcbcda9009778ff_icgraph">
<area shape="rect" id="node3" href="edsam_8c.html#a09efc0c903c9059b925a4a2005b3da98" title="rmfit" alt="" coords="188,32,236,61"/><area shape="rect" id="node9" href="edsam_8c.html#a218f649ae5b4709e023aa17a3c78227c" title="init_edi" alt="" coords="181,192,243,221"/><area shape="rect" id="node17" href="edsam_8c.html#ad7ac552e63d90b8a5c264dc49da3cdd8" title="fit_to_reference" alt="" coords="156,85,268,115"/><area shape="rect" id="node48" href="edsam_8c.html#a7d0ab938d8822ff14ba7f0331258a797" title="translate_and_rotate" alt="" coords="143,139,281,168"/><area shape="rect" id="node53" href="pull__rotation_8c.html#a108d3104958486d593e86ab007b2a8fa" title="opt_angle_analytic" alt="" coords="147,245,277,275"/><area shape="rect" id="node59" href="pull__rotation_8c.html#a697bc400e3ddbdf1cbfc0037e03cbdca" title="Calculation of the enforced rotation potential." alt="" coords="689,219,775,248"/><area shape="rect" id="node5" href="edsam_8c.html#a14f16676bee65b22fa373ee0a0cac80a" title="do_edsam" alt="" coords="364,32,447,61"/><area shape="rect" id="node7" href="constr_8c.html#af8c58c3a20b512808951b711bfc76394" title="constrain" alt="" coords="547,32,621,61"/><area shape="rect" id="node11" href="edsam_8c.html#af9beb797572c126058d1a6d0a148db9c" title="init_edsam" alt="" coords="363,139,448,168"/><area shape="rect" id="node13" href="constr_8c.html#ade24bc7be86c9273e62da9f54dd2947e" title="init_constraints" alt="" coords="529,139,639,168"/><area shape="rect" id="node15" href="runner__openmm_8c.html#a1c2f054bfc5afc44cd980cf25546190d" title="mdrunner" alt="" coords="695,139,769,168"/><area shape="rect" id="node19" href="edsam_8c.html#ae66923390c3e62ad94ad92264ed0220d" title="do_single_flood" alt="" coords="349,85,461,115"/><area shape="rect" id="node21" href="edsam_8c.html#a1774ffce043cc82bd18fc9c9d8884273" title="do_flood" alt="" coords="697,85,767,115"/><area shape="rect" id="node23" href="sim__util_8c.html#aebeca502354732c126db3e81220059a4" title="do_force_cutsVERLET" alt="" coords="825,85,980,115"/><area shape="rect" id="node43" href="sim__util_8c.html#a1d3281248b5954a553f69210c9d0c64d" title="do_force_cutsGROUP" alt="" coords="827,139,979,168"/><area shape="rect" id="node25" href="sim__util_8c.html#ae84da958cc847100953511b93beace28" title="do_force" alt="" coords="1029,112,1101,141"/><area shape="rect" id="node27" href="md_8c.html#ab03e50f07db7a24087c44ccdce343305" title="do_md" alt="" coords="1185,32,1247,61"/><area shape="rect" id="node29" href="minimize_8c.html#aad33a4afc8acff28fd568113b6640cb6" title="evaluate_energy" alt="" coords="1157,85,1275,115"/><area shape="rect" id="node39" href="shellfc_8c.html#ab995a0cadc09ea92f161b56ece2eb639" title="relax_shell_flexcon" alt="" coords="1149,139,1283,168"/><area shape="rect" id="node41" href="tpi_8c.html#a85cdc1fc8f1c59d64289bfed1474523a" title="do_tpi" alt="" coords="1188,192,1244,221"/><area shape="rect" id="node31" href="minimize_8c.html#a94b84868513558ebf1b177f04c39d167" title="do_cg" alt="" coords="1340,5,1396,35"/><area shape="rect" id="node33" href="minimize_8c.html#a53d420a517454c935d80f0d4a8d31634" title="do_lbfgs" alt="" coords="1333,59,1403,88"/><area shape="rect" id="node35" href="minimize_8c.html#a684fce135fec8d36bbf9739a871c7607" title="do_steep" alt="" coords="1331,112,1405,141"/><area shape="rect" id="node37" href="minimize_8c.html#a26a93ab5eaa25efa390ade3b20be07d5" title="do_nm" alt="" coords="1337,165,1399,195"/><area shape="rect" id="node55" href="pull__rotation_8c.html#af67134d8db7183fccd7a5627d6b18cfd" title="flex_fit_angle" alt="" coords="356,245,455,275"/><area shape="rect" id="node62" href="pull__rotation_8c.html#a80f752c0bc92a00b32f6d1f31efd4e2e" title="flex_fit_angle_perslab" alt="" coords="332,192,479,221"/><area shape="rect" id="node57" href="pull__rotation_8c.html#a193fc60f86d5ff4b8951eb227bafcc8e" title="do_flexible" alt="" coords="543,219,625,248"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Sat Dec 20 2014 17:22:39 for My Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
