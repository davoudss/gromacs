<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>My Project: share/template/gromacs/centerofmass.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">share/template/gromacs/centerofmass.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>API for calculation of centers of mass/geometry.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="share_2template_2gromacs_2typedefs_8h_source.html">typedefs.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for centerofmass.h:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h__incl.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h" id="share_2template_2gromacs_2centerofmass_8h">
<area shape="rect" id="node3" href="share_2template_2gromacs_2typedefs_8h.html" title="typedefs.h" alt="" coords="2149,83,2232,112"/><area shape="rect" id="node7" href="share_2template_2gromacs_2visibility_8h.html" title="visibility.h" alt="" coords="2028,392,2108,421"/><area shape="rect" id="node9" href="share_2template_2gromacs_2sysstuff_8h.html" title="sysstuff.h" alt="" coords="359,315,439,344"/><area shape="rect" id="node29" href="share_2template_2gromacs_2types_2simple_8h.html" title="types/simple.h" alt="" coords="1049,392,1156,421"/><area shape="rect" id="node32" href="share_2template_2gromacs_2types_2enums_8h.html" title="types/enums.h" alt="" coords="2843,160,2949,189"/><area shape="rect" id="node34" href="share_2template_2gromacs_2types_2block_8h.html" title="types/block.h" alt="" coords="2452,237,2551,267"/><area shape="rect" id="node36" href="share_2template_2gromacs_2types_2idef_8h.html" title="idef.h" alt="" coords="2164,315,2217,344"/><area shape="rect" id="node39" href="share_2template_2gromacs_2types_2symtab_8h.html" title="types/symtab.h" alt="" coords="2316,237,2428,267"/><area shape="rect" id="node42" href="share_2template_2gromacs_2types_2atoms_8h.html" title="types/atoms.h" alt="" coords="2676,237,2780,267"/><area shape="rect" id="node45" href="share_2template_2gromacs_2types_2trx_8h.html" title="types/trx.h" alt="" coords="2635,160,2717,189"/><area shape="rect" id="node48" href="share_2template_2gromacs_2types_2topology_8h.html" title="types/topology.h" alt="" coords="2443,160,2560,189"/><area shape="rect" id="node55" href="share_2template_2gromacs_2types_2energy_8h.html" title="types/energy.h" alt="" coords="463,315,569,344"/><area shape="rect" id="node58" href="share_2template_2gromacs_2types_2inputrec_8h.html" title="types/inputrec.h" alt="" coords="551,237,665,267"/><area shape="rect" id="node62" href="share_2template_2gromacs_2types_2ishift_8h.html" title="types/ishift.h" alt="" coords="2973,160,3069,189"/><area shape="rect" id="node64" href="share_2template_2gromacs_2types_2graph_8h.html" title="types/graph.h" alt="" coords="2140,237,2241,267"/><area shape="rect" id="node67" href="share_2template_2gromacs_2types_2nrnb_8h.html" title="types/nrnb.h" alt="" coords="3093,160,3187,189"/><area shape="rect" id="node69" href="share_2template_2gromacs_2types_2nblist_8h.html" title="types/nblist.h" alt="" coords="1223,315,1321,344"/><area shape="rect" id="node71" href="share_2template_2gromacs_2types_2nbnxn__pairlist_8h.html" title="types/nbnxn_pairlist.h" alt="" coords="1831,315,1980,344"/><area shape="rect" id="node73" href="share_2template_2gromacs_2types_2nsgrid_8h.html" title="types/nsgrid.h" alt="" coords="993,315,1097,344"/><area shape="rect" id="node76" href="share_2template_2gromacs_2types_2forcerec_8h.html" title="types/forcerec.h" alt="" coords="1428,160,1543,189"/><area shape="rect" id="node104" href="share_2template_2gromacs_2types_2fcdata_8h.html" title="types/fcdata.h" alt="" coords="1745,237,1849,267"/><area shape="rect" id="node106" href="share_2template_2gromacs_2types_2mdatom_8h.html" title="types/mdatom.h" alt="" coords="969,237,1084,267"/><area shape="rect" id="node109" href="share_2template_2gromacs_2types_2pbc_8h.html" title="types/pbc.h" alt="" coords="1924,237,2015,267"/><area shape="rect" id="node112" href="share_2template_2gromacs_2types_2ifunc_8h.html" title="types/ifunc.h" alt="" coords="2007,160,2103,189"/><area shape="rect" id="node120" href="share_2template_2gromacs_2types_2filenm_8h.html" title="types/filenm.h" alt="" coords="3211,160,3315,189"/><area shape="rect" id="node122" href="share_2template_2gromacs_2types_2group_8h.html" title="types/group.h" alt="" coords="644,315,745,344"/><area shape="rect" id="node125" href="share_2template_2gromacs_2types_2state_8h.html" title="types/state.h" alt="" coords="769,315,868,344"/><area shape="rect" id="node128" href="share_2template_2gromacs_2types_2shellfc_8h.html" title="types/shellfc.h" alt="" coords="3339,160,3445,189"/><area shape="rect" id="node130" href="share_2template_2gromacs_2types_2constr_8h.html" title="types/constr.h" alt="" coords="3469,160,3573,189"/><area shape="rect" id="node132" href="share_2template_2gromacs_2types_2matrix_8h.html" title="types/matrix.h" alt="" coords="791,237,895,267"/><area shape="rect" id="node135" href="share_2template_2gromacs_2types_2oenv_8h.html" title="types/oenv.h" alt="" coords="3597,160,3693,189"/><area shape="rect" id="node19" href="share_2template_2gromacs_2gmx__header__config_8h.html" title="gmx_header_config.h" alt="" coords="96,392,243,421"/><area shape="rect" id="node21" href="share_2template_2gromacs_2version_8h.html" title="version.h" alt="" coords="267,392,341,421"/><area shape="rect" id="node78" href="share_2template_2gromacs_2types_2ns_8h.html" title="ns.h" alt="" coords="1364,237,1409,267"/><area shape="rect" id="node82" href="share_2template_2gromacs_2types_2genborn_8h.html" title="genborn.h" alt="" coords="1121,315,1199,344"/><area shape="rect" id="node85" href="share_2template_2gromacs_2types_2qmmmrec_8h.html" title="qmmmrec.h" alt="" coords="1345,315,1436,344"/><area shape="rect" id="node89" href="share_2template_2gromacs_2types_2nb__verlet_8h.html" title="nb_verlet.h" alt="" coords="1585,237,1671,267"/><area shape="rect" id="node94" href="share_2template_2gromacs_2types_2interaction__const_8h.html" title="interaction_const.h" alt="" coords="1209,237,1340,267"/><area shape="rect" id="node96" href="share_2template_2gromacs_2types_2hw__info_8h.html" title="hw_info.h" alt="" coords="1484,237,1561,267"/><area shape="rect" id="node92" href="share_2template_2gromacs_2types_2nbnxn__cuda__types__ext_8h.html" title="nbnxn_cuda_types_ext.h" alt="" coords="1641,315,1807,344"/><area shape="rect" id="node100" href="share_2template_2gromacs_2gmx__cpuid_8h.html" title="../gmx_cpuid.h" alt="" coords="1511,315,1617,344"/></map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h__dep__incl.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8hdep" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8hdep" id="share_2template_2gromacs_2centerofmass_8hdep">
<area shape="rect" id="node3" href="centerofmass_8c.html" title="src/gmxlib/trajana/centerofmass.c" alt="" coords="5,83,224,112"/><area shape="rect" id="node5" href="poscalc_8c.html" title="src/gmxlib/trajana/poscalc.c" alt="" coords="248,83,432,112"/></map>
</div>
</div>
<p><a href="share_2template_2gromacs_2centerofmass_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="share_2template_2gromacs_2centerofmass_8h.html#a742f1f05e6b37d5d795b338de4843929">gmx_calc_cog</a> (<a class="el" href="structt__topology.html">t_topology</a> *<a class="el" href="gmx__disre_8c.html#a1b538a2ce75aba6c346bc03980ffeb28">top</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], int nrefat, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a49fd977001162d7256c8fcd293f9d12a">index</a>[], <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> xout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="share_2template_2gromacs_2centerofmass_8h.html#a9854c5035749493ab405abd66ba7bcef">gmx_calc_com</a> (<a class="el" href="structt__topology.html">t_topology</a> *<a class="el" href="gmx__disre_8c.html#a1b538a2ce75aba6c346bc03980ffeb28">top</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], int nrefat, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a49fd977001162d7256c8fcd293f9d12a">index</a>[], <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> xout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="share_2template_2gromacs_2centerofmass_8h.html#ab9946cbd5c24f144235b272d500b811e">gmx_calc_cog_f</a> (<a class="el" href="structt__topology.html">t_topology</a> *<a class="el" href="gmx__disre_8c.html#a1b538a2ce75aba6c346bc03980ffeb28">top</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="copyrite_8c.html#a0757cfb6fe645a02867727255faa4f8b">f</a>[], int nrefat, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a49fd977001162d7256c8fcd293f9d12a">index</a>[], <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> fout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="share_2template_2gromacs_2centerofmass_8h.html#a297ae966b68adddd1606554a7edceb13">gmx_calc_comg</a> (<a class="el" href="structt__topology.html">t_topology</a> *<a class="el" href="gmx__disre_8c.html#a1b538a2ce75aba6c346bc03980ffeb28">top</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], int nrefat, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a49fd977001162d7256c8fcd293f9d12a">index</a>[], <a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> bMass, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> xout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="share_2template_2gromacs_2centerofmass_8h.html#aeadcc3855c61b7fdcb5af3965af4fcdb">gmx_calc_comg_f</a> (<a class="el" href="structt__topology.html">t_topology</a> *<a class="el" href="gmx__disre_8c.html#a1b538a2ce75aba6c346bc03980ffeb28">top</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="copyrite_8c.html#a0757cfb6fe645a02867727255faa4f8b">f</a>[], int nrefat, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a49fd977001162d7256c8fcd293f9d12a">index</a>[], <a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> bMass, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> fout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="share_2template_2gromacs_2centerofmass_8h.html#af5d88cb41629e93fdfe98ccdb7375637">gmx_calc_cog_pbc</a> (<a class="el" href="structt__topology.html">t_topology</a> *<a class="el" href="gmx__disre_8c.html#a1b538a2ce75aba6c346bc03980ffeb28">top</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], <a class="el" href="structt__pbc.html">t_pbc</a> *pbc, int nrefat, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a49fd977001162d7256c8fcd293f9d12a">index</a>[], <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> xout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="share_2template_2gromacs_2centerofmass_8h.html#aabb2f8905bf67f03350f1aad822b1596">gmx_calc_com_pbc</a> (<a class="el" href="structt__topology.html">t_topology</a> *<a class="el" href="gmx__disre_8c.html#a1b538a2ce75aba6c346bc03980ffeb28">top</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], <a class="el" href="structt__pbc.html">t_pbc</a> *pbc, int nrefat, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a49fd977001162d7256c8fcd293f9d12a">index</a>[], <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> xout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="share_2template_2gromacs_2centerofmass_8h.html#ae966fdbe78bcf9fb9d89b70b64b3c21d">gmx_calc_comg_pbc</a> (<a class="el" href="structt__topology.html">t_topology</a> *<a class="el" href="gmx__disre_8c.html#a1b538a2ce75aba6c346bc03980ffeb28">top</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], <a class="el" href="structt__pbc.html">t_pbc</a> *pbc, int nrefat, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a49fd977001162d7256c8fcd293f9d12a">index</a>[], <a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> bMass, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> xout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="share_2template_2gromacs_2centerofmass_8h.html#a4b7f02d5a9fa27343ae9d1c9672aae7c">gmx_calc_cog_block</a> (<a class="el" href="structt__topology.html">t_topology</a> *<a class="el" href="gmx__disre_8c.html#a1b538a2ce75aba6c346bc03980ffeb28">top</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], <a class="el" href="structt__block.html">t_block</a> *block, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a49fd977001162d7256c8fcd293f9d12a">index</a>[], <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> xout[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="share_2template_2gromacs_2centerofmass_8h.html#accf307bb2ab7762c8b8a8d02976df463">gmx_calc_com_block</a> (<a class="el" href="structt__topology.html">t_topology</a> *<a class="el" href="gmx__disre_8c.html#a1b538a2ce75aba6c346bc03980ffeb28">top</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], <a class="el" href="structt__block.html">t_block</a> *block, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a49fd977001162d7256c8fcd293f9d12a">index</a>[], <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> xout[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="share_2template_2gromacs_2centerofmass_8h.html#acca887acb94fd829d63c9ef0a51cfbf0">gmx_calc_cog_f_block</a> (<a class="el" href="structt__topology.html">t_topology</a> *<a class="el" href="gmx__disre_8c.html#a1b538a2ce75aba6c346bc03980ffeb28">top</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="copyrite_8c.html#a0757cfb6fe645a02867727255faa4f8b">f</a>[], <a class="el" href="structt__block.html">t_block</a> *block, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a49fd977001162d7256c8fcd293f9d12a">index</a>[], <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> fout[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="share_2template_2gromacs_2centerofmass_8h.html#a6365bcf7784e9c01d7a498252e6f2871">gmx_calc_comg_block</a> (<a class="el" href="structt__topology.html">t_topology</a> *<a class="el" href="gmx__disre_8c.html#a1b538a2ce75aba6c346bc03980ffeb28">top</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], <a class="el" href="structt__block.html">t_block</a> *block, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a49fd977001162d7256c8fcd293f9d12a">index</a>[], <a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> bMass, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> xout[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="share_2template_2gromacs_2centerofmass_8h.html#a0e7aa7ceaa7e7c010da97efa0868c320">gmx_calc_comg_f_block</a> (<a class="el" href="structt__topology.html">t_topology</a> *<a class="el" href="gmx__disre_8c.html#a1b538a2ce75aba6c346bc03980ffeb28">top</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="copyrite_8c.html#a0757cfb6fe645a02867727255faa4f8b">f</a>[], <a class="el" href="structt__block.html">t_block</a> *block, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a49fd977001162d7256c8fcd293f9d12a">index</a>[], <a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> bMass, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> fout[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="share_2template_2gromacs_2centerofmass_8h.html#a2290a28e334d43eef66794120970f3cf">gmx_calc_comg_blocka</a> (<a class="el" href="structt__topology.html">t_topology</a> *<a class="el" href="gmx__disre_8c.html#a1b538a2ce75aba6c346bc03980ffeb28">top</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], <a class="el" href="structt__blocka.html">t_blocka</a> *block, <a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> bMass, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> xout[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="share_2template_2gromacs_2centerofmass_8h.html#aeef133db1de6ad3d02cd96337f5c9faf">gmx_calc_comg_f_blocka</a> (<a class="el" href="structt__topology.html">t_topology</a> *<a class="el" href="gmx__disre_8c.html#a1b538a2ce75aba6c346bc03980ffeb28">top</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], <a class="el" href="structt__blocka.html">t_blocka</a> *block, <a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> bMass, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> xout[])</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>API for calculation of centers of mass/geometry. </p>
<p>This header defines a few functions that can be used to calculate centers of mass/geometry for a group of atoms. These routines can be used independently of the other parts of the library, but they are also used internally by the selection engine. In most cases, it should not be necessary to call these functions directly. Instead, one should write an analysis tool such that it gets all positions through selections.</p>
<p>The functions in the header can be divided into a few groups based on the parameters they take. The simplest group of functions calculates the center of a single group of atoms:</p>
<ul>
<li><a class="el" href="include_2centerofmass_8h.html#a742f1f05e6b37d5d795b338de4843929">gmx_calc_cog()</a>: Calculates the center of geometry (COG) of a given group of atoms.</li>
<li><a class="el" href="include_2centerofmass_8h.html#a9854c5035749493ab405abd66ba7bcef">gmx_calc_com()</a>: Calculates the center of mass (COM) of a given group of atoms.</li>
<li><a class="el" href="include_2centerofmass_8h.html#a297ae966b68adddd1606554a7edceb13">gmx_calc_comg()</a>: Calculates either the COM or COG, based on a gmx_boolean flag.</li>
</ul>
<p>A second set of routines is provided for calculating the centers for groups that wrap over periodic boundaries (<a class="el" href="include_2centerofmass_8h.html#af5d88cb41629e93fdfe98ccdb7375637">gmx_calc_cog_pbc()</a>, <a class="el" href="include_2centerofmass_8h.html#aabb2f8905bf67f03350f1aad822b1596">gmx_calc_com_pbc()</a>, <a class="el" href="include_2centerofmass_8h.html#ae966fdbe78bcf9fb9d89b70b64b3c21d">gmx_calc_comg_pbc()</a>). These functions are slower, because they need to adjust the center iteratively.</p>
<p>It is also possible to calculate centers for several groups of atoms in one call. The functions <a class="el" href="include_2centerofmass_8h.html#a4b7f02d5a9fa27343ae9d1c9672aae7c">gmx_calc_cog_block()</a>, <a class="el" href="include_2centerofmass_8h.html#accf307bb2ab7762c8b8a8d02976df463">gmx_calc_com_block()</a> and <a class="el" href="include_2centerofmass_8h.html#a6365bcf7784e9c01d7a498252e6f2871">gmx_calc_comg_block()</a> take an index group and a partitioning of that index group (as a <code><a class="el" href="structt__block.html">t_block</a></code> structure), and calculate the centers for each group defined by the <code><a class="el" href="structt__block.html">t_block</a></code> structure separately.</p>
<p>Finally, there is a function <a class="el" href="include_2centerofmass_8h.html#a2290a28e334d43eef66794120970f3cf">gmx_calc_comg_blocka()</a> that takes both the index group and the partitioning as a single <code><a class="el" href="structt__blocka.html">t_blocka</a></code> structure. </p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a742f1f05e6b37d5d795b338de4843929"></a><!-- doxytag: member="centerofmass.h::gmx_calc_cog" ref="a742f1f05e6b37d5d795b338de4843929" args="(t_topology *top, rvec x[], int nrefat, atom_id index[], rvec xout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="centerofmass_8c.html#a742f1f05e6b37d5d795b338de4843929">gmx_calc_cog</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__topology.html">t_topology</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrefat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>index</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>xout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate a single center of geometry.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>Topology structure (unused, can be NULL). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Position vectors of all atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrefat</td><td>Number of atoms in the index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Indices of atoms. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td>COG position for the indexed atoms. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h_a742f1f05e6b37d5d795b338de4843929_cgraph.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h_a742f1f05e6b37d5d795b338de4843929_cgraph" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h_a742f1f05e6b37d5d795b338de4843929_cgraph" id="share_2template_2gromacs_2centerofmass_8h_a742f1f05e6b37d5d795b338de4843929_cgraph">
<area shape="rect" id="node3" href="include_2vec_8h.html#afcff0f0d52146c7d16ca019707d24b05" title="clear_rvec" alt="" coords="160,5,243,35"/><area shape="rect" id="node5" href="include_2vec_8h.html#a5058762b39b3376b2b401692a9379749" title="rvec_inc" alt="" coords="167,59,236,88"/><area shape="rect" id="node7" href="include_2vec_8h.html#a6a437400111a6ffdb6085571c6e9b530" title="svmul" alt="" coords="173,112,229,141"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4b7f02d5a9fa27343ae9d1c9672aae7c"></a><!-- doxytag: member="centerofmass.h::gmx_calc_cog_block" ref="a4b7f02d5a9fa27343ae9d1c9672aae7c" args="(t_topology *top, rvec x[], t_block *block, atom_id index[], rvec xout[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="centerofmass_8c.html#a4b7f02d5a9fa27343ae9d1c9672aae7c">gmx_calc_cog_block</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__topology.html">t_topology</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__block.html">t_block</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>index</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>xout</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate centers of geometry for a blocked index.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>Topology structure (unused, can be NULL). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Position vectors of all atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td><a class="el" href="structt__block.html">t_block</a> structure that divides <code>index</code> into blocks. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Indices of atoms. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td><code>block-&gt;nr</code> COG positions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h_a4b7f02d5a9fa27343ae9d1c9672aae7c_cgraph.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h_a4b7f02d5a9fa27343ae9d1c9672aae7c_cgraph" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h_a4b7f02d5a9fa27343ae9d1c9672aae7c_cgraph" id="share_2template_2gromacs_2centerofmass_8h_a4b7f02d5a9fa27343ae9d1c9672aae7c_cgraph">
<area shape="rect" id="node3" href="include_2vec_8h.html#afcff0f0d52146c7d16ca019707d24b05" title="clear_rvec" alt="" coords="197,5,280,35"/><area shape="rect" id="node5" href="include_2vec_8h.html#a5058762b39b3376b2b401692a9379749" title="rvec_inc" alt="" coords="204,59,273,88"/><area shape="rect" id="node7" href="include_2vec_8h.html#a6a437400111a6ffdb6085571c6e9b530" title="svmul" alt="" coords="211,112,267,141"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab9946cbd5c24f144235b272d500b811e"></a><!-- doxytag: member="centerofmass.h::gmx_calc_cog_f" ref="ab9946cbd5c24f144235b272d500b811e" args="(t_topology *top, rvec f[], int nrefat, atom_id index[], rvec fout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="centerofmass_8c.html#ab9946cbd5c24f144235b272d500b811e">gmx_calc_cog_f</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__topology.html">t_topology</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>f</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrefat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>index</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>fout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate force on a single center of geometry.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>Topology structure with masses. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>Forces on all atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrefat</td><td>Number of atoms in the index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Indices of atoms. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fout</td><td>Force on the COG position for the indexed atoms. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, EINVAL if <code>top</code> is NULL.</dd></dl>
<p>No special function is provided for calculating the force on the center of mass, because this can be achieved with <a class="el" href="include_2centerofmass_8h.html#a742f1f05e6b37d5d795b338de4843929">gmx_calc_cog()</a>. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h_ab9946cbd5c24f144235b272d500b811e_cgraph.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h_ab9946cbd5c24f144235b272d500b811e_cgraph" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h_ab9946cbd5c24f144235b272d500b811e_cgraph" id="share_2template_2gromacs_2centerofmass_8h_ab9946cbd5c24f144235b272d500b811e_cgraph">
<area shape="rect" id="node3" href="include_2vec_8h.html#afcff0f0d52146c7d16ca019707d24b05" title="clear_rvec" alt="" coords="171,5,253,35"/><area shape="rect" id="node5" href="include_2vec_8h.html#a6a437400111a6ffdb6085571c6e9b530" title="svmul" alt="" coords="184,59,240,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acca887acb94fd829d63c9ef0a51cfbf0"></a><!-- doxytag: member="centerofmass.h::gmx_calc_cog_f_block" ref="acca887acb94fd829d63c9ef0a51cfbf0" args="(t_topology *top, rvec f[], t_block *block, atom_id index[], rvec fout[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="centerofmass_8c.html#acca887acb94fd829d63c9ef0a51cfbf0">gmx_calc_cog_f_block</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__topology.html">t_topology</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>f</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__block.html">t_block</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>index</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>fout</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate forces on centers of geometry for a blocked index.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>Topology structure with masses. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>Forces on all atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td><a class="el" href="structt__block.html">t_block</a> structure that divides <code>index</code> into blocks. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Indices of atoms. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td><code>block-&gt;nr</code> Forces on COG positions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, EINVAL if <code>top</code> is NULL. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h_acca887acb94fd829d63c9ef0a51cfbf0_cgraph.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h_acca887acb94fd829d63c9ef0a51cfbf0_cgraph" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h_acca887acb94fd829d63c9ef0a51cfbf0_cgraph" id="share_2template_2gromacs_2centerofmass_8h_acca887acb94fd829d63c9ef0a51cfbf0_cgraph">
<area shape="rect" id="node3" href="include_2vec_8h.html#afcff0f0d52146c7d16ca019707d24b05" title="clear_rvec" alt="" coords="208,5,291,35"/><area shape="rect" id="node5" href="include_2vec_8h.html#a6a437400111a6ffdb6085571c6e9b530" title="svmul" alt="" coords="221,59,277,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af5d88cb41629e93fdfe98ccdb7375637"></a><!-- doxytag: member="centerofmass.h::gmx_calc_cog_pbc" ref="af5d88cb41629e93fdfe98ccdb7375637" args="(t_topology *top, rvec x[], t_pbc *pbc, int nrefat, atom_id index[], rvec xout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="centerofmass_8c.html#af5d88cb41629e93fdfe98ccdb7375637">gmx_calc_cog_pbc</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__topology.html">t_topology</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__pbc.html">t_pbc</a> *&#160;</td>
          <td class="paramname"><em>pbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrefat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>index</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>xout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate a single center of geometry iteratively, taking PBC into account.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>Topology structure (unused, can be NULL). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Position vectors of all atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pbc</td><td>Periodic boundary conditions structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrefat</td><td>Number of atoms in the index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Indices of atoms. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td>COG position for the indexed atoms. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success.</dd></dl>
<p>Works exactly as <a class="el" href="include_2centerofmass_8h.html#aabb2f8905bf67f03350f1aad822b1596">gmx_calc_com_pbc()</a>, but calculates the center of geometry. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h_af5d88cb41629e93fdfe98ccdb7375637_cgraph.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h_af5d88cb41629e93fdfe98ccdb7375637_cgraph" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h_af5d88cb41629e93fdfe98ccdb7375637_cgraph" id="share_2template_2gromacs_2centerofmass_8h_af5d88cb41629e93fdfe98ccdb7375637_cgraph">
<area shape="rect" id="node3" href="include_2centerofmass_8h.html#a742f1f05e6b37d5d795b338de4843929" title="gmx_calc_cog" alt="" coords="189,5,296,35"/><area shape="rect" id="node5" href="include_2pbc_8h.html#a442132e6e6fce9d8f8f5c4e115e6b4d7" title="pbc_dx" alt="" coords="211,59,275,88"/><area shape="rect" id="node7" href="include_2vec_8h.html#af5e540e336b9e794d3c09b10959b5591" title="rvec_add" alt="" coords="205,112,280,141"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9854c5035749493ab405abd66ba7bcef"></a><!-- doxytag: member="centerofmass.h::gmx_calc_com" ref="a9854c5035749493ab405abd66ba7bcef" args="(t_topology *top, rvec x[], int nrefat, atom_id index[], rvec xout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="centerofmass_8c.html#a9854c5035749493ab405abd66ba7bcef">gmx_calc_com</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__topology.html">t_topology</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrefat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>index</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>xout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate a single center of mass.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>Topology structure with masses. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Position vectors of all atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrefat</td><td>Number of atoms in the index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Indices of atoms. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td>COM position for the indexed atoms. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, EINVAL if <code>top</code> is NULL.</dd></dl>
<p>Works exactly as <a class="el" href="include_2centerofmass_8h.html#a742f1f05e6b37d5d795b338de4843929">gmx_calc_cog()</a> with the exception that a center of mass are calculated, and hence a topology with masses is required. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h_a9854c5035749493ab405abd66ba7bcef_cgraph.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h_a9854c5035749493ab405abd66ba7bcef_cgraph" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h_a9854c5035749493ab405abd66ba7bcef_cgraph" id="share_2template_2gromacs_2centerofmass_8h_a9854c5035749493ab405abd66ba7bcef_cgraph">
<area shape="rect" id="node3" href="include_2vec_8h.html#afcff0f0d52146c7d16ca019707d24b05" title="clear_rvec" alt="" coords="165,5,248,35"/><area shape="rect" id="node5" href="include_2vec_8h.html#a6a437400111a6ffdb6085571c6e9b530" title="svmul" alt="" coords="179,59,235,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="accf307bb2ab7762c8b8a8d02976df463"></a><!-- doxytag: member="centerofmass.h::gmx_calc_com_block" ref="accf307bb2ab7762c8b8a8d02976df463" args="(t_topology *top, rvec x[], t_block *block, atom_id index[], rvec xout[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="centerofmass_8c.html#accf307bb2ab7762c8b8a8d02976df463">gmx_calc_com_block</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__topology.html">t_topology</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__block.html">t_block</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>index</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>xout</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate centers of mass for a blocked index.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>Topology structure with masses. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Position vectors of all atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td><a class="el" href="structt__block.html">t_block</a> structure that divides <code>index</code> into blocks. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Indices of atoms. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td><code>block-&gt;nr</code> COM positions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, EINVAL if <code>top</code> is NULL.</dd></dl>
<p>Works exactly as <a class="el" href="include_2centerofmass_8h.html#a4b7f02d5a9fa27343ae9d1c9672aae7c">gmx_calc_cog_block()</a> with the exception that centers of mass are calculated, and hence a topology with masses is required. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h_accf307bb2ab7762c8b8a8d02976df463_cgraph.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h_accf307bb2ab7762c8b8a8d02976df463_cgraph" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h_accf307bb2ab7762c8b8a8d02976df463_cgraph" id="share_2template_2gromacs_2centerofmass_8h_accf307bb2ab7762c8b8a8d02976df463_cgraph">
<area shape="rect" id="node3" href="include_2vec_8h.html#afcff0f0d52146c7d16ca019707d24b05" title="clear_rvec" alt="" coords="203,5,285,35"/><area shape="rect" id="node5" href="include_2vec_8h.html#a6a437400111a6ffdb6085571c6e9b530" title="svmul" alt="" coords="216,59,272,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aabb2f8905bf67f03350f1aad822b1596"></a><!-- doxytag: member="centerofmass.h::gmx_calc_com_pbc" ref="aabb2f8905bf67f03350f1aad822b1596" args="(t_topology *top, rvec x[], t_pbc *pbc, int nrefat, atom_id index[], rvec xout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="centerofmass_8c.html#aabb2f8905bf67f03350f1aad822b1596">gmx_calc_com_pbc</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__topology.html">t_topology</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__pbc.html">t_pbc</a> *&#160;</td>
          <td class="paramname"><em>pbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrefat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>index</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>xout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate a single center of mass iteratively, taking PBC into account.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>Topology structure with masses. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Position vectors of all atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pbc</td><td>Periodic boundary conditions structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrefat</td><td>Number of atoms in the index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Indices of atoms. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td>COM position for the indexed atoms. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, EINVAL if <code>top</code> is NULL.</dd></dl>
<p>Works as <a class="el" href="include_2centerofmass_8h.html#a9854c5035749493ab405abd66ba7bcef">gmx_calc_com()</a>, but takes into account periodic boundary conditions: If any atom is more than half the box from the COM, it is wrapped around and a new COM is calculated. This is repeated until no atoms violate the condition.</p>
<p>Modified from src/tools/gmx_sorient.c in Gromacs distribution. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h_aabb2f8905bf67f03350f1aad822b1596_cgraph.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h_aabb2f8905bf67f03350f1aad822b1596_cgraph" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h_aabb2f8905bf67f03350f1aad822b1596_cgraph" id="share_2template_2gromacs_2centerofmass_8h_aabb2f8905bf67f03350f1aad822b1596_cgraph">
<area shape="rect" id="node3" href="include_2vec_8h.html#afcff0f0d52146c7d16ca019707d24b05" title="clear_rvec" alt="" coords="192,5,275,35"/><area shape="rect" id="node5" href="include_2vec_8h.html#a6a437400111a6ffdb6085571c6e9b530" title="svmul" alt="" coords="205,59,261,88"/><area shape="rect" id="node7" href="include_2pbc_8h.html#a442132e6e6fce9d8f8f5c4e115e6b4d7" title="pbc_dx" alt="" coords="201,112,265,141"/><area shape="rect" id="node9" href="include_2vec_8h.html#af5e540e336b9e794d3c09b10959b5591" title="rvec_add" alt="" coords="196,165,271,195"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a297ae966b68adddd1606554a7edceb13"></a><!-- doxytag: member="centerofmass.h::gmx_calc_comg" ref="a297ae966b68adddd1606554a7edceb13" args="(t_topology *top, rvec x[], int nrefat, atom_id index[], gmx_bool bMass, rvec xout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="centerofmass_8c.html#a297ae966b68adddd1606554a7edceb13">gmx_calc_comg</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__topology.html">t_topology</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrefat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>index</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td>
          <td class="paramname"><em>bMass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>xout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate a single center of mass/geometry.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>Topology structure with masses (can be NULL if <code>bMASS==FALSE</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Position vectors of all atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrefat</td><td>Number of atoms in the index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Indices of atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bMass</td><td>If TRUE, mass weighting is used. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td>COM/COG position for the indexed atoms. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, EINVAL if <code>top</code> is NULL and <code>bMass</code> is TRUE.</dd></dl>
<p>Calls either <a class="el" href="include_2centerofmass_8h.html#a9854c5035749493ab405abd66ba7bcef">gmx_calc_com()</a> or <a class="el" href="include_2centerofmass_8h.html#a742f1f05e6b37d5d795b338de4843929">gmx_calc_cog()</a> depending on the value of <code>bMass</code>. Other parameters are passed unmodified to these functions. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h_a297ae966b68adddd1606554a7edceb13_cgraph.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h_a297ae966b68adddd1606554a7edceb13_cgraph" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h_a297ae966b68adddd1606554a7edceb13_cgraph" id="share_2template_2gromacs_2centerofmass_8h_a297ae966b68adddd1606554a7edceb13_cgraph">
<area shape="rect" id="node3" href="include_2centerofmass_8h.html#a9854c5035749493ab405abd66ba7bcef" title="gmx_calc_com" alt="" coords="172,5,281,35"/><area shape="rect" id="node5" href="include_2centerofmass_8h.html#a742f1f05e6b37d5d795b338de4843929" title="gmx_calc_cog" alt="" coords="173,59,280,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6365bcf7784e9c01d7a498252e6f2871"></a><!-- doxytag: member="centerofmass.h::gmx_calc_comg_block" ref="a6365bcf7784e9c01d7a498252e6f2871" args="(t_topology *top, rvec x[], t_block *block, atom_id index[], gmx_bool bMass, rvec xout[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="centerofmass_8c.html#a6365bcf7784e9c01d7a498252e6f2871">gmx_calc_comg_block</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__topology.html">t_topology</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__block.html">t_block</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>index</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td>
          <td class="paramname"><em>bMass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>xout</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate centers of mass/geometry for a blocked index.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>Topology structure with masses (can be NULL if <code>bMASS==FALSE</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Position vectors of all atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td><a class="el" href="structt__block.html">t_block</a> structure that divides <code>index</code> into blocks. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Indices of atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bMass</td><td>If TRUE, mass weighting is used. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td><code>block-&gt;nr</code> COM/COG positions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, EINVAL if <code>top</code> is NULL and <code>bMass</code> is TRUE.</dd></dl>
<p>Calls either <a class="el" href="include_2centerofmass_8h.html#accf307bb2ab7762c8b8a8d02976df463">gmx_calc_com_block()</a> or <a class="el" href="include_2centerofmass_8h.html#a4b7f02d5a9fa27343ae9d1c9672aae7c">gmx_calc_cog_block()</a> depending on the value of <code>bMass</code>. Other parameters are passed unmodified to these functions. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h_a6365bcf7784e9c01d7a498252e6f2871_cgraph.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h_a6365bcf7784e9c01d7a498252e6f2871_cgraph" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h_a6365bcf7784e9c01d7a498252e6f2871_cgraph" id="share_2template_2gromacs_2centerofmass_8h_a6365bcf7784e9c01d7a498252e6f2871_cgraph">
<area shape="rect" id="node3" href="include_2centerofmass_8h.html#accf307bb2ab7762c8b8a8d02976df463" title="gmx_calc_com_block" alt="" coords="209,5,356,35"/><area shape="rect" id="node5" href="include_2centerofmass_8h.html#a4b7f02d5a9fa27343ae9d1c9672aae7c" title="gmx_calc_cog_block" alt="" coords="211,59,355,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2290a28e334d43eef66794120970f3cf"></a><!-- doxytag: member="centerofmass.h::gmx_calc_comg_blocka" ref="a2290a28e334d43eef66794120970f3cf" args="(t_topology *top, rvec x[], t_blocka *block, gmx_bool bMass, rvec xout[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="centerofmass_8c.html#a2290a28e334d43eef66794120970f3cf">gmx_calc_comg_blocka</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__topology.html">t_topology</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__blocka.html">t_blocka</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td>
          <td class="paramname"><em>bMass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>xout</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate centers of mass/geometry for a set of blocks;</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>Topology structure with masses (can be NULL if <code>bMASS==FALSE</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Position vectors of all atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Blocks for calculation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bMass</td><td>If TRUE, mass weighting is used. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td><code>block-&gt;nr</code> COM/COG positions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, EINVAL if <code>top</code> is NULL and <code>bMass</code> is TRUE.</dd></dl>
<p>Calls <a class="el" href="include_2centerofmass_8h.html#a6365bcf7784e9c01d7a498252e6f2871">gmx_calc_comg_block()</a>, converting the <code><a class="el" href="structt__blocka.html">t_blocka</a></code> structure into a <code><a class="el" href="structt__block.html">t_block</a></code> and an index. Other parameters are passed unmodified.</p>
<dl class="attention"><dt><b>Attention:</b></dt><dd>This function assumes that a pointer to <code><a class="el" href="structt__blocka.html">t_blocka</a></code> can be safely typecast into <code><a class="el" href="structt__block.html">t_block</a></code> such that the index fields can still be referenced. With the present Gromacs defitions of these types, this is the case, but if the layout of these structures is changed, this may lead to strange crashes. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h_a2290a28e334d43eef66794120970f3cf_cgraph.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h_a2290a28e334d43eef66794120970f3cf_cgraph" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h_a2290a28e334d43eef66794120970f3cf_cgraph" id="share_2template_2gromacs_2centerofmass_8h_a2290a28e334d43eef66794120970f3cf_cgraph">
<area shape="rect" id="node3" href="include_2centerofmass_8h.html#a6365bcf7784e9c01d7a498252e6f2871" title="gmx_calc_comg_block" alt="" coords="216,5,371,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeadcc3855c61b7fdcb5af3965af4fcdb"></a><!-- doxytag: member="centerofmass.h::gmx_calc_comg_f" ref="aeadcc3855c61b7fdcb5af3965af4fcdb" args="(t_topology *top, rvec f[], int nrefat, atom_id index[], gmx_bool bMass, rvec fout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="centerofmass_8c.html#aeadcc3855c61b7fdcb5af3965af4fcdb">gmx_calc_comg_f</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__topology.html">t_topology</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>f</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrefat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>index</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td>
          <td class="paramname"><em>bMass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>fout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate force on a single center of mass/geometry.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>Topology structure with masses (can be NULL if <code>bMASS==TRUE</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Forces on all atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrefat</td><td>Number of atoms in the index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Indices of atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bMass</td><td>If TRUE, force on COM is calculated. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td>Force on the COM/COG position for the indexed atoms. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, EINVAL if <code>top</code> is NULL and <code>bMass</code> is FALSE.</dd></dl>
<p>Calls either <a class="el" href="include_2centerofmass_8h.html#a742f1f05e6b37d5d795b338de4843929">gmx_calc_cog()</a> or <a class="el" href="include_2centerofmass_8h.html#ab9946cbd5c24f144235b272d500b811e">gmx_calc_cog_f()</a> depending on the value of <code>bMass</code>. Other parameters are passed unmodified to these functions. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h_aeadcc3855c61b7fdcb5af3965af4fcdb_cgraph.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h_aeadcc3855c61b7fdcb5af3965af4fcdb_cgraph" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h_aeadcc3855c61b7fdcb5af3965af4fcdb_cgraph" id="share_2template_2gromacs_2centerofmass_8h_aeadcc3855c61b7fdcb5af3965af4fcdb_cgraph">
<area shape="rect" id="node3" href="include_2centerofmass_8h.html#a742f1f05e6b37d5d795b338de4843929" title="gmx_calc_cog" alt="" coords="187,5,293,35"/><area shape="rect" id="node5" href="include_2centerofmass_8h.html#ab9946cbd5c24f144235b272d500b811e" title="gmx_calc_cog_f" alt="" coords="181,59,299,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0e7aa7ceaa7e7c010da97efa0868c320"></a><!-- doxytag: member="centerofmass.h::gmx_calc_comg_f_block" ref="a0e7aa7ceaa7e7c010da97efa0868c320" args="(t_topology *top, rvec f[], t_block *block, atom_id index[], gmx_bool bMass, rvec fout[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="centerofmass_8c.html#a0e7aa7ceaa7e7c010da97efa0868c320">gmx_calc_comg_f_block</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__topology.html">t_topology</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>f</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__block.html">t_block</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>index</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td>
          <td class="paramname"><em>bMass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>fout</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate forces on centers of mass/geometry for a blocked index.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>Topology structure with masses (can be NULL if <code>bMASS==FALSE</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>Forces on all atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td><a class="el" href="structt__block.html">t_block</a> structure that divides <code>index</code> into blocks. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Indices of atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bMass</td><td>If TRUE, force on COM is calculated. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td><code>block-&gt;nr</code> forces on the COM/COG positions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, EINVAL if <code>top</code> is NULL and <code>bMass</code> is TRUE.</dd></dl>
<p>Calls either <a class="el" href="include_2centerofmass_8h.html#accf307bb2ab7762c8b8a8d02976df463">gmx_calc_com_block()</a> or <a class="el" href="include_2centerofmass_8h.html#a4b7f02d5a9fa27343ae9d1c9672aae7c">gmx_calc_cog_block()</a> depending on the value of <code>bMass</code>. Other parameters are passed unmodified to these functions. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h_a0e7aa7ceaa7e7c010da97efa0868c320_cgraph.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h_a0e7aa7ceaa7e7c010da97efa0868c320_cgraph" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h_a0e7aa7ceaa7e7c010da97efa0868c320_cgraph" id="share_2template_2gromacs_2centerofmass_8h_a0e7aa7ceaa7e7c010da97efa0868c320_cgraph">
<area shape="rect" id="node3" href="include_2centerofmass_8h.html#a4b7f02d5a9fa27343ae9d1c9672aae7c" title="gmx_calc_cog_block" alt="" coords="227,5,371,35"/><area shape="rect" id="node5" href="include_2centerofmass_8h.html#acca887acb94fd829d63c9ef0a51cfbf0" title="gmx_calc_cog_f_block" alt="" coords="221,59,376,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeef133db1de6ad3d02cd96337f5c9faf"></a><!-- doxytag: member="centerofmass.h::gmx_calc_comg_f_blocka" ref="aeef133db1de6ad3d02cd96337f5c9faf" args="(t_topology *top, rvec x[], t_blocka *block, gmx_bool bMass, rvec xout[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="centerofmass_8c.html#aba196c5fee85dd2d49cb4b240609d1b9">gmx_calc_comg_f_blocka</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__topology.html">t_topology</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>f</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__blocka.html">t_blocka</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td>
          <td class="paramname"><em>bMass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>fout</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate forces on centers of mass/geometry for a set of blocks;</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>Topology structure with masses (can be NULL if <code>bMASS==TRUE</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>Forces on all atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Blocks for calculation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bMass</td><td>If TRUE, force on COM is calculated. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fout</td><td><code>block-&gt;nr</code> forces on the COM/COG positions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, EINVAL if <code>top</code> is NULL and <code>bMass</code> is FALSE.</dd></dl>
<p>Calls <a class="el" href="include_2centerofmass_8h.html#a0e7aa7ceaa7e7c010da97efa0868c320">gmx_calc_comg_f_block()</a>, converting the <code><a class="el" href="structt__blocka.html">t_blocka</a></code> structure into a <code><a class="el" href="structt__block.html">t_block</a></code> and an index. Other parameters are passed unmodified.</p>
<dl class="attention"><dt><b>Attention:</b></dt><dd>This function assumes that a pointer to <code><a class="el" href="structt__blocka.html">t_blocka</a></code> can be safely typecast into <code><a class="el" href="structt__block.html">t_block</a></code> such that the index fields can still be referenced. With the present Gromacs defitions of these types, this is the case, but if the layout of these structures is changed, this may lead to strange crashes. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h_aeef133db1de6ad3d02cd96337f5c9faf_cgraph.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h_aeef133db1de6ad3d02cd96337f5c9faf_cgraph" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h_aeef133db1de6ad3d02cd96337f5c9faf_cgraph" id="share_2template_2gromacs_2centerofmass_8h_aeef133db1de6ad3d02cd96337f5c9faf_cgraph">
<area shape="rect" id="node3" href="include_2centerofmass_8h.html#a0e7aa7ceaa7e7c010da97efa0868c320" title="gmx_calc_comg_f_block" alt="" coords="228,5,393,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae966fdbe78bcf9fb9d89b70b64b3c21d"></a><!-- doxytag: member="centerofmass.h::gmx_calc_comg_pbc" ref="ae966fdbe78bcf9fb9d89b70b64b3c21d" args="(t_topology *top, rvec x[], t_pbc *pbc, int nrefat, atom_id index[], gmx_bool bMass, rvec xout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="centerofmass_8c.html#ae966fdbe78bcf9fb9d89b70b64b3c21d">gmx_calc_comg_pbc</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__topology.html">t_topology</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__pbc.html">t_pbc</a> *&#160;</td>
          <td class="paramname"><em>pbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrefat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>index</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td>
          <td class="paramname"><em>bMass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>xout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate a single center of mass/geometry iteratively with PBC.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">top</td><td>Topology structure with masses (can be NULL if <code>bMASS==FALSE</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Position vectors of all atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pbc</td><td>Periodic boundary conditions structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrefat</td><td>Number of atoms in the index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Indices of atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bMass</td><td>If TRUE, mass weighting is used. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td>COM/COG position for the indexed atoms. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, EINVAL if <code>top</code> is NULL and <code>bMass</code> is TRUE.</dd></dl>
<p>Calls either <a class="el" href="include_2centerofmass_8h.html#a9854c5035749493ab405abd66ba7bcef">gmx_calc_com()</a> or <a class="el" href="include_2centerofmass_8h.html#a742f1f05e6b37d5d795b338de4843929">gmx_calc_cog()</a> depending on the value of <code>bMass</code>. Other parameters are passed unmodified to these functions. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="share_2template_2gromacs_2centerofmass_8h_ae966fdbe78bcf9fb9d89b70b64b3c21d_cgraph.png" border="0" usemap="#share_2template_2gromacs_2centerofmass_8h_ae966fdbe78bcf9fb9d89b70b64b3c21d_cgraph" alt=""/></div>
<map name="share_2template_2gromacs_2centerofmass_8h_ae966fdbe78bcf9fb9d89b70b64b3c21d_cgraph" id="share_2template_2gromacs_2centerofmass_8h_ae966fdbe78bcf9fb9d89b70b64b3c21d_cgraph">
<area shape="rect" id="node3" href="include_2centerofmass_8h.html#aabb2f8905bf67f03350f1aad822b1596" title="gmx_calc_com_pbc" alt="" coords="200,5,339,35"/><area shape="rect" id="node5" href="include_2centerofmass_8h.html#af5d88cb41629e93fdfe98ccdb7375637" title="gmx_calc_cog_pbc" alt="" coords="203,59,336,88"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Sat Dec 20 2014 17:22:22 for My Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
