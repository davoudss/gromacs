<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>My Project: src/gmxlib/trajana/displacement.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">src/gmxlib/trajana/displacement.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;pbc.h&gt;</code><br/>
<code>#include &lt;smalloc.h&gt;</code><br/>
<code>#include &lt;vec.h&gt;</code><br/>
<code>#include &lt;displacement.h&gt;</code><br/>
<code>#include &lt;position.h&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for displacement.c:</div>
<div class="dyncontent">
<div class="center"><img src="displacement_8c__incl.png" border="0" usemap="#src_2gmxlib_2trajana_2displacement_8c" alt=""/></div>
<map name="src_2gmxlib_2trajana_2displacement_8c" id="src_2gmxlib_2trajana_2displacement_8c">
</map>
</div>
</div><table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgmx__ana__displpos__t.html">gmx_ana_displpos_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structgmx__ana__displpos__t.html">gmx_ana_displpos_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="displacement_8c.html#a0810c4cbff76246a3c6516933c9ee1c5">gmx_ana_displpos_t</a></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="displacement_8c.html#a2c2df45c0dc0ba8c0326f692cb7839d1">gmx_ana_displ_create</a> (<a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> **data, int nmax, real tmax)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="displacement_8c.html#a4fbbe00acaff0a0a7b3d4593bf708b96">gmx_ana_displ_start_frame</a> (<a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *<a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#ae624f265c646670d373e9de0306f184b">d</a>, real <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a2b515c84b1293071f7584da32ca336c0">t</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="displacement_8c.html#adc268c27bcc727590b27636bf52daa0d">gmx_ana_displ_time_to_steps</a> (<a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *<a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#ae624f265c646670d373e9de0306f184b">d</a>, real time, int *steps)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="displacement_8c.html#a1249df9ac34685bd9609e1944bccb14a">gmx_ana_displ_store</a> (<a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *<a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#ae624f265c646670d373e9de0306f184b">d</a>, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> id, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>, <a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> bPres)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="displacement_8c.html#a23227f37b703ca5d00cdaa2af678e728">gmx_ana_displ_store_array</a> (<a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *<a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#ae624f265c646670d373e9de0306f184b">d</a>, int <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a82736b60ddc8f6ec6c9591b0d6fcb394">n</a>, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> id[], <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="displacement_8c.html#acd4c27a82da37705cbecc5400b5001ad">gmx_ana_displ_store_all</a> (<a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *<a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#ae624f265c646670d373e9de0306f184b">d</a>, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> id[], <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="displacement_8c.html#aafc782c3271e10f8207c828d5d0fe87f">gmx_ana_displ_store_pos</a> (<a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *<a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#ae624f265c646670d373e9de0306f184b">d</a>, <a class="el" href="structgmx__ana__pos__t.html">gmx_ana_pos_t</a> *p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="displacement_8c.html#a81fdcb711db1451146ded14dc295133a">find_store_index</a> (<a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *<a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#ae624f265c646670d373e9de0306f184b">d</a>, int step)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the index in the displacement position storage array.  <a href="#a81fdcb711db1451146ded14dc295133a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="displacement_8c.html#ad2b5a136e9e87e0976ae558bff6fa0a9">gmx_ana_displ_vector</a> (<a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *<a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#ae624f265c646670d373e9de0306f184b">d</a>, int step, <a class="el" href="structt__pbc.html">t_pbc</a> *pbc, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> id, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> xout, <a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> *pout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="displacement_8c.html#a07581fadc4db16ad790533b67c7ed7a5">gmx_ana_displ_vectors</a> (<a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *<a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#ae624f265c646670d373e9de0306f184b">d</a>, int step, <a class="el" href="structt__pbc.html">t_pbc</a> *pbc, int <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a82736b60ddc8f6ec6c9591b0d6fcb394">n</a>, <a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a> id[], <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> xout[], <a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> *pout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="displacement_8c.html#af99ad13734798104a87fbdd44de8627e">gmx_ana_displ_vectors_all</a> (<a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *<a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#ae624f265c646670d373e9de0306f184b">d</a>, int step, <a class="el" href="structt__pbc.html">t_pbc</a> *pbc, <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> <a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#a36b8fb392443aff4dd09ac968a2acfe8">x</a>[], <a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a> xout[], <a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> *pout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="displacement_8c.html#a1c6c8a635f8e4918789917d790958f77">gmx_ana_displ_free</a> (<a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *<a class="el" href="share_2template_2gromacs_2gmx__lapack_8h.html#ae624f265c646670d373e9de0306f184b">d</a>)</td></tr>
</table>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a0810c4cbff76246a3c6516933c9ee1c5"></a><!-- doxytag: member="displacement.c::gmx_ana_displpos_t" ref="a0810c4cbff76246a3c6516933c9ee1c5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structgmx__ana__displpos__t.html">gmx_ana_displpos_t</a>  <a class="el" href="structgmx__ana__displpos__t.html">gmx_ana_displpos_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a81fdcb711db1451146ded14dc295133a"></a><!-- doxytag: member="displacement.c::find_store_index" ref="a81fdcb711db1451146ded14dc295133a" args="(gmx_ana_displ_t *d, int step)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int <a class="el" href="displacement_8c.html#a81fdcb711db1451146ded14dc295133a">find_store_index</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>step</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Finds the index in the displacement position storage array. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Displacement calculation data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">step</td><td>Calculate the index of positions <code>steps</code> back. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Index into the <a class="el" href="structgmx__ana__displ__t.html#a1d95edacacd5dd34716f64b77f5bdce1">d-&gt;p</a> array that contains the positions <code>steps</code> back, -1 on error.</dd></dl>
<p>If <code>step</code> is too large, -1 is returned. </p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="displacement_8c_a81fdcb711db1451146ded14dc295133a_icgraph.png" border="0" usemap="#displacement_8c_a81fdcb711db1451146ded14dc295133a_icgraph" alt=""/></div>
<map name="displacement_8c_a81fdcb711db1451146ded14dc295133a_icgraph" id="displacement_8c_a81fdcb711db1451146ded14dc295133a_icgraph">
<area shape="rect" id="node3" href="displacement_8c.html#ad2b5a136e9e87e0976ae558bff6fa0a9" title="gmx_ana_displ_vector" alt="" coords="184,5,336,35"/><area shape="rect" id="node5" href="displacement_8c.html#a07581fadc4db16ad790533b67c7ed7a5" title="gmx_ana_displ_vectors" alt="" coords="181,59,339,88"/><area shape="rect" id="node7" href="displacement_8c.html#af99ad13734798104a87fbdd44de8627e" title="gmx_ana_displ_vectors_all" alt="" coords="171,112,349,141"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2c2df45c0dc0ba8c0326f692cb7839d1"></a><!-- doxytag: member="displacement.c::gmx_ana_displ_create" ref="a2c2df45c0dc0ba8c0326f692cb7839d1" args="(gmx_ana_displ_t **data, int nmax, real tmax)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="displacement_8c.html#a2c2df45c0dc0ba8c0326f692cb7839d1">gmx_ana_displ_create</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> **&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>tmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">data</td><td>Displacement calculation data structure pointer to initialize. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nmax</td><td>Number of particles for which displacements should be calculated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmax</td><td>Maximum interval (in same units as in the trajectory) for which displacements are required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success.</dd></dl>
<p>This function only allocates memory for the first frame; <a class="el" href="include_2displacement_8h.html#a4fbbe00acaff0a0a7b3d4593bf708b96">gmx_ana_displ_start_frame()</a> allocates a sufficient amount of memory for storing all the required positions once it known the interval between the trajectory frames. </p>

</div>
</div>
<a class="anchor" id="a1c6c8a635f8e4918789917d790958f77"></a><!-- doxytag: member="displacement.c::gmx_ana_displ_free" ref="a1c6c8a635f8e4918789917d790958f77" args="(gmx_ana_displ_t *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="nbnxn__kernel__simd__4xn__outer_8h.html#a8dc3f4a797ed992dff49d2fa3477eee8">void</a> <a class="el" href="displacement_8c.html#a1c6c8a635f8e4918789917d790958f77">gmx_ana_displ_free</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td>Displacement calculation data.</td></tr>
  </table>
  </dd>
</dl>
<p>After the call, the pointer <code>d</code> is invalid. </p>

</div>
</div>
<a class="anchor" id="a4fbbe00acaff0a0a7b3d4593bf708b96"></a><!-- doxytag: member="displacement.c::gmx_ana_displ_start_frame" ref="a4fbbe00acaff0a0a7b3d4593bf708b96" args="(gmx_ana_displ_t *d, real t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="displacement_8c.html#a4fbbe00acaff0a0a7b3d4593bf708b96">gmx_ana_displ_start_frame</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td>Displacement calculation data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Time for the new frame. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 on failure.</dd></dl>
<p>This function should be called at the beginning of each frame for which atomic positions should be stored. It is required that the times for which this function is called are evenly spaced; otherwise, it reports a fatal error. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="displacement_8c_a4fbbe00acaff0a0a7b3d4593bf708b96_cgraph.png" border="0" usemap="#displacement_8c_a4fbbe00acaff0a0a7b3d4593bf708b96_cgraph" alt=""/></div>
<map name="displacement_8c_a4fbbe00acaff0a0a7b3d4593bf708b96_cgraph" id="displacement_8c_a4fbbe00acaff0a0a7b3d4593bf708b96_cgraph">
<area shape="rect" id="node3" href="include_2maths_8h.html#a756133ba42fa188cc63fc1a0d615f32a" title="Check if two numbers are within a tolerance." alt="" coords="237,5,347,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1249df9ac34685bd9609e1944bccb14a"></a><!-- doxytag: member="displacement.c::gmx_ana_displ_store" ref="a1249df9ac34685bd9609e1944bccb14a" args="(gmx_ana_displ_t *d, atom_id id, rvec x, gmx_bool bPres)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="displacement_8c.html#a1249df9ac34685bd9609e1944bccb14a">gmx_ana_displ_store</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a>&#160;</td>
          <td class="paramname"><em>bPres</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td>Displacement calculation data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>Particle ID. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Particle position. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bPres</td><td>TRUE if the particle should be marked as present. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="displacement_8c_a1249df9ac34685bd9609e1944bccb14a_cgraph.png" border="0" usemap="#displacement_8c_a1249df9ac34685bd9609e1944bccb14a_cgraph" alt=""/></div>
<map name="displacement_8c_a1249df9ac34685bd9609e1944bccb14a_cgraph" id="displacement_8c_a1249df9ac34685bd9609e1944bccb14a_cgraph">
<area shape="rect" id="node3" href="include_2vec_8h.html#abed978b9186481e940dc0a059f948baf" title="copy_rvec" alt="" coords="200,5,283,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="displacement_8c_a1249df9ac34685bd9609e1944bccb14a_icgraph.png" border="0" usemap="#displacement_8c_a1249df9ac34685bd9609e1944bccb14a_icgraph" alt=""/></div>
<map name="displacement_8c_a1249df9ac34685bd9609e1944bccb14a_icgraph" id="displacement_8c_a1249df9ac34685bd9609e1944bccb14a_icgraph">
<area shape="rect" id="node3" href="displacement_8c.html#a23227f37b703ca5d00cdaa2af678e728" title="gmx_ana_displ_store_array" alt="" coords="200,5,381,35"/><area shape="rect" id="node7" href="displacement_8c.html#acd4c27a82da37705cbecc5400b5001ad" title="gmx_ana_displ_store_all" alt="" coords="208,59,373,88"/><area shape="rect" id="node5" href="displacement_8c.html#aafc782c3271e10f8207c828d5d0fe87f" title="gmx_ana_displ_store_pos" alt="" coords="429,32,603,61"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acd4c27a82da37705cbecc5400b5001ad"></a><!-- doxytag: member="displacement.c::gmx_ana_displ_store_all" ref="acd4c27a82da37705cbecc5400b5001ad" args="(gmx_ana_displ_t *d, atom_id id[], rvec x[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="displacement_8c.html#acd4c27a82da37705cbecc5400b5001ad">gmx_ana_displ_store_all</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>id</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td>Displacement calculation data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>Particle IDs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Particle positions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success.</dd></dl>
<p>Both the <code>id</code> and <code>x</code> arrays should have <code>nmax</code> items, where <code>nmax</code> was provided for <a class="el" href="include_2displacement_8h.html#a246b6e5b5ce780fd88210f0e0f6410eb">gmx_ana_displ_create()</a>, and the <code>id</code>[i] should be either <code>i</code> or -1. If <code>id</code>[i]==-1, then that particle is marked as not present, but the position is still stored. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="displacement_8c_acd4c27a82da37705cbecc5400b5001ad_cgraph.png" border="0" usemap="#displacement_8c_acd4c27a82da37705cbecc5400b5001ad_cgraph" alt=""/></div>
<map name="displacement_8c_acd4c27a82da37705cbecc5400b5001ad_cgraph" id="displacement_8c_acd4c27a82da37705cbecc5400b5001ad_cgraph">
<area shape="rect" id="node3" href="include_2displacement_8h.html#a1249df9ac34685bd9609e1944bccb14a" title="gmx_ana_displ_store" alt="" coords="220,5,364,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="displacement_8c_acd4c27a82da37705cbecc5400b5001ad_icgraph.png" border="0" usemap="#displacement_8c_acd4c27a82da37705cbecc5400b5001ad_icgraph" alt=""/></div>
<map name="displacement_8c_acd4c27a82da37705cbecc5400b5001ad_icgraph" id="displacement_8c_acd4c27a82da37705cbecc5400b5001ad_icgraph">
<area shape="rect" id="node3" href="displacement_8c.html#aafc782c3271e10f8207c828d5d0fe87f" title="gmx_ana_displ_store_pos" alt="" coords="219,5,392,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a23227f37b703ca5d00cdaa2af678e728"></a><!-- doxytag: member="displacement.c::gmx_ana_displ_store_array" ref="a23227f37b703ca5d00cdaa2af678e728" args="(gmx_ana_displ_t *d, int n, atom_id id[], rvec x[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="displacement_8c.html#a23227f37b703ca5d00cdaa2af678e728">gmx_ana_displ_store_array</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>id</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td>Displacement calculation data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of elements in the <code>id</code> and <code>x</code> arrays. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>Particle IDs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Particle positions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success.</dd></dl>
<p>The positions of the given <code>n</code> particles are stored, and all of them are marked as present. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="displacement_8c_a23227f37b703ca5d00cdaa2af678e728_cgraph.png" border="0" usemap="#displacement_8c_a23227f37b703ca5d00cdaa2af678e728_cgraph" alt=""/></div>
<map name="displacement_8c_a23227f37b703ca5d00cdaa2af678e728_cgraph" id="displacement_8c_a23227f37b703ca5d00cdaa2af678e728_cgraph">
<area shape="rect" id="node3" href="include_2displacement_8h.html#a1249df9ac34685bd9609e1944bccb14a" title="gmx_ana_displ_store" alt="" coords="236,5,380,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="displacement_8c_a23227f37b703ca5d00cdaa2af678e728_icgraph.png" border="0" usemap="#displacement_8c_a23227f37b703ca5d00cdaa2af678e728_icgraph" alt=""/></div>
<map name="displacement_8c_a23227f37b703ca5d00cdaa2af678e728_icgraph" id="displacement_8c_a23227f37b703ca5d00cdaa2af678e728_icgraph">
<area shape="rect" id="node3" href="displacement_8c.html#aafc782c3271e10f8207c828d5d0fe87f" title="gmx_ana_displ_store_pos" alt="" coords="235,5,408,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aafc782c3271e10f8207c828d5d0fe87f"></a><!-- doxytag: member="displacement.c::gmx_ana_displ_store_pos" ref="aafc782c3271e10f8207c828d5d0fe87f" args="(gmx_ana_displ_t *d, gmx_ana_pos_t *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="displacement_8c.html#aafc782c3271e10f8207c828d5d0fe87f">gmx_ana_displ_store_pos</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgmx__ana__pos__t.html">gmx_ana_pos_t</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td>Displacement calculation data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>Particle positions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success.</dd></dl>
<p><code>p</code> should have at most <code>nmax</code> positions, where <code>nmax</code> was provided for <a class="el" href="include_2displacement_8h.html#a246b6e5b5ce780fd88210f0e0f6410eb">gmx_ana_displ_create()</a>. If <code>has</code> exactly <code>nmax</code> positions, <a class="el" href="include_2displacement_8h.html#acd4c27a82da37705cbecc5400b5001ad">gmx_ana_displ_store_all()</a> is called, otherwise <a class="el" href="include_2displacement_8h.html#a23227f37b703ca5d00cdaa2af678e728">gmx_ana_displ_store_array()</a> is used. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="displacement_8c_aafc782c3271e10f8207c828d5d0fe87f_cgraph.png" border="0" usemap="#displacement_8c_aafc782c3271e10f8207c828d5d0fe87f_cgraph" alt=""/></div>
<map name="displacement_8c_aafc782c3271e10f8207c828d5d0fe87f_cgraph" id="displacement_8c_aafc782c3271e10f8207c828d5d0fe87f_cgraph">
<area shape="rect" id="node3" href="include_2displacement_8h.html#acd4c27a82da37705cbecc5400b5001ad" title="gmx_ana_displ_store_all" alt="" coords="235,5,400,35"/><area shape="rect" id="node5" href="include_2displacement_8h.html#a23227f37b703ca5d00cdaa2af678e728" title="gmx_ana_displ_store_array" alt="" coords="227,59,408,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adc268c27bcc727590b27636bf52daa0d"></a><!-- doxytag: member="displacement.c::gmx_ana_displ_time_to_steps" ref="adc268c27bcc727590b27636bf52daa0d" args="(gmx_ana_displ_t *d, real time, int *steps)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="displacement_8c.html#adc268c27bcc727590b27636bf52daa0d">gmx_ana_displ_time_to_steps</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>steps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Displacement calculation data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>Time to convert to steps. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">steps</td><td>The number of steps between the frames separated by <code>time</code>, 0 if the number of steps cannot be determined. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success (also if <code>*steps</code> is 0), -1 on error.</dd></dl>
<p><code>*steps</code> is set to zero if <a class="el" href="include_2displacement_8h.html#a4fbbe00acaff0a0a7b3d4593bf708b96">gmx_ana_displ_start_frame()</a> has not yet been called twice. -1 is returned if <code>time</code> is not an integer multiple of the interval between frames. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="displacement_8c_adc268c27bcc727590b27636bf52daa0d_cgraph.png" border="0" usemap="#displacement_8c_adc268c27bcc727590b27636bf52daa0d_cgraph" alt=""/></div>
<map name="displacement_8c_adc268c27bcc727590b27636bf52daa0d_cgraph" id="displacement_8c_adc268c27bcc727590b27636bf52daa0d_cgraph">
<area shape="rect" id="node3" href="include_2maths_8h.html#a756133ba42fa188cc63fc1a0d615f32a" title="Check if two numbers are within a tolerance." alt="" coords="253,5,363,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad2b5a136e9e87e0976ae558bff6fa0a9"></a><!-- doxytag: member="displacement.c::gmx_ana_displ_vector" ref="ad2b5a136e9e87e0976ae558bff6fa0a9" args="(gmx_ana_displ_t *d, int step, t_pbc *pbc, atom_id id, rvec x, rvec xout, gmx_bool *pout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="displacement_8c.html#ad2b5a136e9e87e0976ae558bff6fa0a9">gmx_ana_displ_vector</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__pbc.html">t_pbc</a> *&#160;</td>
          <td class="paramname"><em>pbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>xout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> *&#160;</td>
          <td class="paramname"><em>pout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Displacement calculation data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">step</td><td>Displacement is calculated from the location <code>step</code> steps back. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pbc</td><td>Periodic boundary structure (if NULL, PBC are not used in distance calculation). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>Particle ID for which the displacement is calculated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Current particle position. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td>Displacement of the particle. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pout</td><td>TRUE if the old particle position was marked present. If <code>*pout</code> is FALSE and the old particle position was not stored, the value of <code>xout</code> is undefined. Can be NULL, in which case the value is not stored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 if less than <code>step</code> frames have been stored or <code>step</code> &lt;= 0, or EINVAL if <code>step</code> is too large. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="displacement_8c_ad2b5a136e9e87e0976ae558bff6fa0a9_cgraph.png" border="0" usemap="#displacement_8c_ad2b5a136e9e87e0976ae558bff6fa0a9_cgraph" alt=""/></div>
<map name="displacement_8c_ad2b5a136e9e87e0976ae558bff6fa0a9_cgraph" id="displacement_8c_ad2b5a136e9e87e0976ae558bff6fa0a9_cgraph">
<area shape="rect" id="node3" href="displacement_8c.html#a81fdcb711db1451146ded14dc295133a" title="Finds the index in the displacement position storage array." alt="" coords="205,5,323,35"/><area shape="rect" id="node5" href="include_2pbc_8h.html#a442132e6e6fce9d8f8f5c4e115e6b4d7" title="pbc_dx" alt="" coords="232,59,296,88"/><area shape="rect" id="node7" href="include_2vec_8h.html#aa42bdc6353729bddfb2cb149a3ae3652" title="rvec_sub" alt="" coords="227,112,301,141"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a07581fadc4db16ad790533b67c7ed7a5"></a><!-- doxytag: member="displacement.c::gmx_ana_displ_vectors" ref="a07581fadc4db16ad790533b67c7ed7a5" args="(gmx_ana_displ_t *d, int step, t_pbc *pbc, int n, atom_id id[], rvec x[], rvec xout[], gmx_bool *pout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="displacement_8c.html#a07581fadc4db16ad790533b67c7ed7a5">gmx_ana_displ_vectors</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__pbc.html">t_pbc</a> *&#160;</td>
          <td class="paramname"><em>pbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#ad3f47cdb48677e516e2049719612c737">atom_id</a>&#160;</td>
          <td class="paramname"><em>id</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>xout</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> *&#160;</td>
          <td class="paramname"><em>pout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Displacement calculation data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">step</td><td>Displacement is calculated from the location <code>step</code> steps back. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pbc</td><td>Periodic boundary structure (if NULL, PBC are not used in distance calculation). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of particles for which to calculate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>Particle IDs for which the displacement is calculated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Current particle positions. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td>Displacement of the particles. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pout</td><td>TRUE if the old particle position was marked present. If <code>pout</code>[i] is FALSE and the old particle position was not stored, the value of <code>xout</code>[i] is undefined. Can be NULL, in which case the value is not stored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 if less than <code>step</code> frames have been stored or <code>step</code> &lt;= 0, or EINVAL if <code>step</code> is too large. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="displacement_8c_a07581fadc4db16ad790533b67c7ed7a5_cgraph.png" border="0" usemap="#displacement_8c_a07581fadc4db16ad790533b67c7ed7a5_cgraph" alt=""/></div>
<map name="displacement_8c_a07581fadc4db16ad790533b67c7ed7a5_cgraph" id="displacement_8c_a07581fadc4db16ad790533b67c7ed7a5_cgraph">
<area shape="rect" id="node3" href="displacement_8c.html#a81fdcb711db1451146ded14dc295133a" title="Finds the index in the displacement position storage array." alt="" coords="213,5,331,35"/><area shape="rect" id="node5" href="include_2pbc_8h.html#a442132e6e6fce9d8f8f5c4e115e6b4d7" title="pbc_dx" alt="" coords="240,59,304,88"/><area shape="rect" id="node7" href="include_2vec_8h.html#aa42bdc6353729bddfb2cb149a3ae3652" title="rvec_sub" alt="" coords="235,112,309,141"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af99ad13734798104a87fbdd44de8627e"></a><!-- doxytag: member="displacement.c::gmx_ana_displ_vectors_all" ref="af99ad13734798104a87fbdd44de8627e" args="(gmx_ana_displ_t *d, int step, t_pbc *pbc, rvec x[], rvec xout[], gmx_bool *pout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="displacement_8c.html#af99ad13734798104a87fbdd44de8627e">gmx_ana_displ_vectors_all</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgmx__ana__displ__t.html">gmx_ana_displ_t</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structt__pbc.html">t_pbc</a> *&#160;</td>
          <td class="paramname"><em>pbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="share_2template_2gromacs_2types_2simple_8h.html#aa02a552a4abd2f180c282a083dc3a999">rvec</a>&#160;</td>
          <td class="paramname"><em>xout</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2types_2simple_8h.html#a8fddad319f226e856400d190198d5151">gmx_bool</a> *&#160;</td>
          <td class="paramname"><em>pout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Displacement calculation data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">step</td><td>Displacement is calculated from the location <code>step</code> steps back. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pbc</td><td>Periodic boundary structure (if NULL, PBC are not used in distance calculation). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Current particle positions. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xout</td><td>Displacement of the particles. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pout</td><td>TRUE if the old particle position was marked present. If <code>pout</code>[i] is FALSE and the old particle position was not stored, the value of <code>xout</code>[i] is undefined. Can be NULL, in which case the value is not stored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 if less than <code>step</code> frames have been stored or <code>step</code> &lt;= 0, or EINVAL if <code>step</code> is too large.</dd></dl>
<p>The <code>x</code> array should have <code>nmax</code> items, where <code>nmax</code> is the one provided to init_displ_calc(). </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="displacement_8c_af99ad13734798104a87fbdd44de8627e_cgraph.png" border="0" usemap="#displacement_8c_af99ad13734798104a87fbdd44de8627e_cgraph" alt=""/></div>
<map name="displacement_8c_af99ad13734798104a87fbdd44de8627e_cgraph" id="displacement_8c_af99ad13734798104a87fbdd44de8627e_cgraph">
<area shape="rect" id="node3" href="displacement_8c.html#a81fdcb711db1451146ded14dc295133a" title="Finds the index in the displacement position storage array." alt="" coords="232,5,349,35"/><area shape="rect" id="node5" href="include_2pbc_8h.html#a442132e6e6fce9d8f8f5c4e115e6b4d7" title="pbc_dx" alt="" coords="259,59,323,88"/><area shape="rect" id="node7" href="include_2vec_8h.html#aa42bdc6353729bddfb2cb149a3ae3652" title="rvec_sub" alt="" coords="253,112,328,141"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Sat Dec 20 2014 17:22:34 for My Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
