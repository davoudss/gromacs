<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>My Project: include/thread_mpi/atomic.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">include/thread_mpi/atomic.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="include_2thread__mpi_2atomic_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">   This source code file is part of thread_mpi.</span>
<a name="l00003"></a>00003 <span class="comment">   Written by Sander Pronk, Erik Lindahl, and possibly others.</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">   Copyright (c) 2009, Sander Pronk, Erik Lindahl.</span>
<a name="l00006"></a>00006 <span class="comment">   All rights reserved.</span>
<a name="l00007"></a>00007 <span class="comment"></span>
<a name="l00008"></a>00008 <span class="comment">   Redistribution and use in source and binary forms, with or without</span>
<a name="l00009"></a>00009 <span class="comment">   modification, are permitted provided that the following conditions are met:</span>
<a name="l00010"></a>00010 <span class="comment">   1) Redistributions of source code must retain the above copyright</span>
<a name="l00011"></a>00011 <span class="comment">   notice, this list of conditions and the following disclaimer.</span>
<a name="l00012"></a>00012 <span class="comment">   2) Redistributions in binary form must reproduce the above copyright</span>
<a name="l00013"></a>00013 <span class="comment">   notice, this list of conditions and the following disclaimer in the</span>
<a name="l00014"></a>00014 <span class="comment">   documentation and/or other materials provided with the distribution.</span>
<a name="l00015"></a>00015 <span class="comment">   3) Neither the name of the copyright holders nor the</span>
<a name="l00016"></a>00016 <span class="comment">   names of its contributors may be used to endorse or promote products</span>
<a name="l00017"></a>00017 <span class="comment">   derived from this software without specific prior written permission.</span>
<a name="l00018"></a>00018 <span class="comment"></span>
<a name="l00019"></a>00019 <span class="comment">   THIS SOFTWARE IS PROVIDED BY US &#39;&#39;AS IS&#39;&#39; AND ANY</span>
<a name="l00020"></a>00020 <span class="comment">   EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span>
<a name="l00021"></a>00021 <span class="comment">   WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<a name="l00022"></a>00022 <span class="comment">   DISCLAIMED. IN NO EVENT SHALL WE BE LIABLE FOR ANY</span>
<a name="l00023"></a>00023 <span class="comment">   DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span>
<a name="l00024"></a>00024 <span class="comment">   (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span>
<a name="l00025"></a>00025 <span class="comment">   LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND</span>
<a name="l00026"></a>00026 <span class="comment">   ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00027"></a>00027 <span class="comment">   (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span>
<a name="l00028"></a>00028 <span class="comment">   SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00029"></a>00029 <span class="comment"></span>
<a name="l00030"></a>00030 <span class="comment">   If you want to redistribute modifications, please consider that</span>
<a name="l00031"></a>00031 <span class="comment">   scientific software is very special. Version control is crucial -</span>
<a name="l00032"></a>00032 <span class="comment">   bugs must be traceable. We will be happy to consider code for</span>
<a name="l00033"></a>00033 <span class="comment">   inclusion in the official distribution, but derived work should not</span>
<a name="l00034"></a>00034 <span class="comment">   be called official thread_mpi. Details are found in the README &amp; COPYING</span>
<a name="l00035"></a>00035 <span class="comment">   files.</span>
<a name="l00036"></a>00036 <span class="comment"> */</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="preprocessor">#ifndef TMPI_ATOMIC_H_</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span><span class="preprocessor">#define TMPI_ATOMIC_H_</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span>
<a name="l00075"></a>00075 <span class="comment">/* Se the comments on the non-atomic versions for explanations */</span>
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="preprocessor">#include &quot;<a class="code" href="include_2thread__mpi_2visibility_8h.html" title="Visibility macros.">visibility.h</a>&quot;</span>
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00082"></a>00082 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span>
<a name="l00083"></a>00083 {
<a name="l00084"></a>00084 <span class="preprocessor">#endif</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span><span class="preprocessor">#if 0</span>
<a name="l00086"></a>00086 <span class="preprocessor"></span>} <span class="comment">/* Avoids screwing up auto-indentation */</span>
<a name="l00087"></a>00087 <span class="preprocessor">#endif</span>
<a name="l00088"></a>00088 <span class="preprocessor"></span>
<a name="l00089"></a>00089 <span class="preprocessor">#ifdef __GNUC__</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span><span class="preprocessor">#define TMPI_GCC_VERSION (__GNUC__ * 10000 \</span>
<a name="l00091"></a>00091 <span class="preprocessor">                          + __GNUC_MINOR__ * 100 \</span>
<a name="l00092"></a>00092 <span class="preprocessor">                          + __GNUC_PATCHLEVEL__)</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span>
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 <span class="comment">/* first check for gcc/icc platforms.</span>
<a name="l00097"></a>00097 <span class="comment">   Some compatible compilers, like icc on linux+mac will take this path,</span>
<a name="l00098"></a>00098 <span class="comment">   too */</span>
<a name="l00099"></a>00099 <span class="preprocessor">#if ( (defined(__GNUC__) || defined(__PATHSCALE__) || defined(__PGI)) &amp;&amp; (!defined(__xlc__)) )</span>
<a name="l00100"></a>00100 <span class="preprocessor"></span>
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 <span class="comment">/* now check specifically for several architectures: */</span>
<a name="l00104"></a>00104 <span class="preprocessor">#if ((defined(i386) || defined(__x86_64__)) &amp;&amp; !defined(__OPEN64__))</span>
<a name="l00105"></a>00105 <span class="preprocessor"></span><span class="comment">/* first x86: */</span>
<a name="l00106"></a>00106 <span class="preprocessor">#include &quot;atomic/gcc_x86.h&quot;</span>
<a name="l00107"></a>00107 <span class="comment">/*#include &quot;atomic/gcc.h&quot;*/</span>
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <span class="preprocessor">#elif (defined(__ia64__))</span>
<a name="l00110"></a>00110 <span class="preprocessor"></span><span class="comment">/* then ia64: */</span>
<a name="l00111"></a>00111 <span class="preprocessor">#include &quot;atomic/gcc_ia64.h&quot;</span>
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 <span class="comment">/* for now we use gcc intrinsics on gcc: */</span>
<a name="l00114"></a>00114 <span class="comment">/*#elif (defined(__powerpc__) || (defined(__ppc__)) )*/</span>
<a name="l00115"></a>00115 <span class="comment">/*#include &quot;atomic/gcc_ppc.h&quot;*/</span>
<a name="l00116"></a>00116 
<a name="l00117"></a>00117 <span class="preprocessor">#else</span>
<a name="l00118"></a>00118 <span class="preprocessor"></span><span class="comment">/* otherwise, there&#39;s a generic gcc intrinsics version: */</span>
<a name="l00119"></a>00119 <span class="preprocessor">#include &quot;atomic/gcc.h&quot;</span>
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 <span class="preprocessor">#endif </span><span class="comment">/* end of check for gcc specific architectures */</span>
<a name="l00122"></a>00122 
<a name="l00123"></a>00123 <span class="comment">/* not gcc: */</span>
<a name="l00124"></a>00124 <span class="preprocessor">#elif (defined(_MSC_VER) &amp;&amp; (_MSC_VER &gt;= 1200))</span>
<a name="l00125"></a>00125 <span class="preprocessor"></span><span class="comment">/* Microsoft Visual C on x86, define taken from FFTW who got it from</span>
<a name="l00126"></a>00126 <span class="comment">   Morten Nissov. icc on windows will take this path.  */</span>
<a name="l00127"></a>00127 <span class="preprocessor">#include &quot;atomic/msvc.h&quot;</span>
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 <span class="preprocessor">#elif ( (defined(__IBM_GCC_ASM) || defined(__IBM_STDCPP_ASM))  &amp;&amp; \</span>
<a name="l00130"></a>00130 <span class="preprocessor">    (defined(__powerpc__) || defined(__ppc__)))</span>
<a name="l00131"></a>00131 <span class="preprocessor"></span>
<a name="l00132"></a>00132 <span class="comment">/* PowerPC using xlC intrinsics.  */</span>
<a name="l00133"></a>00133 
<a name="l00134"></a>00134 <span class="preprocessor">#include &quot;atomic/xlc_ppc.h&quot;</span>
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 <span class="preprocessor">#elif defined(__xlC__)  || defined(__xlc__)</span>
<a name="l00137"></a>00137 <span class="preprocessor"></span><span class="comment">/* IBM xlC compiler */</span>
<a name="l00138"></a>00138 <span class="preprocessor">#include &quot;atomic/xlc_ppc.h&quot;</span>
<a name="l00139"></a>00139 
<a name="l00140"></a>00140 
<a name="l00141"></a>00141 <span class="preprocessor">#elif defined (__sun) &amp;&amp; (defined(__sparcv9) || defined(__sparc))</span>
<a name="l00142"></a>00142 <span class="preprocessor"></span><span class="comment">/* Solaris on SPARC (Sun C Compiler, Solaris Studio) */</span>
<a name="l00143"></a>00143 <span class="preprocessor">#include &quot;atomic/suncc-sparc.h&quot;</span>
<a name="l00144"></a>00144 
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 <span class="preprocessor">#else</span>
<a name="l00149"></a>00149 <span class="preprocessor"></span><span class="comment">/* No atomic operations, use mutex fallback. Documentation is in x86 section */</span>
<a name="l00150"></a>00150 
<a name="l00151"></a>00151 <span class="preprocessor">#ifdef TMPI_CHECK_ATOMICS</span>
<a name="l00152"></a>00152 <span class="preprocessor"></span><span class="preprocessor">#error No atomic operations implemented for this cpu/compiler combination.</span>
<a name="l00153"></a>00153 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00154"></a>00154 <span class="preprocessor"></span>
<a name="l00156"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#aebbcb661ffeffb8ab6cbe25bcdcb058e">00156</a> <span class="preprocessor">#define TMPI_NO_ATOMICS</span>
<a name="l00157"></a>00157 <span class="preprocessor"></span>
<a name="l00158"></a>00158 
<a name="l00176"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a5d2ee17509e3123d1c71d00b02888daa">00176</a> <span class="preprocessor">#define tMPI_Atomic_memory_barrier()</span>
<a name="l00177"></a>00177 <span class="preprocessor"></span>
<a name="l00186"></a>00186 <span class="preprocessor">#define tMPI_Atomic_memory_barrier_acq()</span>
<a name="l00187"></a>00187 <span class="preprocessor"></span>
<a name="l00196"></a>00196 <span class="preprocessor">#define tMPI_Atomic_memory_barrier_rel()</span>
<a name="l00197"></a>00197 <span class="preprocessor"></span>
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 
<a name="l00202"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a739e0f735aed0e9b11581264cd658f46">00202</a> <span class="keyword">static</span> <a class="code" href="structtMPI__Thread__mutex__t.html" title="Opaque mutex datatype.">tMPI_Thread_mutex_t</a> <a class="code" href="include_2thread__mpi_2atomic_8h.html#a739e0f735aed0e9b11581264cd658f46">tMPI_Atomic_mutex</a> = <a class="code" href="include_2thread__mpi_2threads_8h.html#a94b533e44508703553567bd41dfc5b2b" title="Static initializer for tMPI_Thread_mutex_t.">TMPI_THREAD_MUTEX_INITIALIZER</a>;
<a name="l00203"></a>00203 
<a name="l00259"></a>00259 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structtMPI__Atomic.html">tMPI_Atomic</a>
<a name="l00260"></a>00260 {
<a name="l00261"></a>00261     <span class="keywordtype">int</span> <a class="code" href="structtMPI__Atomic.html#a251089827c7a504b91e5a0f390c2c5e6">value</a>;  
<a name="l00262"></a>00262 }
<a name="l00263"></a>00263 <a class="code" href="include_2thread__mpi_2atomic_2gcc_8h.html#a2c33794dc540e3b07cffc1f81a3fe4b4">tMPI_Atomic_t</a>;
<a name="l00264"></a>00264 
<a name="l00265"></a>00265 
<a name="l00275"></a>00275 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structtMPI__Atomic__ptr.html">tMPI_Atomic_ptr</a>
<a name="l00276"></a>00276 {
<a name="l00277"></a>00277     <span class="keywordtype">void</span>* <a class="code" href="structtMPI__Atomic__ptr.html#a44cda5cb05ffffd06dd44f495000ef55">value</a>;  
<a name="l00278"></a>00278 }
<a name="l00279"></a>00279 <a class="code" href="include_2thread__mpi_2atomic_2gcc_8h.html#a4c91c0105f1c0a5f23bc4239274291eb">tMPI_Atomic_ptr_t</a>;
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 
<a name="l00301"></a><a class="code" href="structtMPI__Spinlock__t.html">00301</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00302"></a>00302 {
<a name="l00303"></a>00303 <span class="preprocessor">#ifndef DOXYGEN</span>
<a name="l00304"></a><a class="code" href="structtMPI__Spinlock__t.html#aab4bfe38103faeceb8aecb300d53629e">00304</a> <span class="preprocessor"></span>    <a class="code" href="structtMPI__Thread__mutex__t.html" title="Opaque mutex datatype.">tMPI_Thread_mutex_t</a> <a class="code" href="structtMPI__Spinlock__t.html#aab4bfe38103faeceb8aecb300d53629e">lock</a>; <span class="comment">/* we don&#39;t want this documented */</span>
<a name="l00305"></a>00305 <span class="preprocessor">#endif</span>
<a name="l00306"></a>00306 <span class="preprocessor"></span>} <a class="code" href="include_2thread__mpi_2atomic_2gcc__ia64_8h.html#a2b7a347701cfabd8132eff2ac462a9f1">tMPI_Spinlock_t</a>;
<a name="l00307"></a>00307 <span class="comment">/*#define tMPI_Spinlock_t     tMPI_Thread_mutex_t*/</span>
<a name="l00308"></a>00308 
<a name="l00321"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a1e5bbd6483e8792893f3a5e8e2bbe510">00321</a> <span class="preprocessor">#  define TMPI_SPINLOCK_INITIALIZER   { TMPI_THREAD_MUTEX_INITIALIZER }</span>
<a name="l00322"></a>00322 <span class="preprocessor"></span>
<a name="l00323"></a>00323 <span class="comment">/* Since mutexes guarantee memory barriers this works fine */</span>
<a name="l00334"></a>00334 <span class="preprocessor">#ifdef DOXYGEN</span>
<a name="l00335"></a>00335 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="include_2thread__mpi_2atomic_8h.html#ad046655ee56cc30c2a8719f3d1091b8e">tMPI_Atomic_get</a>(<a class="code" href="structtMPI__Atomic.html">tMPI_Atomic_t</a> &amp;<a class="code" href="include_2gmx__blas_8h.html#aa000a866a15988a99a3db74750e6f4dd">a</a>);
<a name="l00336"></a>00336 <span class="preprocessor">#else</span>
<a name="l00337"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#ad046655ee56cc30c2a8719f3d1091b8e">00337</a> <span class="preprocessor"></span><span class="preprocessor">#define tMPI_Atomic_get(a)   ((a)-&gt;value)</span>
<a name="l00338"></a>00338 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00339"></a>00339 <span class="preprocessor"></span>
<a name="l00350"></a>00350 <a class="code" href="include_2thread__mpi_2visibility_8h.html#a1b2991140928309c56dcbe825bffb97e">TMPI_EXPORT</a>
<a name="l00351"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a656620d5b78214f23f4b7214ff7a6f94">00351</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="include_2thread__mpi_2atomic_8h.html#a656620d5b78214f23f4b7214ff7a6f94">tMPI_Atomic_set</a>(<a class="code" href="structtMPI__Atomic.html">tMPI_Atomic_t</a> *<a class="code" href="include_2gmx__blas_8h.html#aa000a866a15988a99a3db74750e6f4dd">a</a>, <span class="keywordtype">int</span> <a class="code" href="include_2gmx__lapack_8h.html#a5325f1842789194c441b272cbf424674">i</a>)
<a name="l00352"></a>00352 {
<a name="l00353"></a>00353     <span class="comment">/* Mutexes here are necessary to guarantee memory visibility */</span>
<a name="l00354"></a>00354     <a class="code" href="include_2thread__mpi_2threads_8h.html#acae0fb1517edd9f21951ac4c4d9c782c">tMPI_Thread_mutex_lock</a>(&amp;tMPI_Atomic_mutex);
<a name="l00355"></a>00355     a-&gt;<a class="code" href="structtMPI__Atomic.html#a251089827c7a504b91e5a0f390c2c5e6">value</a> = <a class="code" href="include_2gmx__lapack_8h.html#a5325f1842789194c441b272cbf424674">i</a>;
<a name="l00356"></a>00356     <a class="code" href="include_2thread__mpi_2threads_8h.html#ac4518a42e32f81ea1518f90542191fcc">tMPI_Thread_mutex_unlock</a>(&amp;tMPI_Atomic_mutex);
<a name="l00357"></a>00357 }
<a name="l00358"></a>00358 
<a name="l00359"></a>00359 
<a name="l00370"></a>00370 <span class="preprocessor">#ifdef DOXYGEN</span>
<a name="l00371"></a>00371 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>* <a class="code" href="include_2thread__mpi_2atomic_8h.html#a0769c59b89bb5ff489110f9de52658cf">tMPI_Atomic_ptr_get</a>(<a class="code" href="structtMPI__Atomic__ptr.html">tMPI_Atomic_ptr_t</a> &amp;<a class="code" href="include_2gmx__blas_8h.html#aa000a866a15988a99a3db74750e6f4dd">a</a>);
<a name="l00372"></a>00372 <span class="preprocessor">#else</span>
<a name="l00373"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a0769c59b89bb5ff489110f9de52658cf">00373</a> <span class="preprocessor"></span><span class="preprocessor">#define tMPI_Atomic_ptr_get(a)   ((a)-&gt;value)</span>
<a name="l00374"></a>00374 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00375"></a>00375 <span class="preprocessor"></span>
<a name="l00376"></a>00376 
<a name="l00377"></a>00377 
<a name="l00378"></a>00378 
<a name="l00389"></a>00389 <a class="code" href="include_2thread__mpi_2visibility_8h.html#a1b2991140928309c56dcbe825bffb97e">TMPI_EXPORT</a>
<a name="l00390"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a4a33bfcb81731d031d1b24e8d781f1eb">00390</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="include_2thread__mpi_2atomic_8h.html#a4a33bfcb81731d031d1b24e8d781f1eb">tMPI_Atomic_ptr_set</a>(<a class="code" href="structtMPI__Atomic.html">tMPI_Atomic_t</a> *<a class="code" href="include_2gmx__blas_8h.html#aa000a866a15988a99a3db74750e6f4dd">a</a>, <span class="keywordtype">void</span> *p)
<a name="l00391"></a>00391 {
<a name="l00392"></a>00392     <span class="comment">/* Mutexes here are necessary to guarantee memory visibility */</span>
<a name="l00393"></a>00393     <a class="code" href="include_2thread__mpi_2threads_8h.html#acae0fb1517edd9f21951ac4c4d9c782c">tMPI_Thread_mutex_lock</a>(&amp;tMPI_Atomic_mutex);
<a name="l00394"></a>00394     a-&gt;<a class="code" href="structtMPI__Atomic.html#a251089827c7a504b91e5a0f390c2c5e6">value</a> = (<span class="keywordtype">void</span>*)p;
<a name="l00395"></a>00395     <a class="code" href="include_2thread__mpi_2threads_8h.html#ac4518a42e32f81ea1518f90542191fcc">tMPI_Thread_mutex_unlock</a>(&amp;tMPI_Atomic_mutex);
<a name="l00396"></a>00396 }
<a name="l00397"></a>00397 
<a name="l00398"></a>00398 
<a name="l00409"></a>00409 <a class="code" href="include_2thread__mpi_2visibility_8h.html#a1b2991140928309c56dcbe825bffb97e">TMPI_EXPORT</a>
<a name="l00410"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#aca56ce0d6bb80e99248d9372f2caf0f9">00410</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="include_2thread__mpi_2atomic_8h.html#aca56ce0d6bb80e99248d9372f2caf0f9">tMPI_Atomic_add_return</a>(<a class="code" href="structtMPI__Atomic.html">tMPI_Atomic_t</a> *<a class="code" href="include_2gmx__blas_8h.html#aa000a866a15988a99a3db74750e6f4dd">a</a>, <span class="keywordtype">int</span> <a class="code" href="include_2gmx__lapack_8h.html#a5325f1842789194c441b272cbf424674">i</a>)
<a name="l00411"></a>00411 {
<a name="l00412"></a>00412     <span class="keywordtype">int</span> <a class="code" href="include_2gmx__lapack_8h.html#ae647c0df6f34102f0f7788e940d006cc">t</a>;
<a name="l00413"></a>00413     <a class="code" href="include_2thread__mpi_2threads_8h.html#acae0fb1517edd9f21951ac4c4d9c782c">tMPI_Thread_mutex_lock</a>(&amp;tMPI_Atomic_mutex);
<a name="l00414"></a>00414     t        = a-&gt;<a class="code" href="structtMPI__Atomic.html#a251089827c7a504b91e5a0f390c2c5e6">value</a> + <a class="code" href="include_2gmx__lapack_8h.html#a5325f1842789194c441b272cbf424674">i</a>;
<a name="l00415"></a>00415     a-&gt;<a class="code" href="structtMPI__Atomic.html#a251089827c7a504b91e5a0f390c2c5e6">value</a> = <a class="code" href="include_2gmx__lapack_8h.html#ae647c0df6f34102f0f7788e940d006cc">t</a>;
<a name="l00416"></a>00416     <a class="code" href="include_2thread__mpi_2threads_8h.html#ac4518a42e32f81ea1518f90542191fcc">tMPI_Thread_mutex_unlock</a>(&amp;tMPI_Atomic_mutex);
<a name="l00417"></a>00417     <span class="keywordflow">return</span> <a class="code" href="include_2gmx__lapack_8h.html#ae647c0df6f34102f0f7788e940d006cc">t</a>;
<a name="l00418"></a>00418 }
<a name="l00419"></a>00419 
<a name="l00420"></a>00420 
<a name="l00421"></a>00421 
<a name="l00437"></a>00437 <a class="code" href="include_2thread__mpi_2visibility_8h.html#a1b2991140928309c56dcbe825bffb97e">TMPI_EXPORT</a>
<a name="l00438"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#acaa08636b69ebeb6b4db98dc98a43a05">00438</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="include_2thread__mpi_2atomic_8h.html#acaa08636b69ebeb6b4db98dc98a43a05">tMPI_Atomic_fetch_add</a>(<a class="code" href="structtMPI__Atomic.html">tMPI_Atomic_t</a> *<a class="code" href="include_2gmx__blas_8h.html#aa000a866a15988a99a3db74750e6f4dd">a</a>, <span class="keywordtype">int</span> <a class="code" href="include_2gmx__lapack_8h.html#a5325f1842789194c441b272cbf424674">i</a>)
<a name="l00439"></a>00439 {
<a name="l00440"></a>00440     <span class="keywordtype">int</span> old_value;
<a name="l00441"></a>00441 
<a name="l00442"></a>00442     <a class="code" href="include_2thread__mpi_2threads_8h.html#acae0fb1517edd9f21951ac4c4d9c782c">tMPI_Thread_mutex_lock</a>(&amp;tMPI_Atomic_mutex);
<a name="l00443"></a>00443     old_value  = a-&gt;<a class="code" href="structtMPI__Atomic.html#a251089827c7a504b91e5a0f390c2c5e6">value</a>;
<a name="l00444"></a>00444     a-&gt;<a class="code" href="structtMPI__Atomic.html#a251089827c7a504b91e5a0f390c2c5e6">value</a>   = old_value + <a class="code" href="include_2gmx__lapack_8h.html#a5325f1842789194c441b272cbf424674">i</a>;
<a name="l00445"></a>00445     <a class="code" href="include_2thread__mpi_2threads_8h.html#ac4518a42e32f81ea1518f90542191fcc">tMPI_Thread_mutex_unlock</a>(&amp;tMPI_Atomic_mutex);
<a name="l00446"></a>00446     <span class="keywordflow">return</span> old_value;
<a name="l00447"></a>00447 }
<a name="l00448"></a>00448 
<a name="l00449"></a>00449 
<a name="l00450"></a>00450 
<a name="l00479"></a>00479 <a class="code" href="include_2thread__mpi_2visibility_8h.html#a1b2991140928309c56dcbe825bffb97e">TMPI_EXPORT</a>
<a name="l00480"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a1ee85ed30df14b0ceec8a545aef21949">00480</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="include_2thread__mpi_2atomic_8h.html#a1ee85ed30df14b0ceec8a545aef21949">tMPI_Atomic_cas</a>(<a class="code" href="structtMPI__Atomic.html">tMPI_Atomic_t</a> *<a class="code" href="include_2gmx__blas_8h.html#aa000a866a15988a99a3db74750e6f4dd">a</a>, <span class="keywordtype">int</span> old_val, <span class="keywordtype">int</span> new_val)
<a name="l00481"></a>00481 {
<a name="l00482"></a>00482     <span class="keywordtype">int</span> <a class="code" href="include_2gmx__lapack_8h.html#ae647c0df6f34102f0f7788e940d006cc">t</a> = 0;
<a name="l00483"></a>00483 
<a name="l00484"></a>00484     <a class="code" href="include_2thread__mpi_2threads_8h.html#acae0fb1517edd9f21951ac4c4d9c782c">tMPI_Thread_mutex_lock</a>(&amp;tMPI_Atomic_mutex);
<a name="l00485"></a>00485     <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structtMPI__Atomic.html#a251089827c7a504b91e5a0f390c2c5e6">value</a> == old_val)
<a name="l00486"></a>00486     {
<a name="l00487"></a>00487         a-&gt;<a class="code" href="structtMPI__Atomic.html#a251089827c7a504b91e5a0f390c2c5e6">value</a> = new_val;
<a name="l00488"></a>00488         t        = 1;
<a name="l00489"></a>00489     }
<a name="l00490"></a>00490     <a class="code" href="include_2thread__mpi_2threads_8h.html#ac4518a42e32f81ea1518f90542191fcc">tMPI_Thread_mutex_unlock</a>(&amp;tMPI_Atomic_mutex);
<a name="l00491"></a>00491     <span class="keywordflow">return</span> <a class="code" href="include_2gmx__lapack_8h.html#ae647c0df6f34102f0f7788e940d006cc">t</a>;
<a name="l00492"></a>00492 }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 
<a name="l00496"></a>00496 
<a name="l00517"></a>00517 <a class="code" href="include_2thread__mpi_2visibility_8h.html#a1b2991140928309c56dcbe825bffb97e">TMPI_EXPORT</a>
<a name="l00518"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#ae551c907723789ef6916cc1e9c574849">00518</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="include_2thread__mpi_2atomic_8h.html#ae551c907723789ef6916cc1e9c574849">tMPI_Atomic_ptr_cas</a>(<a class="code" href="structtMPI__Atomic__ptr.html">tMPI_Atomic_ptr_t</a> * <a class="code" href="include_2gmx__blas_8h.html#aa000a866a15988a99a3db74750e6f4dd">a</a>, <span class="keywordtype">void</span> *old_val,
<a name="l00519"></a>00519                                       <span class="keywordtype">void</span> *new_val)
<a name="l00520"></a>00520 {
<a name="l00521"></a>00521     <span class="keywordtype">int</span> <a class="code" href="include_2gmx__lapack_8h.html#ae647c0df6f34102f0f7788e940d006cc">t</a> = 0;
<a name="l00522"></a>00522 
<a name="l00523"></a>00523     <a class="code" href="include_2thread__mpi_2threads_8h.html#acae0fb1517edd9f21951ac4c4d9c782c">tMPI_Thread_mutex_lock</a>(&amp;tMPI_Atomic_mutex);
<a name="l00524"></a>00524     <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structtMPI__Atomic__ptr.html#a44cda5cb05ffffd06dd44f495000ef55">value</a> == old_val)
<a name="l00525"></a>00525     {
<a name="l00526"></a>00526         a-&gt;<a class="code" href="structtMPI__Atomic__ptr.html#a44cda5cb05ffffd06dd44f495000ef55">value</a> = new_val;
<a name="l00527"></a>00527         t        = 1;
<a name="l00528"></a>00528     }
<a name="l00529"></a>00529     <a class="code" href="include_2thread__mpi_2threads_8h.html#ac4518a42e32f81ea1518f90542191fcc">tMPI_Thread_mutex_unlock</a>(&amp;tMPI_Atomic_mutex);
<a name="l00530"></a>00530     <span class="keywordflow">return</span> <a class="code" href="include_2gmx__lapack_8h.html#ae647c0df6f34102f0f7788e940d006cc">t</a>;
<a name="l00531"></a>00531 }
<a name="l00532"></a>00532 
<a name="l00533"></a>00533 
<a name="l00545"></a>00545 <span class="preprocessor">#ifdef DOXYGEN</span>
<a name="l00546"></a>00546 <span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="include_2thread__mpi_2atomic_8h.html#a3659bcc9f4e4e85a744ca0261a06b863">tMPI_Spinlock_init</a>( <a class="code" href="structtMPI__Spinlock__t.html">tMPI_Spinlock_t</a> &amp;<a class="code" href="include_2gmx__blas_8h.html#a1613a230af44b86d121f3cc8b7c4d831">x</a>);
<a name="l00547"></a>00547 <span class="preprocessor">#else</span>
<a name="l00548"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a3659bcc9f4e4e85a744ca0261a06b863">00548</a> <span class="preprocessor"></span><span class="preprocessor">#define tMPI_Spinlock_init(x)       tMPI_Thread_mutex_init((x)-&gt;lock)</span>
<a name="l00549"></a>00549 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00550"></a>00550 <span class="preprocessor"></span>
<a name="l00558"></a>00558 <span class="preprocessor">#ifdef DOXYGEN</span>
<a name="l00559"></a>00559 <span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="include_2thread__mpi_2atomic_8h.html#a2803cb18c476e44a4d3a830d0bbf9ba8">tMPI_Spinlock_lock</a>( <a class="code" href="structtMPI__Spinlock__t.html">tMPI_Spinlock_t</a> &amp;<a class="code" href="include_2gmx__blas_8h.html#a1613a230af44b86d121f3cc8b7c4d831">x</a>);
<a name="l00560"></a>00560 <span class="preprocessor">#else</span>
<a name="l00561"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a2803cb18c476e44a4d3a830d0bbf9ba8">00561</a> <span class="preprocessor"></span><span class="preprocessor">#define tMPI_Spinlock_lock(x)       tMPI_Thread_mutex_lock((x)-&gt;lock)</span>
<a name="l00562"></a>00562 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00563"></a>00563 <span class="preprocessor"></span>
<a name="l00564"></a>00564 
<a name="l00575"></a>00575 <span class="preprocessor">#ifdef DOXYGEN</span>
<a name="l00576"></a>00576 <span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="include_2thread__mpi_2atomic_8h.html#a9b3ce3dc46a8e6a118f61dec7acf8e30">tMPI_Spinlock_trylock</a>( <a class="code" href="structtMPI__Spinlock__t.html">tMPI_Spinlock_t</a> &amp;<a class="code" href="include_2gmx__blas_8h.html#a1613a230af44b86d121f3cc8b7c4d831">x</a>);
<a name="l00577"></a>00577 <span class="preprocessor">#else</span>
<a name="l00578"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a9b3ce3dc46a8e6a118f61dec7acf8e30">00578</a> <span class="preprocessor"></span><span class="preprocessor">#define tMPI_Spinlock_trylock(x)    tMPI_Thread_mutex_trylock((x)-&gt;lock)</span>
<a name="l00579"></a>00579 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00580"></a>00580 <span class="preprocessor"></span>
<a name="l00587"></a>00587 <span class="preprocessor">#ifdef DOXYGEN</span>
<a name="l00588"></a>00588 <span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="include_2thread__mpi_2atomic_8h.html#a5c95f5615cb4db717971ffd7840e9205">tMPI_Spinlock_unlock</a>( <a class="code" href="structtMPI__Spinlock__t.html">tMPI_Spinlock_t</a> &amp;<a class="code" href="include_2gmx__blas_8h.html#a1613a230af44b86d121f3cc8b7c4d831">x</a>);
<a name="l00589"></a>00589 <span class="preprocessor">#else</span>
<a name="l00590"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a5c95f5615cb4db717971ffd7840e9205">00590</a> <span class="preprocessor"></span><span class="preprocessor">#define tMPI_Spinlock_unlock(x)     tMPI_Thread_mutex_unlock((x)-&gt;lock)</span>
<a name="l00591"></a>00591 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00592"></a>00592 <span class="preprocessor"></span>
<a name="l00593"></a>00593 
<a name="l00594"></a>00594 
<a name="l00603"></a>00603 <a class="code" href="include_2thread__mpi_2visibility_8h.html#a1b2991140928309c56dcbe825bffb97e">TMPI_EXPORT</a>
<a name="l00604"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a1b731ce7966268885553ac950ff334d7">00604</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="include_2thread__mpi_2atomic_8h.html#a1b731ce7966268885553ac950ff334d7">tMPI_Spinlock_islocked</a>(<span class="keyword">const</span> <a class="code" href="structtMPI__Spinlock__t.html">tMPI_Spinlock_t</a> *<a class="code" href="include_2gmx__blas_8h.html#a1613a230af44b86d121f3cc8b7c4d831">x</a>)
<a name="l00605"></a>00605 {
<a name="l00606"></a>00606     <span class="keywordflow">if</span> (<a class="code" href="include_2thread__mpi_2atomic_8h.html#a9b3ce3dc46a8e6a118f61dec7acf8e30">tMPI_Spinlock_trylock</a>(x) != 0)
<a name="l00607"></a>00607     {
<a name="l00608"></a>00608         <span class="comment">/* It was locked */</span>
<a name="l00609"></a>00609         <span class="keywordflow">return</span> 1;
<a name="l00610"></a>00610     }
<a name="l00611"></a>00611     <span class="keywordflow">else</span>
<a name="l00612"></a>00612     {
<a name="l00613"></a>00613         <span class="comment">/* We just locked it */</span>
<a name="l00614"></a>00614         <a class="code" href="include_2thread__mpi_2atomic_8h.html#a5c95f5615cb4db717971ffd7840e9205">tMPI_Spinlock_unlock</a>(x);
<a name="l00615"></a>00615         <span class="keywordflow">return</span> 0;
<a name="l00616"></a>00616     }
<a name="l00617"></a>00617 }
<a name="l00618"></a>00618 
<a name="l00627"></a>00627 <a class="code" href="include_2thread__mpi_2visibility_8h.html#a1b2991140928309c56dcbe825bffb97e">TMPI_EXPORT</a>
<a name="l00628"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#abe9d8b9affd3d12fae787f6a8ce11a15">00628</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="include_2thread__mpi_2atomic_8h.html#abe9d8b9affd3d12fae787f6a8ce11a15">tMPI_Spinlock_wait</a>(<a class="code" href="structtMPI__Spinlock__t.html">tMPI_Spinlock_t</a> *<a class="code" href="include_2gmx__blas_8h.html#a1613a230af44b86d121f3cc8b7c4d831">x</a>)
<a name="l00629"></a>00629 {
<a name="l00630"></a>00630     <a class="code" href="include_2thread__mpi_2atomic_8h.html#a2803cb18c476e44a4d3a830d0bbf9ba8">tMPI_Spinlock_lock</a>(x);
<a name="l00631"></a>00631     <span class="comment">/* Got the lock now, so the waiting is over */</span>
<a name="l00632"></a>00632     <a class="code" href="include_2thread__mpi_2atomic_8h.html#a5c95f5615cb4db717971ffd7840e9205">tMPI_Spinlock_unlock</a>(x);
<a name="l00633"></a>00633 }
<a name="l00634"></a>00634 
<a name="l00635"></a>00635 
<a name="l00636"></a>00636 <span class="preprocessor">#endif</span>
<a name="l00637"></a>00637 <span class="preprocessor"></span>
<a name="l00638"></a>00638 
<a name="l00639"></a>00639 
<a name="l00640"></a>00640 <span class="comment">/* only do this if there was no better solution */</span>
<a name="l00641"></a>00641 <span class="preprocessor">#ifndef TMPI_HAVE_SWAP</span>
<a name="l00642"></a>00642 <span class="preprocessor"></span>
<a name="l00651"></a>00651 <a class="code" href="include_2thread__mpi_2visibility_8h.html#a1b2991140928309c56dcbe825bffb97e">TMPI_EXPORT</a>
<a name="l00652"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a074d179d707dbb58a2bc6721911f7925">00652</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="include_2thread__mpi_2atomic_8h.html#a074d179d707dbb58a2bc6721911f7925">tMPI_Atomic_swap</a>(<a class="code" href="structtMPI__Atomic.html">tMPI_Atomic_t</a> *<a class="code" href="include_2gmx__blas_8h.html#aa000a866a15988a99a3db74750e6f4dd">a</a>, <span class="keywordtype">int</span> <a class="code" href="include_2gmx__blas_8h.html#abbf3311f48a298e99241cceb28f6e486">b</a>)
<a name="l00653"></a>00653 {
<a name="l00654"></a>00654     <span class="keywordtype">int</span> oldval;
<a name="l00655"></a>00655     <span class="keywordflow">do</span>
<a name="l00656"></a>00656     {
<a name="l00657"></a>00657         oldval = (int)(a-&gt;<a class="code" href="structtMPI__Atomic.html#a251089827c7a504b91e5a0f390c2c5e6">value</a>);
<a name="l00658"></a>00658     }
<a name="l00659"></a>00659     <span class="keywordflow">while</span> (!<a class="code" href="include_2thread__mpi_2atomic_8h.html#a1ee85ed30df14b0ceec8a545aef21949">tMPI_Atomic_cas</a>(a, oldval, b));
<a name="l00660"></a>00660     <span class="keywordflow">return</span> oldval;
<a name="l00661"></a>00661 }
<a name="l00672"></a>00672 <a class="code" href="include_2thread__mpi_2visibility_8h.html#a1b2991140928309c56dcbe825bffb97e">TMPI_EXPORT</a>
<a name="l00673"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a1959878474634cb56195f17c3f2590dd">00673</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> *<a class="code" href="include_2thread__mpi_2atomic_8h.html#a1959878474634cb56195f17c3f2590dd">tMPI_Atomic_ptr_swap</a>(<a class="code" href="structtMPI__Atomic__ptr.html">tMPI_Atomic_ptr_t</a> *<a class="code" href="include_2gmx__blas_8h.html#aa000a866a15988a99a3db74750e6f4dd">a</a>, <span class="keywordtype">void</span> *<a class="code" href="include_2gmx__blas_8h.html#abbf3311f48a298e99241cceb28f6e486">b</a>)
<a name="l00674"></a>00674 {
<a name="l00675"></a>00675     <span class="keywordtype">void</span> *oldval;
<a name="l00676"></a>00676     <span class="keywordflow">do</span>
<a name="l00677"></a>00677     {
<a name="l00678"></a>00678         oldval = (<span class="keywordtype">void</span>*)(a-&gt;<a class="code" href="structtMPI__Atomic__ptr.html#a44cda5cb05ffffd06dd44f495000ef55">value</a>);
<a name="l00679"></a>00679     }
<a name="l00680"></a>00680     <span class="keywordflow">while</span> (!<a class="code" href="include_2thread__mpi_2atomic_8h.html#ae551c907723789ef6916cc1e9c574849">tMPI_Atomic_ptr_cas</a>(a, oldval, b));
<a name="l00681"></a>00681     <span class="keywordflow">return</span> oldval;
<a name="l00682"></a>00682 }
<a name="l00683"></a>00683 <span class="preprocessor">#endif</span>
<a name="l00684"></a>00684 <span class="preprocessor"></span>
<a name="l00685"></a>00685 <span class="comment">/* only define this if there were no separate acquire and release barriers */</span>
<a name="l00686"></a>00686 <span class="preprocessor">#ifndef TMPI_HAVE_ACQ_REL_BARRIERS</span>
<a name="l00687"></a>00687 <span class="preprocessor"></span>
<a name="l00688"></a>00688 <span class="comment">/* if they&#39;re not defined explicitly, we just make full barriers out of both */</span>
<a name="l00689"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a19af2d47b251f907baa8d2758da5c130">00689</a> <span class="preprocessor">#define tMPI_Atomic_memory_barrier_acq tMPI_Atomic_memory_barrier</span>
<a name="l00690"></a><a class="code" href="include_2thread__mpi_2atomic_8h.html#a54eec8d5cf2512beb260cd4536db1e69">00690</a> <span class="preprocessor"></span><span class="preprocessor">#define tMPI_Atomic_memory_barrier_rel tMPI_Atomic_memory_barrier</span>
<a name="l00691"></a>00691 <span class="preprocessor"></span>
<a name="l00692"></a>00692 <span class="preprocessor">#endif</span>
<a name="l00693"></a>00693 <span class="preprocessor"></span>
<a name="l00694"></a>00694 <span class="comment">/* this allows us to use the inline keyword without breaking support for</span>
<a name="l00695"></a>00695 <span class="comment">   some compilers that don&#39;t support it: */</span>
<a name="l00696"></a>00696 <span class="preprocessor">#ifdef inline_defined_in_atomic</span>
<a name="l00697"></a>00697 <span class="preprocessor"></span><span class="preprocessor">#undef inline</span>
<a name="l00698"></a>00698 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00699"></a>00699 <span class="preprocessor"></span>
<a name="l00700"></a>00700 
<a name="l00701"></a>00701 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00702"></a>00702 <span class="preprocessor"></span>}
<a name="l00703"></a>00703 <span class="preprocessor">#endif</span>
<a name="l00704"></a>00704 <span class="preprocessor"></span>
<a name="l00705"></a>00705 
<a name="l00706"></a>00706 <span class="preprocessor">#endif </span><span class="comment">/* TMPI_ATOMIC_H_ */</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 6 2015 16:30:30 for My Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
