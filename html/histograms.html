<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>My Project: Histogram calculation</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="index.html">Gromacs</a>      </li>
      <li class="navelem"><a class="el" href="libtrajana.html">Library for trajectory analysis</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Histogram calculation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Functions to calculate histograms are defined in histogram.h. The principle is simple: histogram calculation is set up with <a class="el" href="include_2histogram_8h.html#ab40d6fd1d54b3204f5daf564bf1d8dc3">gmx_histogram_create()</a> and gmx_histogram_set_*(), the histogram is sampled using the provided functions, and <a class="el" href="include_2histogram_8h.html#a914cda7c09870610bcb3a83ac52cc709">gmx_histogram_finish()</a> is called to finish the sampling. Various post-processing functions can then be used to normalize the histogram in various ways and to write it into a file. gmx_histogram_get_*() can be used to access data from the histogram. <a class="el" href="include_2histogram_8h.html#a705814e555fa1ccb2a297903bc47a0f3">gmx_histogram_free()</a> can be used to free the memory allocated for a histogram.</p>
<h2><a class="anchor" id="histogram_sampling"></a>
Initialization and sampling</h2>
<p>A histogram calculation is initialized by calling <a class="el" href="include_2histogram_8h.html#ab40d6fd1d54b3204f5daf564bf1d8dc3">gmx_histogram_create()</a> or <a class="el" href="include_2histogram_8h.html#a4651816f933b571639f58182cec55cc4">gmx_histogram_create_range()</a>. The first function takes the type of the histogram (see <a class="el" href="share_2template_2gromacs_2histogram_8h.html#ae733abe5734389e4450335504bde8d0c">e_histogram_t</a>) and the number of bins, and allocates the necessary memory. The bin locations can be initialized with <a class="el" href="include_2histogram_8h.html#a2613ee595d411e01c5cc67e2ea62d963">gmx_histogram_set_integerbins()</a> and one of <a class="el" href="include_2histogram_8h.html#aeedf50e7e41ad43592d9a13f59f5e8e2">gmx_histogram_set_binwidth()</a> and <a class="el" href="include_2histogram_8h.html#ab536083f48600485e134db1a810edb5e">gmx_histogram_set_range()</a>. Only uniformly spaced bins are currently supported. The second initialization function takes the beginning and end of the range and the bin width. The treatment of values that fall outside the histogram range can be set with <a class="el" href="include_2histogram_8h.html#afadb5475f53de1db1941b233ad58ae1e">gmx_histogram_set_all()</a>. <a class="el" href="include_2histogram_8h.html#a4dc6019d346e922fe3b383b7480bb156">gmx_histogram_set_blocksize()</a> can be used to specify a block size for error estimates. If not called, no error estimates are calculated. Otherwise, a histogram is calculated for each block of given number of frames, and the error estimated as the error of the mean of these block histograms. If the number of frames is not divisible by the block size, the last block is discarded. <a class="el" href="include_2histogram_8h.html#acf710ff31e487be33a29fe69f9373ff7">gmx_histogram_set_block_output()</a> can be used to write the individual block histograms to a file (it is currently not very flexible).</p>
<p>After initialization, three sets of sampling functions are provided to sample the differen types of histograms:</p>
<ul>
<li>Use <a class="el" href="include_2histogram_8h.html#abbbe79464f40f6bd54ac16a9835b2722">gmx_histogram_increment()</a> or <a class="el" href="include_2histogram_8h.html#a457f6c58e1bd221ce1df64166abbfd0a">gmx_histogram_increment_bin()</a> to calculate simple histograms (<a class="el" href="share_2template_2gromacs_2histogram_8h.html#ae733abe5734389e4450335504bde8d0ca407ff02856941647f344d41b61ef301f">HIST_SIMPLE</a> histograms).</li>
<li>Use <a class="el" href="include_2histogram_8h.html#ab7b820270fa5ac5525bc48c497ec78b5">gmx_histogram_add()</a> or <a class="el" href="include_2histogram_8h.html#a07a59d751592617c279ebbfc5f6da9b2">gmx_histogram_add_to_bin()</a> to calculate histograms where different points can have different weight (<a class="el" href="share_2template_2gromacs_2histogram_8h.html#ae733abe5734389e4450335504bde8d0ca54f44903504f2d44f5f66fcc28060ac4">HIST_WEIGHT</a> histograms).</li>
<li>Use <a class="el" href="include_2histogram_8h.html#a29f91ac2ad05731b7c6077e16dbfbad3">gmx_histogram_add_item()</a> or <a class="el" href="include_2histogram_8h.html#a200fb89cb070efb95e2467d6e90cc2e5">gmx_histogram_add_item_to_bin()</a> to calculate averages within each bin (<a class="el" href="share_2template_2gromacs_2histogram_8h.html#ae733abe5734389e4450335504bde8d0ca853ac4534a02fcfb29320cd70f903e2a">HIST_BINAVER</a> histograms).</li>
</ul>
<p>The functions aboge that take bin indices directly do no range checking, i.e., one must ensure that the bin number is between 0 and the number of bins in the histogram. In contrast, the functions that use real values to locate the correct bin use range checking, and silently discard values outside the histogram (unless <a class="el" href="include_2histogram_8h.html#afadb5475f53de1db1941b233ad58ae1e">gmx_histogram_set_all()</a> has been called). <a class="el" href="include_2histogram_8h.html#ab537ee679149545eb6d386c6c9cc7376">gmx_histogram_find_bin()</a> can be used to find the bin number corresponding to a value, adhering to the <a class="el" href="include_2histogram_8h.html#afadb5475f53de1db1941b233ad58ae1e">gmx_histogram_set_all()</a> setting.</p>
<p>After a frame is sampled, <a class="el" href="include_2histogram_8h.html#af2e121043fcfe67917ef4abff2c3d1b3">gmx_histogram_finish_frame()</a> needs to be called. After all data is sampled, <a class="el" href="include_2histogram_8h.html#a914cda7c09870610bcb3a83ac52cc709">gmx_histogram_finish()</a> should be called. After these calls, the histogram will be normalized such that the sum over all bins equals the average number of samples per frame, and the error field contains the error of the mean at each bin.</p>
<h2><a class="anchor" id="histogram_processing"></a>
Post-processing</h2>
<p>The following functions can be used to process the histograms:</p>
<ul>
<li><a class="el" href="include_2histogram_8h.html#ac5a1bb4ae8fe959b88bc14fdaa18ceb7">gmx_histogram_clone()</a> makes a deep copy.</li>
<li><a class="el" href="include_2histogram_8h.html#a93a4debed53d9956228209842abfce40">gmx_histogram_resample_dblbw()</a> also makes a deep copy, but uses a binwidth that is double of the input one (see below for usage).</li>
<li><a class="el" href="include_2histogram_8h.html#a7f22f213dda945f913b246bb6ab32556">gmx_histogram_normalize_prob()</a> normalizes a histogram such that its integral becomes one.</li>
<li><a class="el" href="include_2histogram_8h.html#a28bbd3fc76c889ae19abb003a81bccf2">gmx_histogram_scale()</a> and <a class="el" href="include_2histogram_8h.html#a918cbf6887a3ad0c077d44cbcecf5454">gmx_histogram_scale_vec()</a> can be used to scale a histogram uniformly or non-uniformly, respectively.</li>
</ul>
<p>There are also functions to write histograms to a file:</p>
<ul>
<li><a class="el" href="include_2histogram_8h.html#a8afcdc28d6c3e45b4d0dde85f11bdd04">gmx_histogram_write()</a> writes a single histogram, optionally with errors.</li>
<li><a class="el" href="include_2histogram_8h.html#adf8c712ada3fc9147cd90ddd8ea79f28">gmx_histogram_write_array()</a> writes multiple histograms with identical bins. Values and/or errors can be written.</li>
<li><a class="el" href="include_2histogram_8h.html#a4064bbd1c5338583f652e8f9aee24c14">gmx_histogram_write_cum_array()</a> writes cumulative histograms for multiple histograms with identical bins.</li>
</ul>
<p><a class="el" href="include_2histogram_8h.html#a93a4debed53d9956228209842abfce40">gmx_histogram_resample_dblbw()</a> is useful if a histogram and its cumulative sum are required at same points. One can then sample the histogram with half the desired binwidth, and then use <a class="el" href="include_2histogram_8h.html#a93a4debed53d9956228209842abfce40">gmx_histogram_resample_dblbw()</a> to construct two different versions of the histogram (by changing <code>bIntegerBins</code>), one suitable for writing out the histogram and the other for writing the cumulative distribution.</p>
<p>Access to the histogram data is also provided through the following functions:</p>
<ul>
<li><a class="el" href="include_2histogram_8h.html#af81328f5edef6cd281f884e26845076f">gmx_histogram_get_nbins()</a></li>
<li><a class="el" href="include_2histogram_8h.html#aff30dc93f050ce11d3e7145072b8a4b3">gmx_histogram_get_binwidth()</a></li>
<li><a class="el" href="include_2histogram_8h.html#a928f4b4ec02cc83d6c46cb220f2d2d20">gmx_histogram_get_value()</a></li>
<li><a class="el" href="include_2histogram_8h.html#a7351630f6fb7293a74c35feec7fe3162">gmx_histogram_get_bin_value()</a></li>
<li><a class="el" href="include_2histogram_8h.html#a5dd177892fbb17f9897917180d80e285">gmx_histogram_get_values()</a></li>
<li><a class="el" href="include_2histogram_8h.html#a06d2724d56ff3f8a49af6d946844873e">gmx_histogram_get_errors()</a></li>
</ul>
<p><a class="el" href="include_2histogram_8h.html#a705814e555fa1ccb2a297903bc47a0f3">gmx_histogram_free()</a> can be used to free memory associated with a histogram when it is no longer needed. </p>
</div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Sat Dec 20 2014 17:22:45 for My Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
